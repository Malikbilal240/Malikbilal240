oracle patching october 2025 download

download opatch latest version

STEPS TO ENABLE FLASHBACK..AND GUARANTEE RESTOREPOINT 
SQL> alter system set db_recovery_file_dest_size=50G scope=both; 
System altered.
 
SQL> alter system set db_recovery_file_dest='/oraexp/fra' scope=both;
 
System altered. 
***update the retention per request, we usually make it for 48 hours i.e 2880***
 
SQL> show parameter db_flashback_retention;
NAME                                TYPE        VALUE
------------------------------------ ----------- ------------------------------
db_flashback_retention_target       integer     1440

Take archive backup.
We also verify last L0, L1 backups if those were successful and then execute the archive backup once

 RUN
{
allocate channel ch1 type disk format '/efs-ges-backup-east1a/ges-prod/usawstax05370/GESAPPR1/ARCHIVELOGS/al_%t_%s_p%p';
sql 'alter system archive log current';
sql 'alter database backup controlfile to trace';
backup archivelog all delete all input;
RELEASE channel ch1;
}

exit;

alter database flashback on;
 
Database altered.
 
***capture and save the current_scn and sysdate for flashback(if needed)***
Below are the sample o/p
SQL> select current_scn from v$database;
 
CURRENT_SCN
-----------
 129432124
 
SQL> select to_char(sysdate,'DD MM YYYY HH24:MI:SS') from dual;
 
TO_CHAR(SYSDATE,'DD
-------------------
03 04 2020 08:48:13
 
 ======================================================
SELECT flashback_on FROM v$database;
 

To ensure we can roll back if needed, create a guaranteed restore point:  
 
CREATE RESTORE POINT Before_deployment GUARANTEE FLASHBACK DATABASE;
 
This ensures Oracle keeps all necessary logs.  
 
 
7. Confirm the Restore Point Exists  
 
Verify that the restore point was successfully created:  
 
SELECT NAME, SCN, TIME, GUARANTEE_FLASHBACK_DATABASE
FROM V$RESTORE_POINT;
-----------------------------#############################
STEPS FOR FLASHBACK ENABLE IN STANDBY DB 

SQL> alter system set db_recovery_file_dest_size=50G scope=both;
 
System altered.
 
SQL> alter system set db_recovery_file_dest='/oraexp/fra' scope=both;
 
System altered.
 
***update the retention per request, we usually make it for 48 hours i.e 2880***
 
SQL> show parameter db_flashback_retention;
NAME                                TYPE        VALUE
------------------------------------ ----------- ------------------------------

db_flashback_retention_target       integer     1440

SQL>ALTER DATABASE RECOVER MANAGED STANDBY DATABASE CANCEL;

SQL> alter database flashback on;

***capture and save the current_scn and sysdate for flashback(if needed)***
Below are the sample o/p
SQL> select current_scn from v$database;
 
CURRENT_SCN
-----------
 129432124
 
SQL> select to_char(sysdate,'DD MM YYYY HH24:MI:SS') from dual;
 
TO_CHAR(SYSDATE,'DD
-------------------
03 04 2020 08:48:13
SQL>ALTER DATABASE RECOVER MANAGED STANDBY DATABASE DISCONNECT FROM SESSION;
 
We also verify last L0, L1 backups if those were successful and then execute the archive backup once
 ======================================================
 
SELECT flashback_on FROM v$database;

To ensure we can roll back if needed, create a guaranteed restore point:  
 
CREATE RESTORE POINT Before_deployment GUARANTEE FLASHBACK DATABASE;
 
This ensures Oracle keeps all necessary logs.  
  
7. Confirm the Restore Point Exists  
 
Verify that the restore point was successfully created:  
==================================================================================
ALTER DATABASE FLASHBACK OFF;

DROP RESTORE POINT Before_deployment;
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
command to check sessions..

SELECT username, osuser, machine, program, status, logon_time
FROM v$session
WHERE username IS NOT NULL;
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
dataguard configuration steps...

http://veera0109.blogspot.in/2014/01/rman-active-duplication-asm-to-asm.html

On Primary
###########

1) Change the db_unique_name of primary to "SYMQ_HDC"

SQL> alter system set db_unique_name='SYMQ_HDC' scope=spfile;

System altered.

SQL> shut immediate;
Database closed.
Database dismounted.
ORACLE instance shut down.
SQL> startup;



2) Make sure the listener entry of primary has below details
(If it doesn't have, change the details accordingly and reload the listener)

SID_LIST_LISTENER =
   (SID_LIST =
     (SID_DESC =
         (SID_NAME = PLSExtProc)
         (ORACLE_HOME = /u01/app/oracle/product/19.0/db_1)
        (PROGRAM = extproc)
     )
     (SID_DESC =
        (SID_NAME = CPAP)
        (ORACLE_HOME = /u01/app/oracle/product/19.0/db_1)
        (GLOBAL_DBNAME=CPAP_E1BS.us.deloitte.com)
     )
   )

OUTBOUND_CONNECT_TIMEOUT_LISTENER = 20

LISTENER =
  (DESCRIPTION_LIST =
    (DESCRIPTION =
      (ADDRESS = (PROTOCOL = TCP)(HOST = dbavm.mahi.com)(PORT = 1521))
      (ADDRESS = (PROTOCOL = IPC)(KEY = EXTPROC1521))
    )
  )

ADR_BASE_LISTENER = /u01/app/oracle

-----------------------------------
lsnrctl stop
lsnrctl start
-----------------------------------
SQL> select name, force_logging from v$database;

NAME      FOR
--------- ---
ORCL      NO

SQL> alter database force logging;

Database altered.

SQL> select name, force_logging from v$database;

NAME      FOR
--------- ---
ORCL      YES

SQL> alter system set standby_file_management = 'AUTO';

System altered.


2) Create standby redo logfiles on primary

SQL> select GROUP#,THREAD#,MEMBERS,BYTES FROM V$LOG;

    GROUP#    THREAD#    MEMBERS      BYTES
---------- ---------- ---------- ----------
         1          1          1   52428800
         2          1          1   52428800
         3          1          1   52428800


SQL> select group#, member from v$logfile;

    GROUP#
----------
MEMBER
--------------------------------------------------------------------------------
         3
/u01/app/oradata/orcl/redo03.log

         2
/u01/app/oradata/orcl/redo02.log

         1
/u01/app/oradata/orcl/redo01.log



SQL> ALTER DATABASE ADD STANDBY LOGFILE ('/u10/oraredo/SYMQ/sredo01.log') SIZE 52428800;

Database altered.

SQL> ALTER DATABASE ADD STANDBY LOGFILE ('/u11/oraredo/SYMQ/sredo02.log') SIZE 52428800;

Database altered.

SQL> ALTER DATABASE ADD STANDBY LOGFILE ('/u12/oraredo/SYMQ/sredo03.log') SIZE 52428800;

Database altered.

ALTER DATABASE ADD STANDBY LOGFILE ('/u12/oraredo/SYMQ/sredo04.log') SIZE 52428800;


SQL> ALTER DATABASE ADD STANDBY LOGFILE ('/u01/app/oradata/orcl/sredo05.log') SIZE 52428800;

Database altered.



ALTER DATABASE ADD STANDBY LOGFILE GROUP 7('/opt/rdo/CPAP/sredo07a.log','/opt/rdo/CPAP/sredo07b.log') SIZE 4096M;


2) Do the following parameter changes in primary

SQL> alter system set log_archive_config='DG_CONFIG=(SYMQ_HDC,SYMQ_NDC)';

System altered.

if two standby's ..... log_archive_config='DG_CONFIG=(GESAPPR1_E1AP,GESAPPR1_E1BS,GESAPPR1_W1AS)';



SQL> alter system set log_archive_dest_2='SERVICE=SYMQ_NDC ASYNC VALID_FOR=(ONLINE_LOGFILES,PRIMARY_ROLE) DB_UNIQUE_NAME=SYMQ_NDC';

System altered.

if two standby's set log_archive_dest_3='SERVICE=CLSP_W1AS LGWR ASYNC VALID_FOR=(ONLINE_LOGFILES,PRIMARY_ROLE) DB_UNIQUE_NAME=CLSP_W1AS' scope=both;

alter system set log_archive_dest_3='SERVICE=CLSP_W1AS LGWR ASYNC VALID_FOR=(ONLINE_LOGFILES,PRIMARY_ROLE) DB_UNIQUE_NAME=CLSP_W1AS' scope=both;

SQL> alter system set log_archive_dest_state_2=ENABLE;

System altered.

SQL> alter system set fal_client=CPAP_E1AP;

System altered.

SQL> alter system set fal_server=SYMQ_NDC;

System altered.

SQL> alter system set standby_file_management=AUTO;

System altered.

SQL> alter system set service_names='CLSP, CLSP_E1AP' scope=both;

System altered.

SQL> alter system set db_file_name_convert='/opt/data/CLSP','/opt/data/CLSP','/opt/idx/CLSP','/opt/idx/CLSP' scope=spfile;

System altered.

SQL> alter system set log_file_name_convert='/opt/rdo/CLSP','/opt/rdo/CLSP' scope=spfile;

System altered.


3) Create the tns entry for standby on primary

orclstby.mahi.com =
  (DESCRIPTION =
    (ADDRESS = (PROTOCOL = TCP)(HOST = dbatest.mahi.com)(PORT = 1521))
    (CONNECT_DATA =
      (SERVER = DEDICATED)
      (SERVICE_NAME = orclstby.mahi.com)(UR=A)
    )
  )

SYMQ_NDC.US.DELOITTE.COM =
  (DESCRIPTION =
    (ADDRESS = (PROTOCOL = TCP)(HOST = 10.28.40.206)(PORT = 1521))
    (CONNECT_DATA =
      (SERVER = DEDICATED)
      (SERVICE_NAME = SYMQ_NDC.US.DELOITTE.COM)(UR=A)
    )
  )


4) Copy tnsnames.ora, listener.ora, pwd file and init.ora to standby site. After copying edit listener.ora on standby to reflect the new host name and then start the listener

[usdhc8888 oraxdp XDPP]> pwd
/u01/app/oracle/product/11.2.0/db/network/admin
[usdhc8888 oraxdp XDPP]> scp tnsnames.ora dbatest:/u01/app/oracle/product/11.2.0/db/network/admin
tnsnames.ora                                                                                                                          100%   55KB  54.8KB/s   00:00

[usdhc8888 oraxdp XDPP]> scp listener.ora dbatest:/u01/app/oracle/product/11.2.0/db/network/admin
listener.ora                  


cd $ORACLE_HOME/dbs
[usdhc8888 oraxdp XDPP]> scp orapworcl dbatest:/u01/app/oracle/product/11.2.0/db/dbs
oraxdp@usdhe8888's password:
orapworcl       

SQL> create pfile='$ORACLE_HOME/dbs/initorclstby.ora' from spfile;

File created.

[oracle@dbavm dbs]$ scp initorclstby.ora dbatest:/u01/app/oracle/product/11.2.0/db/dbs
initorclstby.ora

[oracle@dbavm dbs]$


5) After copying change the initorclstby.ora file on standby site with the following:

*.db_file_name_convert='/u01/app/oradata/orcl','/u01/app/oradata/orcl'
*.db_unique_name='orclstby'
*.fal_client='orclstby'
*.fal_server='orclprmy'
*.log_archive_config='DG_CONFIG=(orclstby,orclprmy)'
*.log_archive_dest_2='SERVICE=orclprmy ASYNC VALID_FOR=(ONLINE_LOGFILES,PRIMARY_ROLE) DB_UNIQUE_NAME=orclprmy'
*.log_file_name_convert='/u01/app/oradata/orcl','/u01/app/oradata/orcl'
*.service_names='orcl, orclstby'

and create the required directories as per init.ora (i.e. adump, diag, cdump etc...)
Ex:-

[oracle@dbatest ~]$ mkdir -p /u01/app/oracle/admin/orcl/adump

create FRA directory if your primary is FRA mode

[oracle@dbatest ~]$ mkdir -p /u01/app/oracle/fra

create the directory for data files

[oracle@dbatest ~]$ mkdir -p /u01/app/oracle/oradata/orcl


6) On standby site edit the listener.ora with below and start the listener

SID_LIST_LISTENER =
   (SID_LIST =
     (SID_DESC =
         (SID_NAME = PLSExtProc)
         (ORACLE_HOME = /u01/app/oracle/product/11.2.0/db)
        (PROGRAM = extproc)
     )
     (SID_DESC =
        (SID_NAME = CPAP)
        (ORACLE_HOME = /u01/app/oracle/product/11.2.0/db)
        (GLOBAL_DBNAME=orclstby.mahi.com)
     )
   )

OUTBOUND_CONNECT_TIMEOUT_LISTENER = 20

LISTENER =
  (DESCRIPTION_LIST =
    (DESCRIPTION =
      (ADDRESS = (PROTOCOL = TCP)(HOST = dbatest.mahi.com)(PORT = 1521))
      (ADDRESS = (PROTOCOL = IPC)(KEY = EXTPROC1521))
    )
  )

ADR_BASE_LISTENER = /u01/app/oracle

------------------
lsnrctl start
------------------

6) Startup the standby instance in no mount stage
[oracle@dbatest ~]$ export ORACLE_HOME=/u01/app/oracle/product/11.2.0/db
[oracle@dbatest ~]$ export ORACLE_SID=orcl

[oracle@dbatest ~]$ sqlplus "/as sysdba"

SQL> startup nomount pfile='/u01/app/oracle/product/11.2.0/db/dbs/initorclstby.ora';
ORACLE instance started.

Total System Global Area 3156725760 bytes
Fixed Size                  2223776 bytes
Variable Size            1795162464 bytes
Database Buffers         1342177280 bytes
Redo Buffers               17162240 bytes
SQL> create spfile from pfile='/u01/app/oracle/product/11.2.0/db/dbs/initorclstby.ora';

File created.
SQL> shut immediate;
ORA-01507: database not mounted


ORACLE instance shut down.
SQL> startup nomount;
ORACLE instance started.

Total System Global Area 3156725760 bytes
Fixed Size                  2223776 bytes
Variable Size            1795162464 bytes
Database Buffers         1342177280 bytes
Redo Buffers               17162240 bytes
SQL> show parameter spfile;

NAME                                 TYPE
------------------------------------ --------------------------------
VALUE
------------------------------
spfile                               string
/u01/app/oracle/product/11.2.0
/db/dbs/spfileORCL.ora




7) Execute the below command on primary DB server to Duplicate the target DB to standby using RMAN


[oracle@dbavm dbs]$ rman target sys/sys@orclprmy auxiliary sys/sys@orclstby

Recovery Manager: Release 11.2.0.3.0 - Production on Sun Mar 9 00:32:30 2014

Copyright (c) 1982, 2011, Oracle and/or its affiliates.  All rights reserved.

connected to target database: ORCL (DBID=1369057120)
connected to auxiliary database: ORCL (not mounted)

RMAN> DUPLICATE TARGET DATABASE FOR STANDBY FROM ACTIVE DATABASE DORECOVER NOFILENAMECHECK;

8) Shutdown and startup the database on standby site and start the recovery

SQL>shut immediate;


SQL> startup nomount;
ORACLE instance started.

Total System Global Area 3156725760 bytes
Fixed Size                  2223776 bytes
Variable Size            1795162464 bytes
Database Buffers         1342177280 bytes
Redo Buffers               17162240 bytes
SQL> alter database mount standby database;

Database altered.

SQL> alter database recover managed standby database disconnect from session;

Database altered.


########################################################################################################

Primary PFILE Ex:-

GGSRC.__db_cache_size=369098752
GGSRC.__java_pool_size=33554432
GGSRC.__large_pool_size=16777216
GGSRC.__oracle_base='/u01/app/oracle'#ORACLE_BASE set from environment
GGSRC.__pga_aggregate_target=536870912
GGSRC.__sga_target=1040187392
GGSRC.__shared_io_pool_size=0
GGSRC.__shared_pool_size=587202560
GGSRC.__streams_pool_size=16777216
*._shared_io_pool_size=0
*.audit_file_dest='/u01/app/oracle/admin/GGSRC/adump'
*.audit_trail='db'
*.compatible='11.2.0.0.0'
*.control_files='/u02/oradata/GGSRC/control01.ctl','/u03/oradata/GGSRC/control02.ctl','/u04/oradata/GGSRC/control03.ctl'
*.db_block_size=8192
*.db_cache_size=318767104
*.db_domain='US.DELOITTE.COM'
*.db_keep_cache_size=0
*.db_name='GGSRC'
*.db_recycle_cache_size=0
*.db_unique_name='GGSRCPRMY'
*.diagnostic_dest='/u01/app/oracle'
*.dispatchers='(PROTOCOL=TCP) (SERVICE=GGSRCXDB)'
*.fal_client='GGSRCPRMY'
*.fal_server='GGSRCSTBY'
*.java_pool_size=16777216
*.large_pool_size=16777216
*.log_archive_config='DG_CONFIG=(GGSRCPRMY,GGSRCSTBY)'
*.log_archive_dest_1='LOCATION=/archive/GGSRC'
*.log_archive_dest_2='SERVICE=GGSRCSTBY ASYNC VALID_FOR=(ONLINE_LOGFILES,PRIMARY_ROLE) DB_UNIQUE_NAME=GGSRCSTBY REOPEN=30'
*.log_archive_dest_state_2='ENABLE'
*.log_archive_format='GGSRC_%t_%s_%r.arc'
*.log_file_name_convert='/u10/oradata/GGSRC','/u10/oradata/GGSRC','/u11/oradata/GGSRC','/u11/oradata/GGSRC','/u12/oradata/GGSRC','/u12/oradata/GGSRC','/u13/oradata/GGSRC','/u13/oradata/GGSRC'
*.memory_max_target=2147483648
*.memory_target=1577058304
*.open_cursors=300
*.optimizer_use_invisible_indexes=FALSE
*.pga_aggregate_target=0
*.processes=150
*.recyclebin='OFF'
*.remote_login_passwordfile='EXCLUSIVE'
*.service_names='GGSRC, GGSRCPRMY'
*.sga_target=0
*.shared_pool_size=150994944
*.standby_file_management='AUTO'
*.streams_pool_size=16777216
*.undo_retention=86400
*.undo_tablespace='UNDOTBS1'




Standby PFILE Ex:-

GGSRC.__db_cache_size=369098752
GGSRC.__java_pool_size=33554432
GGSRC.__large_pool_size=16777216
GGSRC.__oracle_base='/u01/app/oracle'#ORACLE_BASE set from environment
GGSRC.__pga_aggregate_target=536870912
GGSRC.__sga_target=1040187392
GGSRC.__shared_io_pool_size=0
GGSRC.__shared_pool_size=587202560
GGSRC.__streams_pool_size=16777216
*._shared_io_pool_size=0
*.audit_file_dest='/u01/app/oracle/admin/GGSRC/adump'
*.audit_trail='db'
*.compatible='11.2.0.0.0'
*.control_files='/u02/oradata/GGSRC/control01.ctl','/u03/oradata/GGSRC/control02.ctl','/u04/oradata/GGSRC/control03.ctl'
*.db_block_size=8192
*.db_cache_size=318767104
*.db_domain='US.DELOITTE.COM'
*.db_keep_cache_size=0
*.db_name='GGSRC'
*.db_recycle_cache_size=0
*.db_unique_name='GGSRCSTBY'
*.diagnostic_dest='/u01/app/oracle'
*.dispatchers='(PROTOCOL=TCP) (SERVICE=GGSRCXDB)'
*.fal_client='GGSRCSTBY'
*.fal_server='GGSRCPRMY'
*.java_pool_size=16777216
*.large_pool_size=16777216
*.log_archive_config='DG_CONFIG=(GGSRCSTBY,GGSRCPRMY)'
*.log_archive_dest_1='LOCATION=/archive/GGSRC'
*.log_archive_dest_2='SERVICE=GGSRCPRMY ASYNC VALID_FOR=(ONLINE_LOGFILES,PRIMARY_ROLE) DB_UNIQUE_NAME=GGSRCPRMY'
*.log_archive_dest_state_2='ENABLE'
*.log_archive_format='GGSRC_%t_%s_%r.arc'
*.log_file_name_convert='/u10/oradata/GGSRC','/u10/oradata/GGSRC','/u11/oradata/GGSRC','/u11/oradata/GGSRC','/u12/oradata/GGSRC','/u12/oradata/GGSRC','/u13/oradata/GGSRC','/u13/oradata/GGSRC'
*.memory_max_target=2147483648
*.memory_target=1577058304
*.open_cursors=300
*.optimizer_use_invisible_indexes=FALSE
*.pga_aggregate_target=0
*.processes=150
*.recyclebin='OFF'
*.remote_login_passwordfile='EXCLUSIVE'
*.service_names='GGSRC, GGSRCSTBY'
*.sga_target=0
*.shared_pool_size=150994944
*.standby_file_management='AUTO'
*.streams_pool_size=16777216
*.undo_retention=86400
*.undo_tablespace='UNDOTBS1'



#########################################################################################

Change the Protection Modes:-
###########################

SERVICE=ORCLSTBY ASYNC VALID_FOR=(ONLINE_LOGFILES,PRIMARY_ROLE) DB_UNIQUE_NAME=ORCLSTBY

1) To change to maximum availability:-

(Execute below commands on primary database)

SQL> ALTER SYSTEM SET LOG_ARCHIVE_DEST_2='SERVICE=ORCLSTBY AFFIRM SYNC VALID_FOR=(ONLINE_LOGFILES,PRIMARY_ROLE) DB_UNIQUE_NAME=ORCLSTBY';

System altered.

SQL> alter database set standby database to maximize availability;

Database altered.

SQL> select protection_mode from v$database;

PROTECTION_MODE
--------------------
MAXIMUM AVAILABILITY

2) To change back to maximum performance:-
(Execute below commands on primary database)

SQL> ALTER SYSTEM SET LOG_ARCHIVE_DEST_2='SERVICE=ORCLSTBY NOAFFIRM ASYNC VALID_FOR=(ONLINE_LOGFILES,PRIMARY_ROLE) DB_UNIQUE_NAME=ORCLSTBY';

System altered.

SQL> ALTER DATABASE SET STANDBY DATABASE TO MAXIMIZE PERFORMANCE;

Database altered.

SQL> select protection_mode from v$database;

PROTECTION_MODE
--------------------
MAXIMUM PERFORMANCE


3) To change to maximum protection:-
(Execute below commands on primary database)

SQL> ALTER SYSTEM SET LOG_ARCHIVE_DEST_2='SERVICE=ORCLSTBY AFFIRM SYNC VALID_FOR=(ONLINE_LOGFILES,PRIMARY_ROLE) DB_UNIQUE_NAME=ORCLSTBY';

System altered.


SQL> shut immediate;
Database closed.
Database dismounted.
ORACLE instance shut down.
SQL> startup mount;
ORACLE instance started.

Total System Global Area  849530880 bytes
Fixed Size                  1348244 bytes
Variable Size             524291436 bytes
Database Buffers          318767104 bytes
Redo Buffers                5124096 bytes
Database mounted.
SQL> alter database set standby database to maximize protection;

Database altered.

SQL> alter database open;

Database altered.

SQL> select protection_mode from v$database;

PROTECTION_MODE
--------------------
MAXIMUM PROTECTION


4) To take back to maximum performance:-


SQL> ALTER SYSTEM SET LOG_ARCHIVE_DEST_2='SERVICE=ORCLSTBY NOAFFIRM ASYNC VALID_FOR=(ONLINE_LOGFILES,PRIMARY_ROLE) DB_UNIQUE_NAME=ORCLSTBY' scope=spfile;

System altered.

SQL> alter database set standby database to maximize performance;

Database altered.

SQL> alter database open;

Database altered.

SQL> select protection_mode from v$database;

PROTECTION_MODE
--------------------
MAXIMUM PERFORMANCE


#############################################################################################

Switchover:-
----------

1) On Primary database (dbavm) execute below commands:

SQL> ALTER DATABASE COMMIT TO SWITCHOVER TO STANDBY;

Database altered.

SQL> shut immediate;


SQL> startup nomount;
ORACLE instance started.

Total System Global Area  849530880 bytes
Fixed Size                  1348244 bytes
Variable Size             524291436 bytes
Database Buffers          318767104 bytes
Redo Buffers                5124096 bytes


SQL> alter database mount standby database;

Database altered.

SQL> ALTER DATABASE RECOVER MANAGED STANDBY DATABASE DISCONNECT FROM SESSION;

Database altered.

2) On standby (dbatest) execute below commands:-

SQL> ALTER DATABASE COMMIT TO SWITCHOVER TO PRIMARY;

Database altered.

SQL> shut immediate;
ORA-01109: database not open


Database dismounted.
ORACLE instance shut down.

SQL> startup;
ORACLE instance started.

Total System Global Area  849530880 bytes
Fixed Size                  1348244 bytes
Variable Size             499125612 bytes
Database Buffers          343932928 bytes
Redo Buffers                5124096 bytes
Database mounted.
Database opened.


Now DB in DBAVM become standby and DB in DBATEST become new primary. Check the archive logs switching from primary to standby



Failover:-
##########

(Now DBTEST is new primary and DBVM is new standby, if DBTEST crashes make DBVM as primary using failover method)


1) Shutdown DBTEST (New primary) to show the scenario of primary crash.

2) Now on DBVM (New standby) execute below commands

SQL> ALTER DATABASE RECOVER MANAGED STANDBY DATABASE FINISH;

Database altered.

SQL> ALTER DATABASE ACTIVATE STANDBY DATABASE;

Database altered.

SQL> alter database open;

Database altered.


SQL> select database_role from v$database;

DATABASE_ROLE
----------------
PRIMARY


(The original primary database can now be configured as a standby. The whole setup process must be followed, but this time using the original primary server as the standby.)

###################################################################################

v$archived_log, v$archive_gap

###################################################################################

Active Dataguard
----------------

1) On Standby site execute the below commands:
---------------------------------------------

SQL> alter database recover managed standby database cancel;

Database altered.

SQL> shut immediate;
ORA-01109: database not open


Database dismounted.
ORACLE instance shut down.
SQL> startup mount;
ORACLE instance started.

Total System Global Area  849530880 bytes
Fixed Size                  1348244 bytes
Variable Size             499125612 bytes
Database Buffers          343932928 bytes
Redo Buffers                5124096 bytes
Database mounted.
SQL> alter database open read only;

Database altered.

SQL> ALTER DATABASE RECOVER MANAGED STANDBY DATABASE DISCONNECT FROM SESSION;

Database altered.



Snapshot Standby
----------------

Introduced in 11g, snapshot standby allows the standby database to be opened in read-write mode. 
When switched back into standby mode, all changes made whilst in read-write mode are lost. 
This is achieved using flashback database, but the standby database does not need to have flashback database explicitly enabled to take advantage of this feature, 
thought it works just the same if it is.


1) Convert to snapshot standby:-

(On standby execute below commands)

SQL> ALTER DATABASE RECOVER MANAGED STANDBY DATABASE CANCEL;

Database altered.

SQL> SELECT flashback_on FROM v$database;

FLASHBACK_ON
------------------
NO

SQL> ALTER DATABASE CONVERT TO SNAPSHOT STANDBY;

Database altered.

SQL> alter database open;

Database altered.

SQL> SELECT flashback_on FROM v$database;

FLASHBACK_ON
------------------
RESTORE POINT ONLY

You can now do treat the standby like any read-write database.


2) To convert it back to the physical standby, losing all the changes made since the conversion to snapshot standby, issue the following commands.

SQL> shut immediate;
Database closed.
Database dismounted.
ORACLE instance shut down.

SQL> startup mount;
ORACLE instance started.

Total System Global Area  849530880 bytes
Fixed Size                  1348244 bytes
Variable Size             499125612 bytes
Database Buffers          343932928 bytes
Redo Buffers                5124096 bytes
Database mounted.

SQL> ALTER DATABASE CONVERT TO PHYSICAL STANDBY;

Database altered.

SQL> shut immediate;
ORA-01507: database not mounted


ORACLE instance shut down.

SQL> startup nomount;
ORACLE instance started.

Total System Global Area  849530880 bytes
Fixed Size                  1348244 bytes
Variable Size             499125612 bytes
Database Buffers          343932928 bytes
Redo Buffers                5124096 bytes

SQL> ALTER DATABASE MOUNT STANDBY DATABASE;

Database altered.


SQL> ALTER DATABASE RECOVER MANAGED STANDBY DATABASE DISCONNECT from session;

Database altered.



####################################################################################################

Configure Dataguard Broker:-
--------------------------

(On Primary site, DBAVM)


1) On Primary make sure the listener has below entries and reload it

SID_LIST_LISTENER =
   (SID_LIST =
     (SID_DESC =
         (SID_NAME = PLSExtProc)
         (ORACLE_HOME = /u01/app/oracle/product/11.2.0/db)
        (PROGRAM = extproc)
     )
     (SID_DESC =
        (SID_NAME = orcl)
        (ORACLE_HOME = /u01/app/oracle/product/11.2.0/db)
        (GLOBAL_DBNAME=orclprmy.mahi.com)
     )
     (SID_DESC =
        (SID_NAME = orcl)
        (ORACLE_HOME = /u01/app/oracle/product/11.2.0/db)
        (GLOBAL_DBNAME=orclprmy_dgmgrl.mahi.com)
     )
   )

OUTBOUND_CONNECT_TIMEOUT_LISTENER = 20

LISTENER =
  (DESCRIPTION_LIST =
    (DESCRIPTION =
      (ADDRESS = (PROTOCOL = TCP)(HOST = dbavm.mahi.com)(PORT = 1521))
      (ADDRESS = (PROTOCOL = IPC)(KEY = EXTPROC1521))
    )
  )

ADR_BASE_LISTENER = /u01/app/oracle



[oracle@dbavm admin]$ lsnrctl reload


2) On Standby, have the listener entry like below 

SID_LIST_LISTENER =
   (SID_LIST =
     (SID_DESC =
         (SID_NAME = PLSExtProc)
         (ORACLE_HOME = /u01/app/oracle/product/11.2.0/db)
        (PROGRAM = extproc)
     )
     (SID_DESC =
        (SID_NAME = orcl)
        (ORACLE_HOME = /u01/app/oracle/product/11.2.0/db)
        (GLOBAL_DBNAME=orclstby.mahi.com)
     )
     (SID_DESC =
        (SID_NAME = orcl)
        (ORACLE_HOME = /u01/app/oracle/product/11.2.0/db)
        (GLOBAL_DBNAME=orclstby_dgmgrl.mahi.com)
     )

   )

OUTBOUND_CONNECT_TIMEOUT_LISTENER = 20

LISTENER =
  (DESCRIPTION_LIST =
    (DESCRIPTION =
      (ADDRESS = (PROTOCOL = TCP)(HOST = dbatest.mahi.com)(PORT = 1521))
      (ADDRESS = (PROTOCOL = IPC)(KEY = EXTPROC1521))
    )
  )

ADR_BASE_LISTENER = /u01/app/oracle


[oracle@dbatest admin]$ lsnrctl reload

3) Enable dataguard broker on both primary and standby
(Execute below command on both primary and standby)

Primary:- SQL> alter system set dg_broker_start=TRUE;

System altered.

Standby:- SQL> alter system set dg_broker_start=TRUE;

System altered.


It creates broker configuration files on both primary and standby under $ORACLE_HOME/dbs directory when you enable the broker.

4) Start DGMGRL
(on any node, I used it on primary)

[oracle@dbavm dbs]$ dgmgrl
DGMGRL for Linux: Version 11.2.0.3.0 - Production

Copyright (c) 2000, 2009, Oracle. All rights reserved.

Welcome to DGMGRL, type "help" for information.
DGMGRL> connect sys/sys@orclprmy
Connected.
DGMGRL> 

5) Create the Broker configuration

DGMGRL> CREATE CONFIGURATION BTDEMO_DG AS PRIMARY DATABASE IS "BTDEMO_E1AP" CONNECT IDENTIFIER IS "BTDEMO_E1AP";

Configuration "orcl_dg" created with primary database "orclprmy"

6) Add standby database to configuration

DGMGRL> ADD DATABASE 'BTDEMO_E1A' AS CONNECT IDENTIFIER IS 'orclstby';

Database "orclstby" added

7) Enable the configuration

DGMGRL> enable configuration;

Enabled.

8) Show configuration

DGMGRL> show configuration;

Configuration - orcl_dg

  Protection Mode: MaxPerformance
  Databases:
    orclprmy - Primary database
    orclstby - Physical standby database

Fast-Start Failover: DISABLED

Configuration Status:
SUCCESS


********************* don't run it*********************

9) 
DGMGRL> switchover to 'orclstby';
Performing switchover NOW, please wait...
New primary database "orclstby" is opening...
Operation requires shutdown of instance "orcl" on database "orclprmy"
Shutting down instance "orcl"...
ORACLE instance shut down.
Operation requires startup of instance "orcl" on database "orclprmy"
Starting instance "orcl"...
ORACLE instance started.
Database mounted.
Switchover succeeded, new primary is "orclstby"
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
datagurad command and block change tracking comm..

select name,open_mode,database_role from v$database;

>to check log gaps between primary and standby databases...
in primary.
archive log list;

in standby database.
select max(sequence#) from v$archived_log where applied= 'YES';

select process,client_process,status,thread#,sequence#,block#,blocks from v$managed_standby;
has context menu
shut immediate: 
startup nomount;
alter database mount standby database;

alter database recover managed standby database disconnect from session;

ALTER DATABASE RECOVER MANAGED STANDBY DATABASE CANCEL;

=============================================

scp p37262172_190000_Linux-x86-64.zip p6880880_190000_Linux-x86-64.zip oradba@USHDC8522:/oraexp/EMStage/Jan2025;
USAWSTAX05784 oraias...
Elc;30BtpElc;30Btp

===============================
BCT commands.

SELECT * FROM V$BLOCK_CHANGE_TRACKING;
ALTER DATABASE ENABLE BLOCK CHANGE TRACKING USING FILE '/opt/data/EMASYMP/rman_change_track.dbf';
alter database disable block change tracking;


select * from USER_ROLE_PRIVS where USERNAME='CALRAD';
 
select privilege 

from dba_sys_privs 

where grantee='CALRAD' 

order by 1;
 =============================
===================================================================
https://teams.microsoft.com/l/message/19:7e361649996f4f14b68699a70e89940c@thread.v2/1730212184156?context=%7B%22contextType%22%3A%22chat%22%7D


show parameter archive; ---in sdba 

check log_arc_dest _1 and _2 must be enable 

alter system set log_archive_dest_state_2=ENABLE;
 
and if still issus 


dgmgrl /
edit database 'EMASYMP_GDW' set state=online;
 
edit database 'EMASYMP_GDE' set state=apply-on;
 
 
 
SELECT INSTANCE_NAME, STATUS, DATABASE_STATUS FROM V$INSTANCE;
 
select name,open_mode from v$database;
chec k with secondary ta 

and prumary ---alter system switch logfile; to redo files happen in secondary

To check both primary and standby are in sync
Hi Team,

Data guard status is in sync now.

DGMGRL> show configuration;

Configuration - SYMP_DG

  Protection Mode: MaxPerformance
  Members:
  SYMP_HDC - Primary database
    SYMP_NDC - Physical standby database

Fast-Start Failover:  Disabled

Configuration Status:
SUCCESS   (status updated 29 seconds ago)

 ==========================================
 
[usdhc8915 oraias CT]> python Oracle19.0-Upgrade-V1.py
exec(): 0509-036 Cannot load program python because of the following errors:
        0509-150   Dependent module /u01/app/oracle/product/12.2.0.1/db_1/lib/libexpat.a(libexpat.so.1) could not be loaded.
        0509-152   Member libexpat.so.1 is not found in archive

To run the python script first we need to export this command .\\
export LIBPATH=/opt/freeware/lib:$LIBPATH
=====================================
status gather command.
execute dbms_stats.gather_table_stats(ownname => 'GAE17', tabname =>'TEMP_PARAM_POLICY', estimate_percent =>DBMS_STATS.AUTO_SAMPLE_SIZE, method_opt => 'FOR ALL COLUMNS SIZEAUTO');

========================================================================================================
checking account locks

col USERNAME for a15
SELECT username, account_status, created, lock_date, expiry_date
  FROM dba_users
WHERE account_status != 'LOCK';SQL>   2    3

find /u01/app/oracle/admin/TOOLSA/adump -type f -mtime +7 -name '*.aud' -exec rm -f {} \;

/u01/app/oracle/diag/rdbms/orgprod1_e1ap/ORGPROD1/trace
find /u01/app/oracle/diag/rdbms/orgprod1_e1ap/ORGPROD1/trace -type f -mtime +5 -name '*.aud' -exec rm -f {} \;

/u01/app/oracle/diag/rdbms/orgprod1_e1ap/ORGPROD1/trace


find *.trc -mtime +2 -exec rm {} \;
find *.trm -mtime +2 -exec rm {} \;
find /u01/app/oracle/admin/PTST1/adump -type f -mtime +2 -name '*.aud' -exec rm -f {} \;
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
Dg related
Highlights and Best Practices

Using incremental backups from SCN is much faster than re-cloning the entire standby, especially with large gaps.
Always back up and catalog (or copy) all files needed before beginning, and make sure MRP is stopped while restoring.
After resync, always verify the log gap is gone and standby resumes applying new logs.

1
Get SCN from standby
2
RMAN incremental backup from SCN on primary
3
Copy backup + controlfile to standby
4
Restore control file, recover database with incremental
5
Restart standby MRP
=======================
Step 1: Get the Standbyâ€™s Current SCN
On the standby database:
SQL-- Code Generated by Sidekick is for learning and experimentation purposes only.
SELECT CURRENT_SCN FROM V$DATABASE;

Note down the returned SCN number.

Step 2: Take Incremental Backup from SCN on Primary
On the primary database (in RMAN):
SQL# Code Generated by Sidekick is for learning and experimentation purposes only.
RUN {
  BACKUP INCREMENTAL FROM SCN <standby_scn_value> DATABASE FORMAT '/tmp/incr_standby.bkp';
}


Replace <standby_scn_value> with the SCN from Step 1.
The backup file will be /tmp/incr_standby.bkp (choose your directory).

(Optional, but recommended): Create a standby control file, especially if standby and primary archive destinations differ.
SQL-- Code Generated by Sidekick is for learning and experimentation purposes only.
ALTER DATABASE CREATE STANDBY CONTROLFILE AS '/tmp/standby_control01.ctl';


Step 3: Copy Files to Standby

Copy the incremental backup (and new standby control file if created) to the standby server using scp, rsync, etc.


Step 4: Restore Incremental Backup on Standby
A. (Optional, but recommended): Shut down and replace standby control file
SQL-- Code Generated by Sidekick is for learning and experimentation purposes only.
SHUTDOWN IMMEDIATE;
STARTUP NOMOUNT;
-- In RMAN:
# Code Generated by Sidekick is for learning and experimentation purposes only.
RESTORE CONTROLFILE FROM '/tmp/standby_control01.ctl';
ALTER DATABASE MOUNT;

B. Catalog the backup if necessary:
SQL# Code Generated by Sidekick is for learning and experimentation purposes only.
CATALOG START WITH '/tmp';

C. Restore and recover the database:
SQL# Code Generated by Sidekick is for learning and experimentation purposes only.
RECOVER DATABASE NOREDO;


NOREDO tells RMAN not to apply any further redo, just the incremental backup.


Step 5: Resume Managed Recovery
Once recovery completes:
SQL-- Code Generated by Sidekick is for learning and experimentation purposes only.
ALTER DATABASE RECOVER MANAGED STANDBY DATABASE USING CURRENT LOGFILE DISCONNECT FROM SESSION;

Or, if not using Real-Time Apply:
SQL-- Code Generated by Sidekick is for learning and experimentation purposes only.
ALTER DATABASE RECOVER MANAGED STANDBY DATABASE DISCONNECT FROM SESSION;
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@2
19c softwareinstallation......
Download the Oracle Database 19C software from below link:
or copy from any other server
Copy the software to the server location : /oraexp/19C_software
Create Oracle Home directory: /u01/app/oracle/product/19.3.0/db_1
cd /u01/app/oracle/product/19.0/db_1
unzip -oq /oraexp/19c_Software/AIX.PPC64_193000_db_home.zip
Open X-session on No-machine NX client by opening terminal.
cd /u01/app/oracle/product/19.0/db_1

Execute ./runInstaller from terminal.
shh -X oraias@servername
We need to run these scripts..root.sh

When facing some issue.

a)Install database/client software only on certified operating system .
b) Following can be used as reference to verify if oracle database/client is certified on an operating system.
Locate Database Server or Client Certification Information on My Oracle Support (Doc ID 1295603.1)
c) Verify /tmp is not set with 'noexec'
d) Run software installation as below
export CV_ASSUME_DISTID=OL7 -- If software is installed on RHEL 8/OL8
cd <software directory>
./runInstaller
Note : Due to security limitations if noexec cannot be removed from /tmp ,temporary directory can be created in a different file system and export TEMP variables as below before running runInstaller
eg:-
1) mkdir -p /opt/app/oracle/tmp
2) export TMPDIR=/opt/app/oracle/tmp
export TMP=/opt/app/oracle/tmp
export TEMP=/opt/app/oracle/tmp
3) ./runInstaller



./runinstaller ....was not working..try this. it works

./runInstaller
ERROR: Unable to verify the graphical display setup. This application requires X display. Make sure that 
xdpyinfo exist under PATH variable.
/u01/app/oracle/product/19.0/db_1/perl/bin/perl: error while loading shared libraries: libnsl.so.1: cannot open 
shared object file: No such file or directory
conn with os team
install this pakage ...  sudo dnf install libnsl
libnsl-2.28-251.el8_10.22.x86_64
libnsl2-1.2.0-2.20180605git4a062cf.el8.x86_64
setup display 
export CV_ASSUME_DISTID=OL8
./runInstaller -ignorePrereq -J"-Doracle.install.database.validate.supportedOSCheck=false"


export ORACLE_HOME=/u01/app/oracle/product/19.0/db_1
export PATH=$ORACLE_HOME/OPatch:$PATH
can you please change the permission of /uo1/app
######################################33
datafile related
To check the total usage of datafile.
----------------------------------------------------------
SET PAGESIZE 140 LINESIZE 200;

set colsep |
 
SELECT tablespace_name,

       size_mb,

       free_mb,

       max_size_mb,

       max_free_mb,

       TRUNC((max_free_mb/max_size_mb) * 100) AS free_pct,

       ROUND((max_size_mb-max_free_mb)/max_size_mb*10,2) AS used_pct

FROM   (

        SELECT a.tablespace_name,

               b.size_mb,

               a.free_mb,

               b.max_size_mb,

               a.free_mb + (b.max_size_mb - b.size_mb) AS max_free_mb

        FROM   (SELECT tablespace_name,

                       TRUNC(SUM(bytes)/1024/1024) AS free_mb

                FROM   dba_free_space

                GROUP BY tablespace_name) a,

               (SELECT tablespace_name,

                       TRUNC(SUM(bytes)/1024/1024) AS size_mb,

                       TRUNC(SUM(GREATEST(bytes,maxbytes))/1024/1024) AS max_size_mb

                FROM   dba_data_files

                GROUP BY tablespace_name) b

        WHERE  a.tablespace_name = b.tablespace_name

       ) 

	   where tablespace_name = 'COSTPOINT_RPTDATA'

ORDER BY tablespace_name;
 

SELECT
    TABLESPACE_NAME,
    SUM(BYTES_USED) / 1024 / 1024 AS USED_MB,
    SUM(BYTES_FREE) / 1024 / 1024 AS FREE_MB,
    SUM(BYTES) / 1024 / 1024 AS TOTAL_MB,
    ROUND((SUM(BYTES_USED) / SUM(BYTES)) * 100, 2) AS PERCENT_USED
FROM
    V$TEMP_SPACE_HEADER
GROUP BY
    TABLESPACE_NAME;
SELECT df.tablespace_name "Tablespace",
  totalusedspace "Used MB",
  (df.totalspace - tu.totalusedspace) "Free MB",
  df.totalspace "Total MB",
  ROUND(100 * ( (df.totalspace - tu.totalusedspace)/ df.totalspace)) "% Free"
FROM
  (SELECT tablespace_name,
    ROUND(SUM(bytes) / 1048576) TotalSpace
  FROM dba_data_files
  GROUP BY tablespace_name
  ) df,
  (SELECT ROUND(SUM(bytes)/(1024*1024)) totalusedspace,
    tablespace_name
  FROM dba_segments
  GROUP BY tablespace_name
  ) tu
WHERE df.tablespace_name = 'COSTPOINT_DATA';
----------------------------------------------------------------
To check how many datafiles are there in a tablespace


select tablespace_name, status from dba_tablespaces;
 
 
 ======================================================
SELECT TABLESPACE_NAME, BYTES/1024/1024 AS MB_USED, MAXBYTES/1024/1024 AS MB_MAX
    FROM DBA_DATA_FILES
    WHERE TABLESPACE_NAME = 'COSTPOINT_RPTDATA'; 



-- Code Generated by Sidekick is for learning and experimentation purposes only.
SELECT
    df.tablespace_name,
    ROUND(SUM(df.bytes) / (1024 * 1024), 2) AS total_size_mb,
    ROUND(SUM(fs.bytes) / (1024 * 1024), 2) AS free_size_mb,
    ROUND((SUM(df.bytes) - SUM(fs.bytes)) / (1024 * 1024), 2) AS used_size_mb,
    df.autoextensible AS auto_extend
FROM
    dba_data_files df
LEFT JOIN
    dba_free_space fs ON df.tablespace_name = fs.tablespace_name
GROUP BY
    df.tablespace_name, df.autoextensible
ORDER BY
    'SYSAUX';
	
alter database datafile 49 resize 90M;


TABLESPACE_NAME                   MB_USED     MB_MAX
------------------------------ ---------- ----------
RCAT_ASP2                              60          0



COLUMN file_name FORMAT A70
SELECT file_id,
       file_name,
       ROUND(bytes/1024/1024) AS size_mb,
       ROUND(maxbytes/1024/1024) AS max_size_mb,
       autoextensible,
       increment_by,
       status
FROM   dba_data_files
WHERE  tablespace_name ='RCAT_PTLMIRP'
ORDER BY file_id;

ALTER DATABASE DATAFILE '/opt/data/TOOLSA/RCAT_PTLMIRP_01.dbf' RESIZE 200M;

I have already changed the dbora file script.I have worked with OS team. 


/delphix/CPAAV/datafile/opt/data/CPAP/DELOITTE_188.dbf

Alter tablespace COSTPOINT_DATA add datafile '/delphix/CPAAV/datafile/opt/data/CPAP/COSTPOINT_DATA_195.dbf'  SIZE 2048M AUTOEXTEND ON MAXSIZE 30720M;

Alter tablespace TEMP add tempfile '/opt/data/CT/temp03.dbf'  size 500M autoextend on;

SQL> update props$ set value$=0 where name='DST_SECONDARY_TT_VERSION';

1 row updated.

SQL> update props$ set value$='NONE' where name='DST_UPGRADE_STATE';

1 row updated.

SQL> commit;

Commit complete.

SQL> select * from props$ where name like 'DST%';

NAME 
-----------------------------------------
VALUE$ 
-----------------------------------------
COMMENT$ 
-----------------------------------------
DST_UPGRADE_STATE 
NONE 
State of Day Light Saving Time Upgrade 

DST_PRIMARY_TT_VERSION 
14 
Version of primary timezone data file 

DST_SECONDARY_TT_VERSION 
0 
Version of secondary timezone data file



3 rows selected.
---
Solution:
Execute the following scripts to fix timezone problem.



SQL> /

   FILE_ID FILE_NAME                                                       SIZE_MB MAX_SIZE_MB AUT INCREMENT_BY STATUS
---------- ------------------------------------------------------------ ---------- ----------- --- ------------ ---------
     25   /opt/idx/DEORGS1/CALENDAR_DAY_INDEX_20.dbf                        14005       30720 YES        12800 AVAILABLE
     26   /opt/idx/DEORGS1/CALENDAR_DAY_INDEX_19.dbf                        14905       30720 YES        12800 AVAILABLE
     27   /opt/idx/DEORGS1/CALENDAR_DAY_INDEX_18.dbf                        17705       30720 YES        12800 AVAILABLE
     


=====================================
set pagesize 300 linesize 200
SELECT tablespace_name,
       size_mb,
       free_mb,
       max_size_mb,
       max_free_mb,
       TRUNC((max_free_mb / max_size_mb) * 100) AS free_pct,
       ROUND((max_size_mb - max_free_mb) / max_size_mb * 100, 2) AS used_pct
FROM   (
         SELECT a.tablespace_name,
                b.size_mb,
                a.free_mb,
                b.max_size_mb,
                a.free_mb + (b.max_size_mb - b.size_mb) AS max_free_mb
         FROM   (SELECT tablespace_name,
                        TRUNC(SUM(bytes) / 1024 / 1024) AS free_mb
                 FROM   dba_free_space
                 GROUP BY tablespace_name) a,
                (SELECT tablespace_name,
                        TRUNC(SUM(bytes) / 1024 / 1024) AS size_mb,
                        TRUNC(SUM(GREATEST(bytes, maxbytes)) / 1024 / 1024) AS max_size_mb
                 FROM   dba_data_files
                 GROUP BY tablespace_name) b
         WHERE  a.tablespace_name = b.tablespace_name
       )
WHERE  tablespace_name = 'RCAT_COS2'
ORDER BY tablespace_name;

SELECT file_name, bytes/1024/1024 AS MB, autoextensible
FROM dba_data_files
WHERE tablespace_name = 'RCAT_COS1RCAT_COS1';



SQL> startup
ORA-01261: Parameter db_create_file_dest destination string cannot be translated
ORA-01262: Stat failed on a file destination directory
IBM AIX RISC System/6000 Error: 2: No such file or directory
SQL>






euawstaxbc00022 login issue
SELECT name FROM v$datafile;

Tablespace                        Used MB    Free MB   Total MB     % Free
------------------------------ ---------- ---------- ---------- ----------
COSTPOINT_RPTDATA                    1516    2368020    2369536        100
COSTPOINT_RPTDATA                       4    2369532    2369536        100
COSTPOINT_RPTDATA                    2884    2366652    2369536        100
COSTPOINT_RPTDATA                    1099    2368437    2369536        100
COSTPOINT_RPTDATA                    2418    2367118    2369536        100
COSTPOINT_RPTDATA                  286553    2082983    2369536         88
COSTPOINT_RPTDATA                     916    2368620    2369536        100
COSTPOINT_RPTDATA                     496    2369040    2369536        100
COSTPOINT_RPTDATA                 1575732     793804    2369536         34
COSTPOINT_RPTDATA                  180751    2188785    2369536         92
COSTPOINT_RPTDATA                  190402    2179134    2369536         92

Tablespace                        Used MB    Free MB   Total MB     % Free
------------------------------ ---------- ---------- ---------- ----------
COSTPOINT_RPTDATA                   85520    2284016    2369536         96
COSTPOINT_RPTDATA                     692    2368844    2369536        100
COSTPOINT_RPTDATA                       0    2369536    2369536        100
COSTPOINT_RPTDATA                 2280639      88897    2369536          4

ORA-00059: maximum number of DB_FILES exceeded
ALTER SYSTEM SET db_files = 300 SCOPE=SPFILE;

KFORBES


-- Code Generated by Sidekick is for learning and experimentation purposes only.
SELECT
    a.TABLESPACE_NAME,
    a.FILE_NAME,
    a.BYTES / 1024 / 1024 AS SIZE_MB,
    NVL(b.FREE_MB, 0) AS FREE_MB,
    (a.BYTES / 1024 / 1024) - NVL(b.FREE_MB, 0) AS USED_MB
FROM
    DBA_DATA_FILES a
    LEFT JOIN (
        SELECT
            FILE_ID,
            SUM(BYTES) / 1024 / 1024 AS FREE_MB
        FROM
            DBA_FREE_SPACE
        GROUP BY
            FILE_ID
    ) b ON a.FILE_ID = b.FILE_ID
WHERE
    a.TABLESPACE_NAME = 'COSTPOINT_DATA';
TA';
###############################################################33
dataguard commands'''

select name,open_mode,database_role from v$database;

>to check log gaps between primary and standby databases...
in primary.
archive log list;

in standby database.
select max(sequence#) from v$archived_log where applied= 'YES';

select process,client_process,status,thread#,sequence#,block#,blocks from v$managed_standby;
has context menu
shut immediate: 
startup nomount;
alter database mount standby database;

alter database recover managed standby database disconnect from session;

ALTER DATABASE RECOVER MANAGED STANDBY DATABASE CANCEL;

=============================================

scp p37262172_190000_Linux-x86-64.zip p6880880_190000_Linux-x86-64.zip oradba@USHDC8522:/oraexp/EMStage/Jan2025;
USAWSTAX05784 oraias...
Elc;30BtpElc;30Btp

===============================
BCT commands.

SELECT * FROM V$BLOCK_CHANGE_TRACKING;
ALTER DATABASE ENABLE BLOCK CHANGE TRACKING USING FILE '/opt/data/EMASYMP/rman_change_track.dbf';
alter database disable block change tracking;


select * from USER_ROLE_PRIVS where USERNAME='CALRAD';
 
select privilege 

from dba_sys_privs 

where grantee='CALRAD' 

order by 1;
 =============================
===================================================================
https://teams.microsoft.com/l/message/19:7e361649996f4f14b68699a70e89940c@thread.v2/1730212184156?context=%7B%22contextType%22%3A%22chat%22%7D


show parameter archive; ---in sdba 

check log_arc_dest _1 and _2 must be enable 

alter system set log_archive_dest_state_2=ENABLE;
 
and if still issus 


dgmgrl /
edit database 'EMASYMP_GDW' set state=online;
 
edit database 'EMASYMP_GDE' set state=apply-on;
 
 
 
SELECT INSTANCE_NAME, STATUS, DATABASE_STATUS FROM V$INSTANCE;
 
select name,open_mode from v$database;
chec k with secondary ta 

and prumary ---alter system switch logfile; to redo files happen in secondary

To check both primary and standby are in sync
Hi Team,

Data guard status is in sync now.

DGMGRL> show configuration;

Configuration - SYMP_DG

  Protection Mode: MaxPerformance
  Members:
  SYMP_HDC - Primary database
    SYMP_NDC - Physical standby database

Fast-Start Failover:  Disabled

Configuration Status:
SUCCESS   (status updated 29 seconds ago)
Dataguard commands...
select name,open_mode,database_role from v$database;

>to check log gaps between primary and standby databases...
For primary...
archive log list;

For standby..........
select max(sequence#) from v$archived_log where applied= 'YES';
-----------------------------------------------------------------
How to restart standby database..
shutimmediate;
startup nomount;
alter database mount standby database;
alter database recover managed standby database disconnect from session;
=========
SELECT profile FROM dba_users WHERE username = 'USER28';
=============================
Switch over activity


check status and configuration
 
----st to check sys passowrd 

dgmgrl /

show configuration;
----take the scree shots before and after failover 
dgmgrl /

Connect SYS/M4tgQ1yh@IHR1_E1AP
Show configuration;

Switchover to 'IHR1_W1AS';  
 
---screen shot failover havppen
 
check SIDPrimary is in mount mode and in sync or not-------- select open_mode from v$database;
alter system switch logfile;
 
Check case sensitive parameter in DB is TRUE
in sdba :  show parameter sensitive
 
show parameter service; ---for conection the database to tell the users 



=======
queries to start active dataguard standby db..
startup mount;
alter database open read only;
alter database recover managed standby database using current logfile disconnect from session;



 ==========================================
 
[usdhc8915 oraias CT]> python Oracle19.0-Upgrade-V1.py
exec(): 0509-036 Cannot load program python because of the following errors:
        0509-150   Dependent module /u01/app/oracle/product/12.2.0.1/db_1/lib/libexpat.a(libexpat.so.1) could not be loaded.
        0509-152   Member libexpat.so.1 is not found in archive

To run the python script first we need to export this command .\\
export LIBPATH=/opt/freeware/lib:$LIBPATH
=====================================
status gather command.
execute dbms_stats.gather_table_stats(ownname => 'GAE17', tabname =>'TEMP_PARAM_POLICY', estimate_percent =>DBMS_STATS.AUTO_SAMPLE_SIZE, method_opt => 'FOR ALL COLUMNS SIZEAUTO');

========================================================================================================
checking account locks

col USERNAME for a15
SELECT username, account_status, created, lock_date, expiry_date
  FROM dba_users
WHERE account_status != 'LOCK';SQL>   2    3

find /u01/app/oracle/admin/TOOLSA/adump -type f -mtime +7 -name '*.aud' -exec rm -f {} \;

/u01/app/oracle/diag/rdbms/orgprod1_e1ap/ORGPROD1/trace
find /u01/app/oracle/diag/rdbms/orgprod1_e1ap/ORGPROD1/trace -type f -mtime +5 -name '*.aud' -exec rm -f {} \;

/u01/app/oracle/diag/rdbms/orgprod1_e1ap/ORGPROD1/trace


find *.trc -mtime +2 -exec rm {} \;
find *.trm -mtime +2 -exec rm {} \;
find /u01/app/oracle/admin/PTST1/adump -type f -mtime +2 -name '*.aud' -exec rm -f {} \;
--------------------
DGMGRL> show configuration

Configuration - SCPP_HDC.US.DELOITTE.COM

  Protection Mode: MaxPerformance
  Members:
  SCPP_HDC - Primary database
    SCPP_NDC - Physical standby database
    SCPP_RPT - Physical standby database

Fast-Start Failover:  Disabled

Configuration Status:
SUCCESS   (status updated 53 seconds ago)

TY5_nxK6#3H2

TY5_nxK6#1H1

scp Patch_Script_Execute.ksh oradba@USHDC8522:/oraexp/EMStage
=======
SQL>
SQL> select max(sequence#) from v$archived_log where applied= 'YES';

MAX(SEQUENCE#)
--------------
         13939

SQL> archive log list
Database log mode              Archive Mode
Automatic archival             Enabled
Archive destination            /archive/APASYMP
Oldest online log sequence     13
Next log sequence to archive   16
Current log sequence           16
SQL>
------------f
col STATUS format a10
col hrs format 999.99
select SESSION_KEY, INPUT_TYPE, STATUS,to_char(START_TIME,'mm/dd/yy hh24:mi') start_time,
to_char(END_TIME,'mm/dd/yy hh24:mi') end_time,elapsed_seconds/3600 hrs from V$RMAN_BACKUP_JOB_DETAILS
order by session_key;

---------------------
[usawstaxbc00049 oraias BT]> pwd
/u01/app/oracle/product/13.4.0/agent13c/agent_inst/sysman/emd
[usawstaxbc00

[ushdc87041 orasym SYMN2P]> du -sh *
30M     admin
32M     audit
124K    bin
631M    cfgtoollogs
4.0K    checkpoints
22M     dba_scripts
553M    diag
92K     DiscoverTargetCatalog.xls
52K     IBM
16K     lost+found
4.0K    nohup.out
344K    oradiag_orasym
26M     oraInventory
47G     product
7.6M    scripts
25M     SYMNDLP_metadata.dmp
4.0K    SYMNDLP_metadata.log
4.0K    tdpoerror.log
8.0K    user_creation.sql
[ushdc87041 orasym SYMN2P]>
usawstaxbc00049
ushdc87041


SELECT process, status, sequence#, block#, blocks 
FROM v$managed_standby 
WHERE process = 'MRP';

RUN
{
allocate channel ch1 type disk format '/efs/catalog/usawstaxst00432/TOOLSB/ARCHIVELOGS/al_%t_%s_p%p';
sql 'alter system archive log current';
sql 'alter database backup controlfile to trace';
backup archivelog all delete all input;
RELEASE channel ch1;
}

exit;
=========exit;
Backup mountpoint is not availabel...
[usawstaxst00432 oraias TOOLSB]> df -h
Filesystem                           Size  Used Avail Use% Mounted on
devtmpfs                              16G     0   16G   0% /dev
tmpfs                                 16G  7.3G  8.1G  48% /dev/shm
tmpfs                                 16G  1.7G   14G  11% /run
tmpfs                                 16G     0   16G   0% /sys/fs/cgroup
/dev/nvme0n1p2                        90G   42G   49G  46% /
/dev/mapper/vgOracle-oracle_rdo       64G  4.3G   57G   8% /opt/rdo
/dev/mapper/vgOracle-u01             105G   81G   20G  81% /u01/app/oracle
/dev/mapper/vgOracle-archive_TOOLSB   25G   24G  9.6M 100% /archive/TOOLSB
/dev/mapper/vgOracle-archive_TOOLSA   25G  202M   23G   1% /archive/TOOLSA
/dev/mapper/vgOracle-oracle_ctl       64G   63M   61G   1% /opt/ctl
/dev/mapper/vgOracle-oracle_databkp   99G  7.8G   86G   9% /opt/databkp
/dev/mapper/vgOracle-oracle_data      64G   36G   25G  60% /opt/data
/dev/mapper/vgOracle-oracle_oraexp    50G  7.6G   39G  17% /oraexp
/dev/mapper/vgOracle-oracle_idx       64G   28K   61G   1% /opt/idx
/dev/mapper/vgOracle-lvtmp            25G  1.7M   24G   1% /tmp
tmpfs                                3.1G     0  3.1G   0% /run/user/54321
tmpfs                                3.1G     0  3.1G   0% /run/user/0
[usawstaxst00432 oraias TOOLSB]> cd /efs/catalog
-bash: cd: /efs/catalog: No such file or directory
[usawstaxst00432 oraias TOOLSB]> cd
[usawstaxst00432 oraias TOOLSB]> cd /efs/catalog
-bash: cd: /efs/catalog: No such file or directory
[usawstaxst00432 oraias TOOLSB]> cd /efs
[usawstaxst00432 oraias TOOLSB]> ll
==========
space issue...
[euawstaxst00016 oraias DEORGS1]> pwd
/u01/app/oracle/diag/clients/user_oraias/host_862561039_110/trace
===========

[usawstaxde00717 oraias PTLDV1]> cat GESRPDV1_run_backup_archivelog.rman
RUN
{
allocate channel ch1 type disk format '/efs-ges-backup-west/ges-non-prod/usawstaxde00717/GESRPDV1/ARCHIVELOGS/al_%t_%s_p%p';
#sql 'alter system archive log current';
#sql 'alter database backup controlfile to trace';
backup archivelog all delete all input;
RELEASE channel ch1;
}

exit;

Hi Team, we are facing issue in one of the COS2 standby  database logs are shipping but not applying 
already checked mrp, space listener.
On primary server  USAWSTAX05395 and standby USAWSTAXBC00049 COS2 db is in snyc
But in this standby server usawstaxbc00051 logs are not applying

SELECT GROUP#, MEMBER, BYTES FROM V$LOGFILE;
ALTER SYSTEM SWITCH LOGFILE;
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
patching steps

Download the patch file

Cross check the server

 

check the space you are going to unzip patch 
cd /oraexp/EMStage/Oct2025
mkdir Oct2025

Check opatch version
mv OPatch OPatch_oct25
copy opatch file to $OH
cp -r OPatch $OH

unzip opatch
 
check opatch version again

unzip patch 

cd bin 

dbshutALL.ksh


apply two patched

opatch lsinventory |grep applied

after patching 

in primary,,,,

cd bin

startdbALLUpgrade.ksh

startup upgrade;

cd /oraexp/EMStage 

Patch_Script_Execute.ksh      (db patch in primary onlyh )
cd $ORACLE_HOME/OPatch
./datapatch -verbose

cd bin

  or
shut immediate.

dbstartALL.ksh
lsnrctl status 
fp smon
. set_AH

emctl start agent

emctl status agent

in primary only.....

select name,open_mode from v$database;

set pages 300 lines 300         
 
col action form a12
 
col version form a40
 
col description form a70
 
col action_date form a20
 
col ACTION_TIME for a38 

select PATCH_ID,ACTION,STATUS,ACTION_TIME,DESCRIPTION from dba_registry_sqlpatch order by ACTION_TIME;

=====================================
For standby database
start listener

lsnrctl status 
lsnrctl start
. set_AH
emctl start agent 
emctl status agent

startup nomount;

alter database mount standby database;
in primary
dgmgrl /
 
show configuration; to check the sync
 

ps -ef | grep [o]patch

SQL> startup upgrade;
=============================================================

SELECT s.sid,
       s.serial#,
       s.username,
       s.status,
       s.sql_id,
       s.sql_child_number
FROM v$session s
WHERE s.status = 'ACTIVE'
  AND s.username IS NOT NULL
  AND s.sql_id IS NOT NULL;
  
  
SELECT sql_id, sql_text
FROM v$sql
WHERE sql_id = '3mwnvaww8p4h4';  


manually ...
./datapatch -verbose




export ORACLE_HOME=/u01/app/oracle/product/19.0/db_1
export PATH=$PATH:$ORACLE_HOME



export PATH=$ORACLE_HOME/OPatch:$PATH






RUN
        {
        allocate channel ch1 type disk;
        allocate channel ch2 type disk;
        allocate channel ch3 type disk;
        allocate channel ch4 type disk;
        sql 'alter system archive log current';
        sql 'alter database backup controlfile to trace';
        BACKUP archivelog all TAG 'ARC_LOG_Bckp'
        delete all input
        FORMAT '$BackupFileDirectory/al_%t_%s_p%p'
        CURRENT CONTROLFILE TAG 'cf1'
        FORMAT '$BackupFileDirectory/cf_%t_%s_p%p'
        SPFILE TAG 'sp1'
        FORMAT '$BackupFileDirectory/sp_%t_%s_p%p';
        RELEASE channel ch1;
        RELEASE channel ch2;
        RELEASE channel ch3;
        RELEASE channel ch4;
        }
       exit;
	   
	   
	   select file_id ,file_name from dba_tablespaces where tablespace_name=
	   
	   
	   
	   
	   
	   
	   WARNING: Following components are NOT in a valid state.
         This could cause patching failure. If it does, consider
         running utlrp.sql to bring components to VALID state.
         Then, re-run datapatch.

         CT : XOQ [INVALID]
BT:/u01/app/oracle/product/19.0/db_1:Y
ASP1:/u01/app/oracle/product/19.0/db_1:Y
ASP2:/u01/app/oracle/product/19.0/db_1:Y
ASP3:/u01/app/oracle/product/19.0/db_1:Y
COS1:/u01/app/oracle/product/19.0/db_1:Y
COS2:/u01/app/oracle/product/19.0/db_1:Y
COP1:/u01/app/oracle/product/19.0/db_1:Y
IHR1:/u01/app/oracle/product/19.0/db_1:Y
IHR2:/u01/app/oracle/product/19.0/db_1:Y
IHR3:/u01/app/oracle/product/19.0/db_1:Y
COP2:/u01/app/oracle/product/19.0/db_1:Y


startup nomount;

alter database mount standby database;



ORA-32004: obsolete or deprecated parameter(s) specified for RDBMS instance

Hi Team i was about to start working on dataguard Matt pinged me Antonio and 
Michael work on the standby database build.

drwxr-x--- 15 oradba oinstall  4096 Oct 29 15:15 OPatch
[ushydi0208 oradba TEST1]>  opatch version
/u01/app/oracle/product/19.0/db_1/OPatch/opatch: line 839: [: too many arguments
/u01/app/oracle/product/19.0/db_1/OPatch/opatch: line 839: [: too many arguments
Java (1.7) could not be located. OPatch cannot proceed!
OPatch returns with error code = 1
[ushydi0208 oradba TEST1]> ls -lrt



cd $ORACLE_HOME/OPatch
[usawstax05580 oraias ASP2]> ./datapatch -verbose
SQL Patching tool version 19.29.0.0.0 Production on Wed Oct 29 12:14:57 2025
Copyright (c) 2012, 2025, Oracle.  All rights reserved.

Log file for this invocation: /u01/app/oracle/cfgtoollogs/sqlpatch/sqlpatch_3020923_2025_10_29_12_14_57/sqlpatch_invocation.log

Connecting to database...OK
Gathering database info...done
Bootstrapping registry and package to current versions...done
Error: prereq checks failed!
verify_queryable_inventory returned ORA-20001: Latest xml inventory is not loaded into table
Prereq check failed, exiting without installing any patches.

Please refer to MOS Note 1609718.1 and/or the invocation log
/u01/app/oracle/cfgtoollogs/sqlpatch/sqlpatch_3020923_2025_10_29_12_14_57/sqlpatch_invocation.log
for information on how to resolve the above errors.

SQL Patching tool complete on Wed Oct 29 12:15:26 2025

python learning
===============
udemy 
inian axen


KZOLKIEWICZ
098765432

LIBPATH=/u01/app/oracle/product/13.4.0/agent13c/agent_13.4.0.0.0/lib:/u01/app/oracle/product/13.4.0/agent13c/agent_13.4.0.0.0/jlib
LD_LIBRARYPATH=/u01/app/oracle/product/13.4.0/agent13c/agent_13.4.0.0.0/lib:/u01/app/oracle/product/13.4.0/agent13c/agent_13.4.0.0.0/jlib

export AGENT_HOME=/u01/app/oracle/product/13.4.0/agent13c/agent_13.4.0.0.0
export LD_LIBRARYPATH=$ORACLE_HOME/lib:$LD_LIBRARYPATH
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
basic related...
USAWSENAQA00116 oradtk CPAQ
USAWSENAST00157 oradtk CPAS
CPAP primary
usawsena00371 oradtk CPAP
CPAP stadby
[USAWSENABC00051 oradtk CPAP]


[ oracls CLSQ]>
USAZUAUDDE90001       /mount/qausclsstrv2use2db/qafs
                      /mount/prdusclsstrv2use2db/prdfs
staging  
usazuaud90011 CLSS  
b8;ssL12b8;ssL12

PROD1
USAZUAUD90021  ....
USAZUAUD90031 BCP 
USAZUAUD90022  BCP  	
b8;ssL12
PROD2 HA
new prod mirrio -- PTLMIRP DB NAME--  USAWSTAX05370	,PTLP
USAWSTAX05823

CROSSCHECK BACKUP;

b8;ssL12   by9500082TS
  	 
b8;ssL12
Hostname: usgdcenaprd0032
USGDCENAPRD0032
      symns
b8;ssL12b8;ssL12
IP Address: 10.28.38.196
Location : Atlanta (BCP)

  
Prod DB2 - 10.212.147.28
BCP - 10.213.12.8
usawsenaqa00110  	CPAQ CPAA   .>.>>..     

usawstaxde00915 oraias  passwd b8;ssL12b8;ssL12

TOOLSA SERVER
usawstaxst00586
b8;ssL12b8;ssL12

/u01/app/oracle/scripts/maint
/u01/app/oracle/scripts/log/cron/


dba_admin
Elc;30Btp
USAWSTAX05784 oraias...
Elc;30BtpElc;30Btp
Renov@tion...deloitte wifi password
sudo su -..............switch to root user
 
link for the documents for install patching etc ..
https://teams.microsoft.com/l/messagte/19:7e361649996f4f14b68699a70e89940c@thread.v2/1730212184156?context=%7B%22contextType%22%3A%22chat%22%7D
. set_OMS----To set OEM HOME path(only applicable in oem servers)

OEM .. related
cd /u01/app/oracle/product/13.4.0/agent13c/agent_inst/bin

First set the environment ..to check the status of agent,
. set_AH
emctl status agent
emctl start agent
emctl stop agent       emctl stop agent -f
has context menu

when Agent stuck try this command ]
emctl secure agent


first we have to connect to jump server --oradba/oradba
ssh username@servername 
fp smon ---for checking database status whether it up/down
dbname---to set the environment (instead of . oraenv)

sdba    (it will connect us to sqlplus

oe      to check environment(shortcut)
ta      for alertlog ,
st      to check password of all users.


[usawstax05370 oraias GESAPPR1]> st |grep GESAPPR1 |grep DOCAPP

GESAPPR1:DOCAPP:QhGPLkJ#BrqD1A*6d9:DOCAPP[4:31 PM] , 

----------------------------------------------------------------------------------------------------



lINK FOR OEM......
https://ushdc8710.us.deloitte.com:7799/em/faces/logon/core-uifwk-console-login
 
username.... dba_admin
 
password.....Elc;30Btp

----------------------------------------------------------------------------------------------------

For server related issue
US TI Open Systems Services <USTIOpenSystemsServices@deloitte.com>

 TSM/TDP On-prem backup issues 
US TI Data Protection Services <USTIDataProtectionServices@deloitte.com>


GTS GTI Firewall Management
 Services Operations Leads <GTSGTIFirewallManagementServicesOperationsLeads@deloitte.com>

 
US ITS Network Data Center Services
Network Team <USITSNetworkDataCenterServicesNetworkTeam@deloitte.com>
=Incident (ORA 800) detected in /u01/app/oracle/diag/rdbms/scppv_g/SCPPV_G/alert/log.xml at time/line number: Wed Jul 31 13:34:53 2024/26207.

Please check with -     US TI Storage <USTIStorage@deloitte.com>
 
They will add
 
Anil Taras - POC
 
We have blocking in PTLQA1.  Who on GES Dev Team can we reach out to?           
Sainath, Samyuktha and Sarat are the right people to reach out to

 
[4:25 PM] Taragalla, venkataratnam
[usawstax05370 oraias GESAPPR1]> st |grep GER1 |grep DOCAPP

GESAPPR1:DOCAPP:QhGPLkJ#BrqD1A*6d9:DOCAPP[4:31 PM] , 

lINK FOR OEM......
https://ushdc8710.us.deloitte.com:7799/em/faces/logon/core-uifwk-console-login
 

 

Pletcher, Clifford <cpletcher@deloitte.com>
/u01/app/oracle/scripts/ges/ora_dba 


/u01/app/oracle/scripts/ges/ora_dba
IHR
[usawstax05395 oraias IHR3]>  . .bash_profi... by Kumari, Babita
[usawstax05395 oraias IHR3]>  . .bash_profile
[usawstax05395 oraias COP2]> pwd
/u01/app/oracle

Begin Reference, Oracle support SR- 1. De... 
7/15/2024 3:47 PM
Oracle support SR- 1. Deltek 0% space available 2. Emea dlp( datalose preventions), nodf no alerts from oem
Work on it.
ON PREM: OH - /u01/app/oracle SYS, SYSTEM -... by Kumari, Babita

ON PREM:
OH - /u01/app/oracle
SYS, SYSTEM - /u02/oradata/DB_NAME
clients tbs - /u03/oradata and /u04/oradata
temp - /u05/oradata
undo - /u06/oradata
redo - /u10 to /u13
ctl - /u14 to /u16
has context menu
GES AND USER ACCOUNTS ARE CONNECTED( FOR IHR ONLY)
eg ..GES1,GES...etc

echo "Test email" | mail -S smtp="smtp.us.deloitte.com" -s "Test Subject" balimalik@deloitte.com


INF-Database Services-Oracle
  
 
 
SRC /TOC by Kumari, Babita
Kumari, Babita
3:27 PM
SRC /TOC
rfcW_DB Services_Oracle by Kumari, Babita
Kumari, Babita
3:35 PM
rfcW_DB Services_Oracle
Link Service Portal - Global Technology Ser... by Kumari, Babita
Kumari, Babita
4:08 PM
Service Portal - Global Technology Services Self-Service (service-now.com)
Link Secret Server (deloitte.com) by Kumari, Babita
4:19 PM
Secret Server (deloitte.com)
Class 2 - Aug 21 - 22 Link https://www.even... by Taragalla, venkataratnam
4:23 PM
Class 2 - Aug 21 - 22
https://www.eventbrite.com/e/postgresql-training-virtual-ist-tickets-871864459067?aff=oddtdtcreator
Ali   Malik,   Bilal   Mahesh   Babu,   Dod... by Taragalla, venkataratnam
Taragalla, venkataratnam
4:23 PM
Ali Malik, Bilal Mahesh Babu, Dodla can you please check to regasiter this link for training 
4:23 PM
Can you join the call for a min by Kumari, Babita
4:23 PM
dbsnmp/sp58z2c by Kumari, Babita
4:26 PM
dbsnmp/sp58z2c
SYSMAN/oem13cbe by Kumari, Babita
4:26 PM
SYSMAN/oem13cbe
has context menu
16 apps from ges
BCP activity tomorrow 
patching ac
--------------------------------
when agent is not working 
cd /u01/app/oracle/product/13.4.0/agent13c/agent_inst/bin.

---------------------
Dommati Anvesh / INF-Open Systems
=======================

cp -r /export /orainstall
================================
telnet <servername> portno 
for agent its 3872


for crontab access etc 
Nichols, Chris

bkp teams
Lakshmi Suneetha, Kanchi
-----------------------------------
agent related  when agent is not showing anything
Host=USAWSTAXST00327.us.deloitte.com 
Target type=Host 
Target name=USAWSTAXST00327.us.deloitte.com 
Categories=Availability 
Message=Agent Unreachable (REASON = unable to connect to http server at https://USAWSTAXST00327.us.deloitte.com:3872/emd/main/. [handshake has no peer]). Host is Unreachable (REASON = Internal Error pinging the host for EMD_URL https://USAWSTAXST00327.us.deloitte.com:3872/emd/main/.Cannot run program "/bin/ping": error=2, A file or directory in the path name does not exist.).
................ 

fp 13.4 
kill the processs 
check fp 3874
kill -9 p no
 
stop the agent 
emctl secure agent
  ----password :   oem13cbe
start the agent 
==========================================
RUN {

ALLOCATE CHANNEL ch1 DEVICE TYPE DISK FORMAT '/nasbackup/SYMN2P/db_%U.bkp';

ALLOCATE CHANNEL ch2 DEVICE TYPE DISK FORMAT '/nasbackup/SYMN2P/db_%U.bkp';

ALLOCATE CHANNEL ch3 DEVICE TYPE DISK FORMAT '/nasbackup/SYMN2P/db_%U.bkp';

ALLOCATE CHANNEL ch4 DEVICE TYPE DISK FORMAT '/nasbackup/SYMN2P/db_%U.bkp';

BACKUP tag 'INCR0_DB' INCREMENTAL LEVEL=0 DATABASE PLUS ARCHIVELOG;

CROSSCHECK BACKUP;

DELETE NOPROMPT OBSOLETE;

DELETE NOPROMPT ARCHIVELOG ALL;

release channel ch1;

release channel ch2;

release channel ch3;

release channel ch4;

}  
 
select round((sum(bytes)/1048576/1024),2) from v$datafile;
 
ROUND((SUM(BYTES)/1048576/1024),2)

----------------------------------

                           2153.09

 
specification does not match any archived log in the repository

backup cancelled because there are no files to backup
=======================
When the agent is not behaving properly do these steps.
fp 13.4 
kill the processs 
check fp 3874
check fp emctl 
stop the agent 
emctl secure agent  ----password :   oem13cbe
start the agent 
---------------------------------
The view to check how the user got locked.
SELECT username,userhost,returncode,timestamp,OS_USERNAME
     FROM dba_audit_session
     WHERE username='USER28' and returncode=1017 ORDER BY sessionid DESC ;
 
 ====================================
 To check if any user has made any DDL changes in DB
 SELECT * FROM DBA_OBJECTS where object_type = 'TABLE' order by LAST_DDL_TIME desc;
 
 ----------------------------------
 To check how many files can we store in a tablespace in ...
 Show parameter file_size
 
 ALTER SYSTEM SET db_files = new_value SCOPE=SPFILE;

 
 ----------------------------------------------------
 You guys go for lunch..will check it post t... by Kumari, Babita
Kumari, Babita
1:49 PM
You guys go for lunch..will check it post that
2 Like reactions.
2
Call ended at 1:49 PM after 57 minutes 23 seconds
1:49 PMâ€ƒCall ended 57m 23s
  DB Name Selection OWNER OBJECT_NAME SUBOB... by Mahesh Babu, Dodla
Mahesh Babu, Dodla
2:58 PM
 
DB Name
	
Selection
	
OWNER
	
OBJECT_NAME
	
SUBOBJECT_NAME
	
OBJECT_TYPE
	
CREATED
	
LAST_DDL_TIME
	
TIMESTAMP
	
ORACLE_MAINTAINED


BT
	
6
	
SYS
	
WRH$_SYSMETRIC_HISTORY_INDEX
	
WRH$_SYSME_HIST_MXDB_MXSN
	
INDEX PARTITION
	
2/17/2024
	
2/17/2024
	
2024-02-17:18:21:51
	
N


 
	
 
	
 
	
 
	
 
	
 
	
 
	
 
	
 
	
 


BT
	
8
	
SYS
	
PREUPGRADE_DIR
	
 
	
DIRECTORY
	
2/17/2024
	
2/17/2024
	
2024-02-17:07:55:48
	
N
Hi Kumari, Babita sneha is called me , she want only these two because these owner is sys
Can you check who all have access to these ... by Kumari, Babita
Kumari, Babita
3:07 PM
Can you check who all have access to these objects apart from SYS
You might get it from dba_grantee...similar... by Kumari, Babita
Kumari, Babita
3:08 PM
You might get it from dba_grantee...similar to this view
1 Like reaction.
SQL> SELECT grantee, privilege FROM DBA_T... by Mahesh Babu, Dodla
Mahesh Babu, Dodla
3:19 PM
SQL> SELECT grantee, privilege
FROM DBA_TAB_PRIVS
WHERE table_name = 'PREUPGRADE_DIR' AND TYPE = 'DIRECTORY';  2    3
 
no rows selected
 
SQL> SELECT grantee, privilege
FROM DBA_TAB_PRIVS
WHERE table_name = 'WRH$_SYSMETRIC_HISTORY_INDEX' AND TYPE = 'INDEX PARTITION';  2    3
 
no rows selected
 
on the 2nd one...it should be index_name by Kumari, Babita
Kumari, Babita
3:19 PM
on the 2nd one...it should be index_name
don't put type by Kumari, Babita
Kumari, Babita
3:20 PM
don't put type
in first one...no table details...it's dir ... by Kumari, Babita
Kumari, Babita
3:20 PM
in first one...no table details...it's dir right
yes babita by Mahesh Babu, Dodla
Mahesh Babu, Dodla
3:20 PM
yes babita
SQL> desc DBA_TAB_PRIVS; Name            ... by Mahesh Babu, Dodla
Mahesh Babu, Dodla
3:20 PM
SQL> desc DBA_TAB_PRIVS;
Name                                      Null?    Type
----------------------------------------- -------- ----------------------------
GRANTEE                                            VARCHAR2(128)
OWNER                                              VARCHAR2(128)
TABLE_NAME                                         VARCHAR2(128)
GRANTOR                                            VARCHAR2(128)
PRIVILEGE                                          VARCHAR2(40)
GRANTABLE                                          VARCHAR2(3)
HIERARCHY                                          VARCHAR2(3)
COMMON                                             VARCHAR2(3)
TYPE                                               VARCHAR2(24)
INHERITED                                          VARCHAR2(3)

the view itself is incorrect Grinning face... by Kumari, Babita
Kumari, Babita
3:20 PM
the view itself is incorrect 
we have any views like this by Mahesh Babu, Dodla
Mahesh Babu, Dodla
3:20 PM
Edited
we have any views like this
TAB means table by Kumari, Babita
Kumari, Babita
3:21 PM
TAB means table
yes by Mahesh Babu, Dodla
Mahesh Babu, Dodla
3:21 PM
yes
yes..may be for object  by Kumari, Babita
Kumari, Babita
3:21 PM
yes..may be for object 
google for it by Kumari, Babita
Kumari, Babita
3:21 PM
google for it
SQL> select 'Grant '||privilege||' on direc... by Mahesh Babu, Dodla
Mahesh Babu, Dodla
3:41 PM
SQL> select 'Grant '||privilege||' on directory '||table_schema||'.'||table_name||' to '||grantee
from all_tab_privs
where table_name in (select directory_name from dba_directories);  2    3
 
'GRANT'||PRIVILEGE||'ONDIRECTORY'||TABLE_SCHEMA||'.'||TABLE_NAME||'TO'||GRANTEE
--------------------------------------------------------------------------------
Grant READ on directory SYS.DATA_PUMP_DIR to IMP_FULL_DATABASE
Grant READ on directory SYS.DATA_PUMP_DIR to EXP_FULL_DATABASE
Grant WRITE on directory SYS.DATA_PUMP_DIR to IMP_FULL_DATABASE
Grant WRITE on directory SYS.DATA_PUMP_DIR to EXP_FULL_DATABASE
Grant READ on directory SYS.ORACLE_OCM_CONFIG_DIR to ORACLE_OCM
Grant WRITE on directory SYS.ORACLE_OCM_CONFIG_DIR to ORACLE_OCM
Grant READ on directory SYS.ORACLE_OCM_CONFIG_DIR2 to ORACLE_OCM
Grant WRITE on directory SYS.ORACLE_OCM_CONFIG_DIR2 to ORACLE_OCM
Grant EXECUTE on directory SYS.DATA_PUMP_ORAEXP to SYSTEM
Grant READ on directory SYS.DATA_PUMP_ORAEXP to SYSTEM
Grant WRITE on directory SYS.DATA_PUMP_ORAEXP to SYSTEM
 
'GRANT'||PRIVILEGE||'ONDIRECTORY'||TABLE_SCHEMA||'.'||TABLE_NAME||'TO'||GRANTEE
--------------------------------------------------------------------------------
Grant EXECUTE on directory SYS.DATA_PUMP_BTTST to SYSTEM
Grant READ on directory SYS.DATA_PUMP_BTTST to SYSTEM
Grant WRITE on directory SYS.DATA_PUMP_BTTST to SYSTEM
Grant EXECUTE on directory SYS.PREUPG_OUTPUT_DIR to SYSTEM
Grant READ on directory SYS.PREUPG_OUTPUT_DIR to SYSTEM
Grant WRITE on directory SYS.PREUPG_OUTPUT_DIR to SYSTEM
Grant EXECUTE on directory SYS.DATA_PUMP_BTDV1 to SYSTEM
Grant READ on directory SYS.DATA_PUMP_BTDV1 to SYSTEM
Grant WRITE on directory SYS.DATA_PUMP_BTDV1 to SYSTEM
Grant EXECUTE on directory SYS.DATA_PUMP_CLONE_EXPORTS to SYSTEM
Grant READ on directory SYS.DATA_PUMP_CLONE_EXPORTS to SYSTEM
 
'GRANT'||PRIVILEGE||'ONDIRECTORY'||TABLE_SCHEMA||'.'||TABLE_NAME||'TO'||GRANTEE
--------------------------------------------------------------------------------
Grant WRITE on directory SYS.DATA_PUMP_CLONE_EXPORTS to SYSTEM
Grant EXECUTE on directory SYS.PROD_CUTOVER_BT to SYSTEM
Grant READ on directory SYS.PROD_CUTOVER_BT to SYSTEM
Grant WRITE on directory SYS.PROD_CUTOVER_BT to SYSTEM
 
26 rows selected.
 
we don't have that directory name in BT by Mahesh Babu, Dodla
Mahesh Babu, Dodla
3:41 PM
we don't have that directory name in BT
SELECT * FROM DBA_OBJECTS where object_type... by Kumari, Babita
Kumari, Babita
3:42 PM
Edited
SELECT * FROM DBA_OBJECTS where object_type = 'DIRECTORY' order by LAST_DDL_TIME desc;
How about running this..changing object_typ... by Kumari, Babita
Kumari, Babita
3:42 PM
How about running this..changing object_type to directory
I have modified it by Kumari, Babita
Kumari, Babita
3:43 PM
I have modified it
Begin Reference, SELECT * FROM DBA_OBJECTS ... by Kumari, Babita
Kumari, Babita
3:44 PM
Kumari, Babita
1/15/2025 3:42 PM
SELECT * FROM DBA_OBJECTS where object_type = 'DIRECTORY' order by LAST_DDL_TIME desc;
This should give the result
image by Mahesh Babu, Dodla
Mahesh Babu, Dodla
3:59 PM
image by Mahesh Babu, Dodla
Mahesh Babu, Dodla
4:07 PM
image by Mahesh Babu, Dodla
Mahesh Babu, Dodla
4:09 PM
can we connect once babita by Mahesh Babu, Dodla
Mahesh Babu, Dodla
4:12 PM
can we connect once babita
has context menu
Taragalla, venkataratnam is out of office and may not respond

hQL> show user
USER is "SYS"
SQL> alter user MOHAKEEM ACCOUNT UNLOCK;
 
User altered.
 
SQL> alter user MOHAKEEM identified by MohakeeM_#123;
alter user MOHAKEEM identified by MohakeeM_#123
*
ERROR at line 1:
ORA-28007: the password cannot be reused
 
 
SQL> alter user MOHAKEEM identified by MohakeeM_#1235;
 
User altered.
 
SQL> conn MOHAKEEM/MohakeeM_#1235;
Connected.
SQL>

usawstax05784 oraias ORA19C]> cat import_CT.par
DIRECTORY=DATA_PUMP_ORAEXP
DUMPFILE=expdp_CT_full_%U.dmp
logfile=CT_import_full_1.log
FULL=Y
parallel=8
# transform=disable_archive_logging:Y
REMAP_DIRECTORY=/u02/oradata/CT:/opt/data/CT,/u03/oradata/CT:/opt/data/CT,/u04/oradata/CT

Auto DB start post server reboot..
first we need to create file called dbora in /etc/init.d/ location
 
chmod 750 /etc/init.d/dbora ---- make the script executable
 
Configure the Script to Run at Boot
 
chkconfig --add dbora
chkconfig dbora on
 
need to copy the files called dbstartALL.ksh,dbshutALL.ksh in /u01/app/oracle/bin/ location
 
need to edit the oratab file , make sure that the entry for our database ends with Y
 
 
script for dbora file is
 
 
#!/bin/bash
# chkconfig: 35 99 10
# description: Starts and Stops Oracle and Listener processes
ORACLE_HOME=/u01/app/oracle/product/19.0/db_1
ORA_OWNER=oraias
PATH=${PATH}:$ORACLE_HOME/bin
HOST=`hostname`
PLATFORM=`uname`
export ORACLE_HOME PATH
case "$1" in
  'start')
        echo -n $"Starting Oracle DB: "
    su - $ORA_OWNER -c "/u01/app/oracle/bin/dbstartALL.ksh $ORACLE_HOME" &
   ;;
  'stop')
        echo -n $"Shutting down Oracle DB: "
    su - $ORA_OWNER -c "/u01/app/oracle/bin/dbshutALL.ksh $ORACLE_HOME" &
;;
'restart')
        echo -n $"Shutting down Oracle DB: "
          su - $ORA_OWNER -c "/u01/app/oracle/bin/dbshutALL.ksh $ORACLE_HOME" &
        sleep 5
        echo -n $"Starting Oracle DB: "
        su - $ORA_OWNER -c "/u01/app/oracle/bin/dbstartALL.ksh $ORACLE_HOME" &
  ;;
*)
        echo "usage: $0 {start|stop|restart}"
        exit
 
   ;;
esac
 
# End of script dbora


./dbca -J-Djava.io.tmpdir=/tmp

export EDITOR=vi
 
 
 select * from DBA_AUDIT_SESSION WHERE USERNAME='CALENDARXML'AND ACTION_NAME ='LOGON' RETURN_CODE='28000';
 SELECT *
FROM DBA_AUDIT_SESSION
WHERE USERNAME = 'CALENDARXML'
  AND RETURN_CODE = 28000
ORDER BY TIMESTAMP DESC;

The  how the user got locked.
SELECT username,userhost,returncode,timestamp,OS_USERNAME
     FROM dba_audit_session
     WHERE username='CALENDARXML' and returncode=1017 ORDER BY sessionid DESC;
	 
	 
	 SQL> SELECT *
FROM DBA_AUDIT_SESSION
WHERE USERNAME = 'GAE4'
ORDER BY TIMESTAMP DESC;  2    3    4

no rows selected

SQL> SELECT *
FROM DBA_AUDIT_SESSION
WHERE USERNAME = GAE4'
  AND RETURN_CODE = 28000
ORDER BY TIMESTAMP DESC;  2    3    4    5
  AND RETURN_CODE = 28000
      *
ERROR at line 4:
ORA-00904: "RETURN_CODE": invalid identifier
--------------------------------------------------------------------------------------------------------
COLUMN USERNAME      FORMAT A15
COLUMN USERHOST      FORMAT A20
COLUMN RETURNCODE    FORMAT 99999
COLUMN TIMESTAMP     FORMAT A20
COLUMN OS_USERNAME   FORMAT A15
SELECT username,userhost,returncode,timestamp,OS_USERNAME
     FROM dba_audit_session
     WHERE username='GAE8' and returncode=1017 ORDER BY sessionid DESC;  2    3

no rows selected
RTRTRTRT....

SQL> SELECT username, userhost, returncode, timestamp, OS_USERNAME
FROM dba_audit_session
WHERE username = 'GAE4'
ORDER BY sessionid DESC;  2    3    4

no rows selected

SQL> SELECT username, userhost, returncode, timestamp, OS_USERNAME
FROM dba_audit_session
WHERE username = 'CALENDARXML'
ORDER BY timestamp DESC;  2    3    4

no rows selected
select username , account_status, lock_date ,expiry_date, created from dba_users where username='CALENDARXML';

SELECT EVENT_TIMESTAMP, DBUSERNAME, ACTION_NAME, UNIFIED_AUDIT_POLICIES, OBJECT_SCHEMA, OBJECT_NAME, SQL_TEXT
FROM UNIFIED_AUDIT_TRAIL
WHERE ACTION_NAME = 'LOCK ACCOUNT'
ORDER BY EVENT_TIMESTAMP DESC;
=========================
commnad to check how the user got locked
SELECT dbusername, event_timestamp, action_name, return_code
FROM unified_audit_trail
WHERE dbusername = 'CALENDARXML'
AND action_name = 'LOGON'
AND return_code != 0
ORDER BY event_timestamp DESC;
The output shows multiple failed LOGON attempts by the user CALENDARXML with a RETURN_CODE of 1017..

The account was locked due to multiple incorrect credentials.entered during authorization attempts.
---------------
How to check CPU load in AIX server... to check which process is consuming more CPU's
        
 topas -P
----------------
commnad to check backup status are successfull or not
 
col STATUS format a10
col hrs format 999.99
select SESSION_KEY, INPUT_TYPE, STATUS,to_char(START_TIME,'mm/dd/yy hh24:mi') start_time,
to_char(END_TIME,'mm/dd/yy hh24:mi') end_time,elapsed_seconds/3600 hrs from V$RMAN_BACKUP_JOB_DETAILS
order by session_key;



echo "Test mail from Linux server" | sendmail recipient@balimalik@deloitte



RUN
{
allocate channel ch1 type disk format '/mount/qausclsstrv2use2db/qafs/CLSQ/ARCHIVELOGS/al_%t_%s_p%p';
sql 'alter system archive log current;
sql 'alter database backup controlfile to trace';
backup archivelog all delete all input;
RELEASE channel ch1;
}

exit;

rman target / catalog RMANSYMNP/k3g7_R6V@TOOLSB

Aq oem Login - Oracle Enterprise Manager (deloitte.com)
=============================

RMAN> RUN
{
    allocate channel ch1 type disk;
    allocate channel ch2 type disk;
 
    BACKUP DATABASE PLUS ARCHIVELOG
        FORMAT '/efs-ges-backup-west/ges-non-prod/usawstaxqa00026/PTLQA1/INCREMENTAL_L0/dbal_%t_%s_p%p';
 
    crosscheck backup;
    delete noprompt obsolete until time 'SYSDATE - 40';
 
    release channel ch1;
    release channel ch2;
}
exit;

if there is log gap and logs not present in standby also ;;;;

RUN {
  SET ARCHIVELOG DESTINATION TO '/archive/COS2';
  RESTORE ARCHIVELOG SEQUENCE BETWEEN 91577 AND 91596;
}
-- Crosscheck backups to update their status
RMAN> CROSSCHECK BACKUP;

-- List expired backups
RMAN> LIST EXPIRED BACKUP;

-- Delete expired backups
RMAN> DELETE EXPIRED BACKUP;

-- Report obsolete backups based on the retention policy
RMAN> REPORT OBSOLETE;

-- Delete obsolete backups
RMAN> DELETE OBSOLETE;
==========
Commands to remove Flashback parameters, Fra...
How to remove the flashback parameters......

ALTER SYSTEM SET db_flashback_retention_target= 0 SCOPE=BOTH;
ALTER SYSTEM SET db_recovery_file_dest='' SCOPE=BOTH;
ALTER SYSTEM RESET db_recovery_file_dest_size SCOPE=BOTH;

find /u01/app/oracle/admin/TOOLSA/adump -type f -mtime +7 -name '*.aud' -exec rm -f {} \;

/u01/app/oracle/admin/TOOLSA/adump

 69441
 68063
      1378
	  
	  
LISTENER_GADEMOSS.US.DELOITTE.COM =
  (ADDRESS = (PROTOCOL = TCP)(HOST = usawstaxst00423.us.deloitte.com)(PORT = 1521))


BTDEMO_E1AS.US.DELOITTE.COM =
  (DESCRIPTION =
    (ADDRESS = (PROTOCOL = TCP)(HOST = usawstaxst00256)(PORT = 1521))
    (CONNECT_DATA =
      (SERVICE_NAME = BTDEMO_E1AS.US.DELOITTE.COM)
      (SERVER = DEDICATED)
    )
  )

IMP2.US.DELOITTE.COM =
  (DESCRIPTION =
    (ADDRESS = (PROTOCOL = TCP)(HOST = usawstaxst00423.us.deloitte.com)(PORT = 1521))
    (CONNECT_DATA =
      (SERVER = DEDICATED)
      (SERVICE_NAME = IMP2.us.deloitte.com)
    )
  )

IMP1.US.DELOITTE.COM =
  (DESCRIPTION =
    (ADDRESS = (PROTOCOL = TCP)(HOST = usawstaxst00423.us.deloitte.com)(PORT = 1521))
    (CONNECT_DATA =
      (SERVER = DEDICATED)
      (SERVICE_NAME = IMP1.us.deloitte.com)
    )
  )

BTDEMO_E1AP.US.DELOITTE.COM =
  (DESCRIPTION =
    (ADDRESS = (PROTOCOL = TCP)(HOST = usawstaxst00423.us.deloitte.com)(PORT = 1521))
    (CONNECT_DATA =
      (SERVER = DEDICATED)
      (SERVICE_NAME = BTDEMO_E1AP.US.DELOITTE.COM)
    )
  )

PTST1 =
  (DESCRIPTION =
    (ADDRESS = (PROTOCOL = TCP)(HOST = usawstaxst00423.us.deloitte.com)(PORT = 1521))
    (CONNECT_DATA =
      (SERVER = DEDICATED)
      (SERVICE_NAME = PTST1.us.deloitte.com)
    )
  )
===================
 user related
 
COLUMN USERNAME         HEADING 'DB Username'    FORMAT A15
COLUMN OS_USERNAME      HEADING 'OS User'        FORMAT A15
COLUMN USERHOST         HEADING 'Host/IP'        FORMAT A40
COLUMN TERMINAL         HEADING 'Terminal'       FORMAT A15
COLUMN LOGIN_TIME       HEADING 'Login Time'     FORMAT A22
COLUMN ACTION_NAME      HEADING 'Action'         FORMAT A10
COLUMN RETURNCODE       HEADING 'Return Code'    FORMAT 99999
SELECT
    USERNAME,
    OS_USERNAME,
    USERHOST,
    TERMINAL,
    TO_CHAR(EXTENDED_TIMESTAMP, 'DD-MON-YYYY HH24:MI:SS') AS LOGIN_TIME,
    ACTION_NAME,
    RETURNCODE
FROM
    dba_audit_session
WHERE
    USERNAME = 'GAE27'
    AND EXTENDED_TIMESTAMP BETWEEN TO_DATE('25/05/2025', 'DD/MM/YYYY')
                              AND TO_DATE('25/06/2025', 'DD/MM/YYYY') + 1
ORDER BY
    EXTENDED_TIMESTAMP DESC
	
=================
COLUMN USERNAME         HEADING 'DB Username'    FORMAT A15
COLUMN OS_USERNAME      HEADING 'OS User'        FORMAT A15
COLUMN USERHOST         HEADING 'Host/IP'        FORMAT A40
COLUMN TERMINAL         HEADING 'Terminal'       FORMAT A15
COLUMN LOGIN_TIME       HEADING 'Login Time'     FORMAT A22
COLUMN ACTION_NAME      HEADING 'Action'         FORMAT A10
COLUMN RETURNCODE       HEADING 'Return Code'    FORMAT 99999
SELECT
    USERNAME,
    OS_USERNAME,
    USERHOST,
    TERMINAL,
    TO_CHAR(EXTENDED_TIMESTAMP, 'DD-MON-YYYY HH24:MI:SS') AS LOGIN_TIME,
    ACTION_NAME,
    RETURNCODE
FROM
    dba_audit_session
WHERE
    USERNAME = 'GAE20'
    AND EXTENDED_TIMESTAMP BETWEEN TO_DATE('29/05/2025', 'DD/MM/YYYY')
                              AND TO_DATE('06/08/2025', 'DD/MM/YYYY') + 1
ORDER BY
    EXTENDED_TIMESTAMP DESC;


set lines 200 pages 200


SELECT username, account_status
FROM dba_users
WHERE account_status LIKE '%LOCKED%'; 

SELECT dbusername, event_timestamp, action_name, return_code, client_identifier, userhost, client_program_name
FROM unified_audit_trail
WHERE dbusername = 'GAE10'
AND action_name = 'LOGON'
AND return_code = 1017
ORDER BY event_timestamp DESC;


SELECT dbusername, event_timestamp, action_name, return_code
FROM unified_audit_trail
WHERE dbusername = 'GAE10'
AND action_name = 'LOGON'
AND return_code != 0
ORDER BY event_timestamp DESC;

SELECT username,
       userhost,
       returncode,
       timestamp,
       os_username
FROM dba_audit_session
WHERE username = 'GAE10'
  AND returncode = 1017
ORDER BY sessionid DESC;


SELECT username, account_status
FROM dba_users
WHERE username = 'USER28';
	
	
	
passwd for this server [euawstaxbc00022 oraias DEORGP1]> has been changed
new passwd is ..    
Elc;30BtpElc;30Btp

 ------> select * from dual@PORTAL_LINK.US.DELOITTE.COM;
 
 
step1:

=====

[usawstaxst00259 oraias ORGTST1]>

SQL> select * from dual@ORGANIZER_ORGMOVE_US2EU.US.DELOITTE.COM;

select * from dual@ORGANIZER_ORGMOVE_US2EU.US.DELOITTE.COM

*

ERROR at line 1:

ORA-12154: TNS:could not resolve the connect identifier specified
 
step2: add new tns entries of target DB

=======================================
 
DEORGS1.DEDHC.COM =

(DESCRIPTION =

(ADDRESS = (PROTOCOL = TCP)(HOST = 10.231.78.45)(PORT = 1521))

(CONNECT_DATA =

(SERVER = DEDICATED)

(SERVICE_NAME = DEORGS1.DEDHC.COM)

)

)
 
step2: drop and recreate DB link

=======================================

SQL> drop public database link ORGANIZER_ORGMOVE_US2EU.US.DELOITTE.COM;
 
Database link dropped.
 
 
get ORGANIZER password from target DB or from app team and recreate DB link.
 
CREATE PUBLIC DATABASE LINK "ORGANIZER_ORGMOVE_US2EU.US.DELOITTE.COM"

CONNECT TO "ORGANIZER" IDENTIFIED BY "A8p$Mf#Yf_"

USING 'DEORGS1.us.deloitte.com';
 
--------------------------------------------
 
ASPNET_DBLINK.US.DELOITTE.COM
 
select dbms_metadata.get_ddl('ASPNET_DBLINK.US.DELOITTE.COM','REMOTE','PUBLIC') from dual;
 
select * from dual@ASPNET_DBLINK.US.DELOITTE.COM;
 
select sysdate from dual@ASPNET_DBLINK.US.DELOITTE.COM;

DBlink related...

US
Servers:usawstax05370.us.deloitte.com
Service:ORGPROD1.US.DELOITTE.COM
Schema/User:Organizer,GODATA

update latest password in below DB link 

Server:EUAWSTAX00009.us.deloitte.com
Service:DEORGP1.US.DELOITTE.COM

DB LInk:ORGANIZER_ORGMOVE_EU2US.DEDHC.COM
----------------------------------

ALTER USER GODATA IDENTIFIED BY "m%~j095cd%hyz@Z";
ALTER USER ORGANIZER IDENTIFIED BY "m%~j095cd%hyz@Z";

DROP DATABASE LINK ORGANIZER_ORGMOVE_EU2US.DEDHC.COM;

CREATE DATABASE LINK ORGANIZER_ORGMOVE_EU2US.DEDHC.COM
CONNECT TO Organizer IDENTIFIED BY "m%~j095cd%hyz@Z"
USING 'DEORGP1.US.DELOITTE.COM';

CREATE DATABASE LINK ORGANIZER_ORGMOVE_EU2US.DEDHC.COM
CONNECT TO GODATA IDENTIFIED BY "'m%~j095cd%hyzZ"
USING 'DEORGP1.US.DELOITTE.COM';


SELECT db_link, username, host
FROM all_db_links
WHERE db_link ='ORGANIZER_ORGMOVE_EU2US.DEDHC.COM';

  ORGPROD1:ORGANIZER:C8RSaXgG6IU_zT:APPUSER
  ORGPROD1:GODATA:C8RSaXgG6IU_zT:APPUSE
  
  
DROP PUBLIC DATABASE LINK ORGANIZER_ORGMOVE_EU2US.DEDHC.COM

 
 sidekick link
https://sidekick.deloitte.com/conversation/f4a3f5c3-473a-4496-95ba-7fe8006d0a97
	echo "Subject: Test Email" | sendmail balimalik@deloitte.com
	
	echo "This is a test email" | mail -s "Test Subject"  balimalik@deloitte.com

LRICHTER


SELECT USERNAME, ACCOUNT_STATUS, CREATED, PROFILE
FROM DBA_USERS
WHERE USERNAME = 'CMCNEIL';


file system server verification 

localaccount creation 

password set 

efs set for backup 

copy the software 19c to new server 

gui working or not
 
installation 

brinary 

  path there 

.bash profile copy from other server and run . .bashprofile  chomod 722 .bashprofile 

check the bin folder and copy /u01/bin path scripts 

pacting and opatch version 

db creation 

oem adding 

tns 

listner 

schema tab 

bin folder (need to copu to orahiome )

enable the auto start up after rebbot 

backup set up 

catalog dbs 

scripts the odit log travs in crontab
 ==============
 while creating the db check this from refrence server...
 SELECT parameter, value
 FROM v$nls_parameters
 WHERE parameter IN ('NLS_NCHAR_CHARACTERSET','NLS_CHARACTERSET');
 =====================
 
 command to check db size 
 
 SELECT
  ROUND(SUM(bytes) / (1024 * 1024 * 1024), 2) AS "Database Size (GB)"
FROM
  dba_data_files;
I think if we will not restart the dbora service. it will not work after reboot.
Because service is running with ORAIAS USER instead of ORACLS.

AKANKSJHA

Can you please review the server usawstaxde00717 it responding very slow as we are applying the patches first time after cpu reduction 
and agent is not starting for some reason

Hi Team,
The issue is no longer presentâ€”no further action needed. Please ignore my earlier request.
____________________________+++++++++++++++++++++++++++++++++++_______________________________
OEM installation.
click on agent  ---target setup ---agent deccom (any step)
agent -----target setup ---agent deccom ---continue
 
continue -----only in OEM server will be removed
 
remove the folder from the server after oem done 13.4
 
AGENT INSTALLATION
  
create the folder in the servr till  agent_inst
settings ---add target -----manually ---add host targets host and platform ---------server name full USAZUAUDDE90001 us.deloiite.com ------platform
 
 
FOR LINUX: /usr/bin/sudo -u %RUNAS% %COMMAND%
FOR AIX : /opt/pware64/bin/sudo -u %RUNAS% %COMMAND%
additional parameters :  -ignorePrereqs

USAWSTAX05784.us.deloitte.com

ADD_HOST_DBA_ADMIN_Jan_6_2025_6:16:26_AM_CST

=====================================================_________________+++++++++++++++++++++++++
PT related
How to check SID and SERIAL# and kill a session in oracle.
Using OEM
First entre db name and search 
 navigate to 'performance' 'Performance hub''SQL MONITORING'
 select SQL ID
 and check time
 
 select * from V$SESSION where SQL_ID = 'a1nks42zd3wrn';
  desc v$session;
 
select SERIAL#,SID from V$SESSION where SQL_ID = '83f203wm01gyh';

   SERIAL#        SID
---------- ----------
     25166       2288
                            SID serial  
ALTER SYSTEM KILL SESSION '2628,44742';
select SERIAL#,SID from V$SESSION where SQL_ID = '8sq9ztah3m3f1';

SERIAL#    SID
------- ------
  21076      4


SERIAL#    SID
------- ------
  32573   3085





SQL>  select SERIAL#,SID from V$SESSION where SQL_ID = '542dxk6kmtkns';

SERIAL#    SID
------- ------
  29277   3080

https://deloitteglobal.service-now.com/incident.do?sys_id=fd4878b08716da5052a133790cbb35a1





SELECT log_date, job_name, status, error#, additional_info
FROM dba_scheduler_job_log WHERE job_name = 'SVCWDAP.WDAP_LOADER.LOAD_DAILY'
ORDER BY log_date DESC;

------------------------------
SELECT
    blocking_session,
    sid,
    serial#,
    wait_class,
    seconds_in_wait
FROM
    v$session
WHERE
    blocking_session IS NOT NULL
ORDER BY
    blocking_session;
	
	select
   c.owner,
   c.object_name,
   c.object_type,
   b.sid,
   b.serial#,
   b.status,
   b.osuser,
   b.machine
from
   v$locked_object a,
   v$session b,
   dba_objects c
where
   b.sid = a.session_id and
   a.object_id = c.object_id;
   
   SELECT
    blocking_session.sid AS blocking_sid,
    blocking_session.serial# AS blocking_serial,
    blocking_session.username AS blocking_username,
    blocking_session.osuser AS blocking_osuser,
    blocking_session.machine AS blocking_machine,
    blocking_session.program AS blocking_program,
    blocked_session.sid AS blocked_sid,
    blocked_session.serial# AS blocked_serial,
    blocked_session.username AS blocked_username,
    blocked_session.osuser AS blocked_osuser,
    blocked_session.machine AS blocked_machine,
    blocked_session.program AS blocked_program,
    blocked_session.event AS blocked_event,
    blocked_session.wait_time AS blocked_wait_time,
    blocked_session.seconds_in_wait AS blocked_seconds_in_wait
FROM
    v$session blocked_session
JOIN
    v$session blocking_session
ON
    blocked_session.blocking_session = blocking_session.sid
WHERE
    blocked_session.blocking_session = 1408
ORDER BY
    blocked_session.seconds_in_wait DESC;
	
	----------------------
	
	SELECT
    sid,
    serial#,
    username,
    osuser,
    machine,
    program,
    status,
    event,
    wait_time,
    seconds_in_wait
FROM
    v$session
WHERE
    sid = 1408;
	---------------
	SID: 1408
Serial#: 62420
Username: TC_0005
OS User: usgpsqacpsvc
Machine: USAWSITSQA01504
Program: JDBC Thin Client
Status: INACTIVE
Event: SQL*Net message from client
Wait Time: 0
Seconds in Wait: 60
----------------------

SET LINESIZE 200
SET PAGESIZE 50

COLUMN sample_time FORMAT A20
COLUMN sid FORMAT 9999
COLUMN serial FORMAT 99999
COLUMN user_id FORMAT 99999
COLUMN sql_id FORMAT A13
COLUMN event FORMAT A30
COLUMN blocking_sid FORMAT 9999
COLUMN blocking_serial FORMAT 99999
COLUMN wait_time FORMAT 99999
COLUMN time_waited FORMAT 99999

SELECT
    ash.sample_time,
    ash.session_id AS sid,
    ash.session_serial# AS serial,
    ash.user_id,
    ash.sql_id,
    ash.event,
    ash.blocking_session AS blocking_sid,
    ash.blocking_session_serial# AS blocking_serial,
    ash.wait_time,
    ash.time_waited
FROM
    dba_hist_active_sess_history ash
WHERE
    ash.session_id = 1408
    AND ash.sample_time >= SYSDATE - 7
ORDER BY
    ash.sample_time DESC;
	
	
	
	------ Set the linesize to accommodate the width of your data
SET LINESIZE 200
SET PAGESIZE 50
SET LONG 1000000
COLUMN sample_time FORMAT A30
COLUMN sid FORMAT 9999
COLUMN serial FORMAT 99999
COLUMN user_id FORMAT 9999
COLUMN sql_id FORMAT A13
COLUMN event FORMAT A30
COLUMN blocking_sid FORMAT 9999
COLUMN blocking_serial FORMAT 99999
COLUMN wait_time FORMAT 999999
COLUMN time_waited FORMAT 999999
---------------------------------------------
select SERIAL#,SID from V$SESSION where SQL_ID = '8b5uhd8px6q0a';

   SERIAL#        SID
---------- ----------
     17140         63
     47522       1133
     51826       1757
      4662       1911
---------------------------------
select SERIAL#,SID from V$SESSION where SQL_ID = '542dxk6kmtkns';

   SERIAL#        SID
---------- ----------
     17140         63
     47522       1133
     51826       1757
      4662       1911



SQL> ALTER SYSTEM KILL SESSION '1133,47522';

System altered.
SQL>
USHDC 8463
----------------------


a1nks42zd3wrn
  SERIAL#        SID
---------- ----------
     35763        214
      1372        517
ALTER SYSTEM KILL SESSION '214,35763';
ALTER SYSTEM KILL SESSION '517,1372';

SERIAL#        SID
---------- ----------
     30828         11
     52999         14
ALTER SYSTEM KILL SESSION '14,52999';


how to check blocking session....

SELECT
    blocking_session,
    sid,
    serial#,
    wait_class,
    seconds_in_wait
FROM
    v$session
WHERE
    blocking_session IS NOT NULL
ORDER BY
    blocking_session;
	
	select
   c.owner,
   c.object_name,
   c.object_type,
   b.sid,
   b.serial#,
   b.status,
   b.osuser,
   b.machine
from
   v$locked_object a,
   v$session b,
   dba_objects c
where
   b.sid = a.session_id and
   a.object_id = c.object_id;
   
   SELECT
    blocking_session.sid AS blocking_sid,
    blocking_session.serial# AS blocking_serial,
    blocking_session.username AS blocking_username,
    blocking_session.osuser AS blocking_osuser,
    blocking_session.machine AS blocking_machine,
    blocking_session.program AS blocking_program,
    blocked_session.sid AS blocked_sid,
    blocked_session.serial# AS blocked_serial,
    blocked_session.username AS blocked_username,
    blocked_session.osuser AS blocked_osuser,
    blocked_session.machine AS blocked_machine,
    blocked_session.program AS blocked_program,
    blocked_session.event AS blocked_event,
    blocked_session.wait_time AS blocked_wait_time,
    blocked_session.seconds_in_wait AS blocked_seconds_in_wait
FROM
    v$session blocked_session
JOIN
    v$session blocking_session
ON
    blocked_session.blocking_session = blocking_session.sid
WHERE
    blocked_session.blocking_session = 1408
ORDER BY
    blocked_session.seconds_in_wait DESC;
	
	----------------------
	
	SELECT
    sid,
    serial#,
    username,
    osuser,
    machine,
    program,
    status,
    event,
    wait_time,
    seconds_in_wait
FROM
    v$session
WHERE
    sid = 1408;
	---------------
	SID: 1408
Serial#: 62420
Username: TC_0005
OS User: usgpsqacpsvc
Machine: USAWSITSQA01504
Program: JDBC Thin Client
Status: INACTIVE
Event: SQL*Net message from client
Wait Time: 0
Seconds in Wait: 60
----------------------

SET LINESIZE 200
SET PAGESIZE 50

COLUMN sample_time FORMAT A20
COLUMN sid FORMAT 9999
COLUMN serial FORMAT 99999
COLUMN user_id FORMAT 99999
COLUMN sql_id FORMAT A13
COLUMN event FORMAT A30
COLUMN blocking_sid FORMAT 9999
COLUMN blocking_serial FORMAT 99999
COLUMN wait_time FORMAT 99999
COLUMN time_waited FORMAT 99999

SELECT
    ash.sample_time,
    ash.session_id AS sid,
    ash.session_serial# AS serial,
    ash.user_id,
    ash.sql_id,
    ash.event,
    ash.blocking_session AS blocking_sid,
    ash.blocking_session_serial# AS blocking_serial,
    ash.wait_time,
    ash.time_waited
FROM
    dba_hist_active_sess_history ash
WHERE
    ash.session_id = 1408
    AND ash.sample_time >= SYSDATE - 7
ORDER BY
    ash.sample_time DESC;
	
	
	
	------ Set the linesize to accommodate the width of your data
SET LINESIZE 200
SET PAGESIZE 50
SET LONG 1000000
COLUMN sample_time FORMAT A30
COLUMN sid FORMAT 9999
COLUMN serial FORMAT 99999
COLUMN user_id FORMAT 9999
COLUMN sql_id FORMAT A13
COLUMN event FORMAT A30
COLUMN blocking_sid FORMAT 9999
COLUMN blocking_serial FORMAT 99999
COLUMN wait_time FORMAT 999999
COLUMN time_waited FORMAT 999999
======================================
SQL> /


SQL> exit
Disconnected from Oracle Database 19c Enterprise Edition Release 19.0.0.0.0 - Production
Version 19.26.0.0.0
[usawsenaqa00110 oradtk CPAQ]> date
Tue Apr  8 02:31:16 CDT 2025
[usawsenaqa00110 oradtk CPAQ]>
------------------------------

SET LINESIZE 200
COLUMN SID         FORMAT 99999
COLUMN SERIAL#     FORMAT 99999
COLUMN USERNAME    FORMAT A15
COLUMN STATUS      FORMAT A10
COLUMN OSUSER      FORMAT A15
COLUMN LOCK_TYPE   FORMAT A10
COLUMN ID1         FORMAT 9999999999
COLUMN ID2         FORMAT 9999999999
COLUMN LMODE       FORMAT 99
COLUMN REQUEST     FORMAT 99
COLUMN BLOCK       FORMAT 9
SELECT
    s.sid,
    s.serial#,
    s.username,
    s.status,
    s.osuser,
    l.type AS lock_type,
    l.id1,
    l.id2,
    l.lmode,
    l.request,
    l.block
FROM
    v$session s
JOIN
    v$lock l ON s.sid = l.sid
WHERE
    s.username = 'CALENDARXML'
    AND l.block = 0
    AND l.request > 0;
	================================
	Create SQL Tuning Task:
SQL

DECLARE
  l_sql_tune_task_id VARCHAR2(100);
BEGIN
  l_sql_tune_task_id := DBMS_SQLTUNE.CREATE_TUNING_TASK(
    sql_id => 'f6qykuphvc92a',
    scope  => DBMS_SQLTUNE.SCOPE_COMPREHENSIVE,
    time_limit => 60,
    task_name => 'sql_tuning_task_f6qykuphvc92a',
    description => 'Tuning task for SQL ID f6qykuphvc92a'
  );
END;
/


  Execute SQL Tuning Task:
SQL

BEGIN
  DBMS_SQLTUNE.EXECUTE_TUNING_TASK(task_name => 'sql_tuning_task_f6qykuphvc92a');
END;
/

Accept SQL Profile:
SQL

DECLARE
  l_sql_profile_name VARCHAR2(100);
BEGIN
  l_sql_profile_name := DBMS_SQLTUNE.ACCEPT_SQL_PROFILE(
    task_name => 'sql_tuning_task_f6qykuphvc92a',
    name => 'sql_profile_f6qykuphvc92a'
  );
END;
/

Verify SQL Profile
SQL

SELECT name, type, status
FROM dba_sql_profiles
WHERE name = 'sql_profile_f6qykuphvc92a';
------------------------------------------
INC8218706 to increase mountpoint /opt/data to 300gb USAWSTAXBC00043




select value from fw_config where key='ScheduleMeetingUrl' and app='MobileCalendar';

VALUE
--------------------------------------------------------------------------------
https://meetingscheduler.deloitte.com/SamlTarget?mCategory=

SQL>
SQL> Update fw_config set value='https://msweb-us.employeeservice.ges.deloitte.com/Home/SamlTarget?mCategory=' where key='ScheduleMeetingUrl' and app='MobileCalendar';

Commit;

1 row updated.

SQL> SQL>
Commit complete.



micheal...
do we need to the space...

Host=ushdc8656.us.deloitte.com 
Target type=Host 
Target name=ushdc8656.us.deloitte.com 
Categories=Capacity 
Message=Filesystem /nasbackup has 4.95% available space, fallen below warning (20) or critical (5) threshold. 
Severity=Critical 

BEGIN
  DBMS_STATS.GATHER_SCHEMA_STATS(
    ownname => 'ASPNET2',
    estimate_percent => DBMS_STATS.AUTO_SAMPLE_SIZE,
    method_opt => 'FOR ALL COLUMNS SIZE AUTO',
    cascade => TRUE
  );
END;
/

Command to check last analyzed ....stats gather when..
SQL> SELECT table_name, last_analyzed
FROM dba_tab_statistics
WHERE owner = 'ASPNET2'

=============+++++++++++++++++++--------------------------
dbora file automatic startup after server reboot


Automatic startup and shutdown script..
first we need to create file called dbora in /etc/init.d/ location
 
chmod 750 /etc/init.d/dbora ---- make the script executable
 
Configure the Script to Run at Boot
 
chkconfig --add dbora
chkconfig dbora on
 
need to copy the files called dbstartALL.ksh,dbshutALL.ksh in /u01/app/oracle/bin/ location
 
need to edit the oratab file , make sure that the entry for our database ends with Y
 
 
script for dbora file is
 
 
#!/bin/bash
# chkconfig: 35 99 10
# description: Starts and Stops Oracle and Listener processes
ORACLE_HOME=/u01/app/oracle/product/19.0/db_1
ORA_OWNER=oraias
PATH=${PATH}:$ORACLE_HOME/bin
HOST=`hostname`
PLATFORM=`uname`
export ORACLE_HOME PATH
case "$1" in
  'start')
        echo -n $"Starting Oracle DB: "
    su - $ORA_OWNER -c "/u01/app/oracle/bin/dbstartALL.ksh $ORACLE_HOME" &
   ;;
  'stop')
        echo -n $"Shutting down Oracle DB: "
    su - $ORA_OWNER -c "/u01/app/oracle/bin/dbshutALL.ksh $ORACLE_HOME" &
;;
'restart')
        echo -n $"Shutting down Oracle DB: "
          su - $ORA_OWNER -c "/u01/app/oracle/bin/dbshutALL.ksh $ORACLE_HOME" &
        sleep 5
        echo -n $"Starting Oracle DB: "
        su - $ORA_OWNER -c "/u01/app/oracle/bin/dbstartALL.ksh $ORACLE_HOME" &
  ;;
*)
        echo "usage: $0 {start|stop|restart}"
        exit
 
   ;;
esac
 
# End of script dbora
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
OEM patching steps


OEM patching steps.

check the df -h
 
cd /oraexp/EMStage/Oct2025
uname -a
oem patchin only ------------------------------------only OEM SERVERS

[ushdc8510 oraoem OER]> . set_OMS
 
[ushdc8510 oraoem OER]> emctl status oms
 
emctl stop oms 
. set_AH
 
[ushdc8510 oraoem OER]> emctl status agent
emctl stop agent

dgmgrl /
show configuration;
cp -r OPatch $OH
opatch version
dbshutALL.ksh
cd 
cd bin 
ls -lrt
dbshutALL.ksh
apply two patched 
opatch lsinventory |grep applied
after patching 
startdbALLUpgrade.ksh 
in primary and cd /oraexp/EMStage 
 apply Patch_Script_Execute.ksh (db patch in primary onlyh )
for oem servers
 
. set_OMS
 frstt  start listener...
[ushdc8510 oraoem OER]> emctl status oms  
emctl start oms
. set_AH
 
[ushdc8510 oraoem OER]> emctl status agent
emctl start agent

---in prmart only
set pages 300 lines 300         
 
col action form a12
 
col version form a40
 
col description form a70
 
col action_date form a20
 
col ACTION_TIME for a38 
select PATCH_ID,ACTION,STATUS,ACTION_TIME,DESCRIPTION from dba_registry_sqlpatch order by ACTION_TIME;
select name,open_mode from v$database;
 

dgmgrl /
 
show configuration; to check the sync
======================================
For standby database
start listener

lsnrctl status 
lsnrctl start
. set_AH
emctl start agent 
emctl status agent

startup nomount;

alter database mount standby database;
=======================================================================

upgrade steps from 12 to 19c....

1.7	Upgrade the Database from 12.2 to 19.3 using Autoupgrade utility:

Upgrade the Database from 12.2 to 19.3 using Autoupgrade tool


Download a new autoupgrade tool from the MOS note 2485457.1 to location /u01/app/oracle/product/19.3.0/dbhome_1/rdbms/admin.

The utility required Java 8 to upgrade DB using autoupgrade tool.
$ORACLE_HOME/jdk/bin/java -version

 

To get the build date of Autoupgrade tool: $ORACLE_HOME/jdk/bin/java -jar /u01/app/oracle/product/19.3/db_1/rdbms/admin/autoupgrade.jar -version

 

The autoupgrade utility can be run in a number of different modes:

1. Analyze - Can be run during normal DB operation time. It is read only operation which will help us to know the issue which can occur during upgrade and can prevent from upgrade.

$ORACLE_HOME/jdk/bin/java -jar /u01/app/oracle/product/19.3/db_1/rdbms/admin/autoupgrade.jar -config /oraexp/Oracle_upgrade_19.3/config.txt -mode analyze 

2. Fixup - AutoUpgrade performs the same checks that it also performs in Analyze mode but after completing these pre-upgrade checks it then runs automated fixups of the source database in preparation for the database upgrade.

$ORACLE_HOME/jdk/bin/java -jar /u01/app/oracle/product/19.3/db_1/rdbms/admin/autoupgrade.jar -config /oraexp/Oracle_upgrade_19.3/config.txt -mode fixups 

3. Deploy - the autoupgrade utility performs the actual upgrade of the database as well as also performs a number of post-upgrade steps like recompile invalid objects and timezone DST upgrade among other things.

$ORACLE_HOME/jdk/bin/java -jar /u01/app/oracle/product/19.3/db_1/rdbms/admin/autoupgrade.jar -config /oraexp/Oracle_upgrade_19.3/config.txt -mode deploy -restore_on_fail 

4. Upgrade - To divide the upgrad, run the fixups first then run autoupgradetools in upgrade mode. Post upgrade doesn't take place in this mode.

$ORACLE_HOME/jdk/bin/java -jar /u01/app/oracle/product/19.3/db_1/rdbms/admin/autoupgrade.jar -config /oraexp/Oracle_upgrade_19.3/config.txt  -mode upgrade



Stages of DB Upgrade:
 Setup - setup the upgrade job with jobid
 Preupgrade - It will check system level setting such as disk space and all for DB upgrade
 Prechecks - it does DB level check for upgrade
 PREFIXUPS- fixes the prechecks errors/warnings. Such as gathering the statistics
 Drain - It clear the session. shut down the DB & listener.
 DBupgrade - Actual DB upgrade takes place & compile the invalid objects
 Postchecks - checks before starting postupgrade.
 postfixups - timezone is upgraded 
 Postupgrades - copy the network files and start the DB from new OH.


7.a) Create a configuration file:

[usadc8915 oradba APEXCL1]> vi /oraexp/Oracle_upgrade_19.3/config.txt
#
# Global logging directory pertains to all jobs
#
global.autoupg_log_dir=/oraexp/Oracle_upgrade_19.3/upgrade_log        # Top level logging directory (Required)[directory where the logs will be saved]

#
# Database 1
#
upg1.dbname=APEXCL1_NDC
upg1.source_home=/u01/app/oracle/product/12.2.0.1.1910/db_1
upg1.target_home=/u01/app/oracle/product/19.3/db_1
upg1.sid=APEXCL1
upg1.start_time=NOW
upg1.log_dir=/oraexp/Oracle_upgrade_19.3/upgrade_log/APEXCL1
upg1.upgrade_node=localhost
upg1.run_utlrp=yes
upg1.timezone_upg=yes
upg1.target_version=19

 

Parameters for config files:

1) Global - when we use global parameter it is applicable for all the databases.
2) Local- It is only applicable for particular DBs. Should be mentioned with some prefix. We can give any prefix just to identify

If local & global both paramter are set, then local will be considered as high priority.

With CONFIG file we can use below options:
1) -clear_recovery_data: Removes the recovery checkpoint to start fresh the next time AutoUpgrade is started. In particular, use this option to run AutoUpgrade so that it discards any previous generated state information.
2)-console: Enables the AutoUpgrade console, if disabled. The console is enabled by default. The console enables you to submit commands at a terminal to receive details in real time about the jobs that are running, so that you can modify their workflow. For example, from the console, you can abort a job, or restore a given database.
3) -noconsole: Disables the console. Use the noconsole mode for batch scripting, in which AutoUpgrade commands are run without interaction at the terminal.
4) -restore_on_fail: Enables the option to restore databases automatically in case of an upgrade failure. This option only applies when AutoUpgrade is run in deploy mode. In other modes, this option is ignored.
5) -debug: Enables debug level messages in both log files and in terminal output.
6) -.zip : Creates an archive (zip) file that contains all AutoUpgrade data and log files. We can't use -mode command with this and the zip file will be created at the present directory.


7.b) Analyzing the upgrade of the database:

$ORACLE_HOME/jdk/bin/java -jar /u01/app/oracle/product/19.3/db_1/rdbms/admin/autoupgrade.jar -config /oraexp/Oracle_upgrade_19.3/config.txt -mode analyze

When using console, we can run below commands:
1) help
2) exit
3) lsj [(-r|-f-p|-e)|-n number] -> To list the job details.
4) status jobno
5) resume -job number
6) clear
7) abort -job number
8) log - > to display log file location.
 

 

7.C) ENABLE FLASHBACK RECOVERY:

SQL> alter system set db_recovery_file_dest_size=20G scope=both;

System altered.

SQL> alter system set db_recovery_file_dest='/oraexp/fra' scope=both;

System altered.

SQL> show parameter db_flashback_retention;
NAME                                 TYPE        VALUE
------------------------------------ ----------- ------------------------------
db_flashback_retention_target        integer     1440

SQL> alter database flashback on;

Database altered.

 

7.d) Check the SCN number & current timestamp and note it down.

SQL> SQL>
SQL> select current_scn from v$database;

CURRENT_SCN
-----------
  129432124

SQL> select to_char(sysdate,'DD MM YYYY HH24:MI:SS') from dual;

TO_CHAR(SYSDATE,'DD
-------------------
03 04 2020 08:48:13

Note: Take RMAN L0 backup of the database and blackout  from OEM.


 


7.e)  Move listener from 12.2 OH to 19.3.

Open X-session on No-machine NX client by opening terminal.

Netca

Delete the old listener running from 12.2 Oracle Home.

Change /etc/oratab to point LISTENER_HOME to the 19C Home.

#LISTENER_HOME:/u01/app/oracle/product/19.3/db_1:N

          Source environment to set new LISTENER_HOME:
          cd
          . .profile

Run netca from on No-machine NX client

 

[usadc8915 oradba ORA193]> oe
-----------------------
Oracle Environment
-----------------------
ORACLE_SID=ORA193
ORACLE_HOME=/u01/app/oracle/product/19.3/db_1
AGENT_HOME=/u01/app/oracle/product/13.2.0/agent13c/agent_inst
LISTENER_HOME=/u01/app/oracle/product/12.2.0.1/db_1
TNS_ADMIN=/u01/app/oracle/product/12.2.0.1/db_1/network/admin
TSM_ADMIN=/usr/tivoli/tsm/client/oracle/bin64
NLS_LANG=AMERICAN_AMERICA.WE8ISO8859P1
OMS_HOME=
LIBPATH=/u01/app/oracle/product/19.3/db_1/lib
 

 




7.f) Run fixup command:

$ORACLE_HOME/jdk/bin/java -jar /u01/app/oracle/product/19.3/db_1/rdbms/admin/autoupgrade.jar -config /oraexp/Oracle_upgrade_19.3/config.txt -mode fixups

 

 

7.g) Run the Autoupgrade tool in Deploy mode with restore on fail option.


$ORACLE_HOME/jdk/bin/java -jar /u01/app/oracle/product/19.3/db_1/rdbms/admin/autoupgrade.jar -config /oraexp/Oracle_upgrade_19.3/config.txt -mode deploy -restore_on_fail

 

[usadc8915 oradba APEXCL1]> 1/rdbms/admin/autoupgrade.jar -config /oraexp/Oracle_upgrade_19.3/config.txt -mode deploy -restore_on_fail                    <
AutoUpgrade tool launched with default options
+--------------------------------+
| Starting AutoUpgrade execution |
+--------------------------------+
1 databases will be processed
Type 'help' to list console commands
upg> lsj
+----+-----------+---------+---------+-------+--------------+--------+--------+--------------+
|Job#|    DB_NAME|    STAGE|OPERATION| STATUS|    START_TIME|END_TIME| UPDATED|       MESSAGE|
+----+-----------+---------+---------+-------+--------------+--------+--------+--------------+
| 107|APEXCL1_NDC|PRECHECKS|PREPARING|RUNNING|20/04/03 09:18|     N/A|09:18:43|Remaining 1/71|
+----+-----------+---------+---------+-------+--------------+--------+--------+--------------+
Total jobs 1
upg> status
---------------- Config -------------------
User configuration file    [/oraexp/Oracle_upgrade_19.3/config.txt]
General logs location      [/oraexp/Oracle_upgrade_19.3/upgrade_log        # Top level logging directory (Required)[directory where the logs will be saved]/cfgtoollogs/upgrade/auto]
Mode                       [DEPLOY]
DB upg fatal errors        ORA-00600,ORA-07445
DB Post upgrade abort time [60] minutes
DB upg abort time          [1440] minutes
DB restore abort time      [120] minutes
DB GRP abort time          [3] minutes
------------------------ Jobs ------------------------
Total databases in configuration file [1]
Total Non-CDB being processed         [1]
Total CDB being processed             [0]
Jobs finished successfully            [0]
Jobs finished/aborted                 [0]
Jobs in progress                      [1]
Jobs stage summary
    Job ID: 107
    DB name: APEXCL1_NDC
        SETUP             <1 min
        PREUPGRADE        <1 min
        PRECHECKS         1 min (IN PROGRESS)
------------ Resources ----------------
Threads in use                        [78]
JVM used memory                       [27] MB
CPU in use                            [13%]
Processes in use                      [67]

upg> lsj
+----+-----------+---------+---------+-------+--------------+--------+--------+--------------+
|Job#|    DB_NAME|    STAGE|OPERATION| STATUS|    START_TIME|END_TIME| UPDATED|       MESSAGE|
+----+-----------+---------+---------+-------+--------------+--------+--------+--------------+
| 107|APEXCL1_NDC|PRECHECKS|PREPARING|RUNNING|20/04/03 09:18|     N/A|09:18:43|Remaining 1/71|
+----+-----------+---------+---------+-------+--------------+--------+--------+--------------+
Total jobs 1
upg> -------------------------------------------------
job 107 has not shown progress in last 10 minutes
database [APEXCL1_NDC]
Stage    [PRECHECKS]
Operation[PREPARING]
Status   [RUNNING]
Info     [Remaining 1/71]
[Review log files for further information]
-----------------------------------------------
Logs: /oraexp/Oracle_upgrade_19.3/upgrade_log/APEXCL1/APEXCL1/107
-----------------------------------------------
upg>
upg> lsj
+----+-----------+---------+---------+-------+--------------+--------+--------+---------------+
|Job#|    DB_NAME|    STAGE|OPERATION| STATUS|    START_TIME|END_TIME| UPDATED|        MESSAGE|
+----+-----------+---------+---------+-------+--------------+--------+--------+---------------+
| 107|APEXCL1_NDC|PREFIXUPS|EXECUTING|RUNNING|20/04/03 09:18|     N/A|09:32:25|Loading DB info|
+----+-----------+---------+---------+-------+--------------+--------+--------+---------------+
Total jobs 1
upg> -------------------------------------------------
job 107 has not shown progress in last 10 minutes
database [APEXCL1_NDC]
Stage    [PREFIXUPS]
Operation[EXECUTING]
Status   [RUNNING]
Info     [Loading DB info]
[Review log files for further information]
-----------------------------------------------
Logs: /oraexp/Oracle_upgrade_19.3/upgrade_log/APEXCL1/APEXCL1/107
-----------------------------------------------
upg> lsj
+----+-----------+---------+---------+-------+--------------+--------+--------+-------+
|Job#|    DB_NAME|    STAGE|OPERATION| STATUS|    START_TIME|END_TIME| UPDATED|MESSAGE|
+----+-----------+---------+---------+-------+--------------+--------+--------+-------+
| 107|APEXCL1_NDC|DBUPGRADE|EXECUTING|RUNNING|20/04/03 09:18|     N/A|09:44:51|Running|
+----+-----------+---------+---------+-------+--------------+--------+--------+-------+
Total jobs 1
upg> lsj
+----+-----------+---------+---------+-------+--------------+--------+--------+------------+
|Job#|    DB_NAME|    STAGE|OPERATION| STATUS|    START_TIME|END_TIME| UPDATED|     MESSAGE|
+----+-----------+---------+---------+-------+--------------+--------+--------+------------+
| 107|APEXCL1_NDC|DBUPGRADE|EXECUTING|RUNNING|20/04/03 09:18|     N/A|09:48:04|10%Upgraded |
+----+-----------+---------+---------+-------+--------------+--------+--------+------------+
Total jobs 1
upg> lsj
+----+-----------+---------+---------+-------+--------------+--------+--------+------------+
|Job#|    DB_NAME|    STAGE|OPERATION| STATUS|    START_TIME|END_TIME| UPDATED|     MESSAGE|
+----+-----------+---------+---------+-------+--------------+--------+--------+------------+
| 107|APEXCL1_NDC|DBUPGRADE|EXECUTING|RUNNING|20/04/03 09:18|     N/A|10:03:18|91%Upgraded |
+----+-----------+---------+---------+-------+--------------+--------+--------+------------+
Total jobs 1
upg> lsj
+----+-----------+---------+---------+-------+--------------+--------+--------+-----------+
|Job#|    DB_NAME|    STAGE|OPERATION| STATUS|    START_TIME|END_TIME| UPDATED|    MESSAGE|
+----+-----------+---------+---------+-------+--------------+--------+--------+-----------+
| 107|APEXCL1_NDC|DBUPGRADE|EXECUTING|RUNNING|20/04/03 09:18|     N/A|10:07:38|0%Compiled |
+----+-----------+---------+---------+-------+--------------+--------+--------+-----------+
Total jobs 1
upg> lsj
+----+-----------+----------+---------+-------+--------------+--------+--------+-------------+
|Job#|    DB_NAME|     STAGE|OPERATION| STATUS|    START_TIME|END_TIME| UPDATED|      MESSAGE|
+----+-----------+----------+---------+-------+--------------+--------+--------+-------------+
| 107|APEXCL1_NDC|POSTFIXUPS|EXECUTING|RUNNING|20/04/03 09:18|     N/A|10:12:59|Remaining 3/3|
+----+-----------+----------+---------+-------+--------------+--------+--------+-------------+
Total jobs 1
upg> Job 107 completed
------------------- Final Summary --------------------
Number of databases            [ 1 ]

Jobs finished successfully     [1]
Jobs failed                    [0]
Jobs pending                   [0]
------------- JOBS FINISHED SUCCESSFULLY -------------
Job 107 FOR APEXCL1_NDC

---- Drop GRP at your convenience once you consider it is no longer needed ----
Drop GRP from APEXCL1_NDC: drop restore point null

[usadc8915 oradba APEXCL1]>

 

  7.h) Check Oracle environment variables:

[usadc8915 oradba APEXCL1]> oe
-----------------------
Oracle Environment
-----------------------
ORACLE_SID=APEXCL1
ORACLE_HOME=/u01/app/oracle/product/19.3/db_1
AGENT_HOME=/u01/app/oracle/product/13.2.0/agent13c/agent_inst
LISTENER_HOME=/u01/app/oracle/product/12.2.0.1/db_1
TNS_ADMIN=/u01/app/oracle/product/12.2.0.1/db_1/network/admin
TSM_ADMIN=/usr/tivoli/tsm/client/oracle/bin64
NLS_LANG=AMERICAN_AMERICA.WE8ISO8859P1
OMS_HOME=
LIBPATH=/u01/app/oracle/product/19.3/db_1/lib
LD_LIBRARYPATH=/u01/app/oracle/product/19.3/db_1/lib
ALERT_LOG=/u01/app/oracle/diag/rdbms/apexcl1_ndc/APEXCL1/trace/alert_APEXCL1.log

Create a new Pfile 

SQL> create pfile from spfile;

7.i) Turn Off the flashback:

SQL> select GUARANTEE_FLASHBACK_DATABASE,NAME from v$restore_point;

GUA
---
NAME
--------------------------------------------------------------------------------
YES
AUTOUPGRADE_221145114461854_APEXCL1_NDC


SQL> select flashback_On from v$database;

FLASHBACK_ON
------------------
YES

SQL> alter database flashback off;

Database altered.

SQL> select flashback_On from v$database;

FLASHBACK_ON
------------------
RESTORE POINT ONLY

SQL> drop restore point  AUTOUPGRADE_221145114461854_APEXCL1_NDC;

Restore point dropped.

SQL> select flashback_On from v$database;

FLASHBACK_ON
------------------
NO


7.j) Change compatibility and optimizer_features_enable

SQL> alter system set compatible='19.0.0' scope=spfile;

System altered.

SQL> alter system set optimizer_features_enable='19.1.0â€™;

System altered.

SQL> shut immediate;
Database closed.
Database dismounted.
ORACLE instance shut down.
SQL> startup
ORACLE instance started.

Total System Global Area 4294921672 bytes
Fixed Size                  9063880 bytes
Variable Size            2298478592 bytes
Database Buffers         1979711488 bytes
Redo Buffers                7667712 bytes
Database mounted.
Database opened.
SQL>

SQL> show parameter compatible

NAME                                 TYPE        VALUE
------------------------------------ ----------- ------------------------------
compatible                           string      19.0.0
noncdb_compatible                    boolean     FALSE

SQL> show parameter optimizer_features_enable

NAME                                 TYPE        VALUE
------------------------------------ ----------- ------------------------------
optimizer_features_enable            string      19.1.0
SQL>

 


Note: Support document for compatible parameter - Doc ID 2610939.1 
         Support document for optimizer_feature_enable -      https://docs.oracle.com/en/database/oracle/oracle-database/19/refrn/OPTIMIZER_FEATURES_ENABLE.html#GUID-E193EC9E-B642-4C01-99EC-24E04AEA1A2C

1.8	Database Release Update patching

Download the latest RU patch and latest version Opatch. 

Stop the listener and shutdown the database.

In this case we are applying Jan 2020 RU patch : p30463595_190000_AIX64-5L.zip.

Copy the RU to /oraexp/EMStage of the server.

 unzip p30463595_190000_AIX64-5L.zip

 cd 30463595

[usadc8915 oradba TOOLSBCL]> cd 30463595
[usadc8915 oradba TOOLSBCL]> cd 30484981
[usadc8915 oradba TOOLSBCL]> pwd
/oraexp/EMStage/30463595/30484981
[usadc8915 oradba TOOLSBCL]> opatch apply

 

[usadc8915 oradba TOOLSBCL]> cd ..
[usadc8915 oradba TOOLSBCL]> ls
30484981         30557433         PatchSearch.xml  README.html
[usadc8915 oradba TOOLSBCL]> cd 30557433
[usadc8915 oradba TOOLSBCL]> opatch apply

 

[usadc8915 oradba TOOLSBCL]> opatch lsinventory

 

Start database in upgrade mode:

 

cd $ORACLE_HOME/OPatch
./datapatch -verbose

Execute utlrp.sql to compile the invalid objects.

 

Shutdown and Startup the database in normal mode.

Run below command in SQL prompt to verify if patch has been applied successfully to the database or not:

select action_time,action,status,description , patch_id from DBA_registry_sqlpatch order desc;     

Upgrade the catalog post applying the patch as release version is getting updated when we apply the RU Release update.

      RMAN> upgrade catalog;

      

1.9	Reference Materials
       9.1 Oracle help centre Document:

                     https://docs.oracle.com/en/database/oracle/oracle-database/19/refrn/index.html
       

Appendix A  	Revision & Approval History

Rev.
CMR #	Desc. of Change	Author	Approver	Approved Date
====================================================================================================================================================
dbupgrade steps 
Oracle DB 19c Upgrade Steps
Upgrading an Oracle Database to version 19c involves several steps. Here is a comprehensive guide to help you through the process:

Pre-Upgrade Steps

1. Check Compatibility:
    - Ensure your current database version is eligible for a direct upgrade to 19c. Oracle supports direct upgrades from 11.2.0.4, 12.1.0.2, 12.2.0.1, and 18c.

2. Backup Your Database:
    - Perform a full backup of your database to ensure you can restore it if anything goes wrong during the upgrade process.

3. Check for Deprecated and Desupported Features:
    - Review the Oracle 19c documentation for deprecated and desupported features to understand the impact on your applications.

4. Run the Pre-Upgrade Information Tool:
    - Download and run the `preupgrade.jar` tool to identify any issues that need to be addressed before upgrading.
```bash
java -jar preupgrade.jar TERMINAL TEXT
```

5. Resolve Any Issues:
    - Address any issues identified by the pre-upgrade tool. This may include updating initialization parameters, removing unsupported features, or upgrading components.

Upgrade Steps

1. Install Oracle 19c Software:
    - Download and install the Oracle 19c software on your server. Do not create a new database during the installation.

2. Prepare the New Oracle Home:
    - Set up the environment variables to point to the new Oracle 19c home.
```bash
export ORACLE_HOME=/path/to/new/oracle19c/home
export PATH=ORACLE_HOME/bin:PATH
```

3. Shutdown the Database:
    - Shutdown the current database instance.
```sql
SHUTDOWN IMMEDIATE;
```

4. Start the Database in Upgrade Mode:
    - Start the database in upgrade mode using the new Oracle 19c home.
```sql
STARTUP UPGRADE;
```

5. Run the Database Upgrade Utility:
    - Use the `dbupgrade` utility to upgrade the database.
```bash
$ORACLE_HOME/bin/dbupgrade
```

6. Compile Invalid Objects:
    - After the upgrade, compile any invalid objects.
```sql
@$ORACLE_HOME/rdbms/admin/utlrp.sql
```

7. Run Post-Upgrade Checks:
    - Run the `postupgrade_fixups.sql` script to address any post-upgrade issues.
```sql
@$ORACLE_HOME/rdbms/admin/postupgrade_fixups.sql
```

8. Update Configuration Files:
    - Update the listener.ora and tnsnames.ora files to reflect the new Oracle home.

Post-Upgrade Steps

1. Test the Database:
    - Thoroughly test your applications to ensure they work correctly with the upgraded database.

2. Backup the Upgraded Database:
    - Perform a full backup of the upgraded database.

3. Monitor Performance:
    - Monitor the database performance and make any necessary adjustments to initialization parameters.

Additional Considerations

    - Oracle Data Pump: Consider using Oracle Data Pump for exporting and importing data if a direct upgrade is not possible.
    - Oracle GoldenGate: For minimal downtime upgrades, Oracle GoldenGate can be used to replicate data to the new version while the old version is still running.

By following these steps, you can successfully upgrade your Oracle Database to version 19c.



Disclaimer: Output quality is your responsibility and top priority. You are responsible for ensuring the accuracy, completeness, and relevance of any output generated by Sidekick and how it is used. Similar to an internet search, responses from Sidekick may be inaccurate, dated, incomplete, or not aligned to your specific needs. You should thoroughly review all source materials and all outputs from Sidekick to confirm the response is accurate and edit as necessary before sharing them for any purpose.
===============================================================================================================
oem installation steps
Deloitte Services LP
Install 13cR4 OEM
How to Install Oracle Enterprise Manager Cloud 13cR4 (13.4.0.0) on Linux










About Deloitte
Deloitte refers to one or more of Deloitte Touche Tohmatsu, a Swiss Verein, its member firms and their respective subsidiaries and affiliates. As a Swiss Verein (association), neither Deloitte Touche Tohmatsu nor any of its member firms has any liability for each otherâ€™s acts or omissions. Each of the member firms is a separate and independent legal entity operating under the names â€œDeloitte,â€ â€œDeloitte & Touche,â€ â€œDeloitte Touche Tohmatsu,â€ or other related names. Services are provided by the member firms or their subsidiaries or affiliates and not by the Deloitte Touche Tohmatsu Verein.
Deloitte & Touche USA LLP is the U.S. member firm of Deloitte Touche Tohmatsu. In the U.S., services are provided by the subsidiaries of Deloitte & Touche USA LLP (Deloitte & Touche LLP, Deloitte Consulting LLP, Deloitte Financial Advisory Services LLP, Deloitte Tax LLP and their subsidiaries), and not by Deloitte & Touche USA LLP. [v.I.1]











Owned by: Toennies, Matthew	Authored/Revised by: Babita Kumari
Approved by:	Approval Date: 
Filename: ORA_Install_OEM_13cR4.docx
Revision #: Rev. 1

â€ƒ
Table of Contents

1	Overview	5
1.1	Purpose	5
1.2	Scope	5
2	Definitions/Acronyms	5
3	OMS Repository Database Prerequisites	6
3.1	Pre-Installation Oracle Assumptions	6
3.2	Pre-Installation Oracle Database Settings	6
4	OMS Prerequisites	7
4.1	Hardware Requirements and Sizing	7
4.2	Minimum Repository Database Settings	7
4.3	Minimum Requirements for Management Agents	8
4.4	OS Kernel and Library Requirements	8
4.4.1	OS Kernel Requirements	8
4.4.2	OMS Requirements	8
4.4.3	Management Agent Requirements	9
4.4.3.1	SLES 12	9
4.4.3.2	SLES 11	9
4.4.3.3	AIX 7.1	9
4.5	OS Users and Groups	9
5	Enterprise Manager System Installation	10
5.1	Installation Overview	10
5.2	Installation Prerequisites	11
5.3	Installation Steps	12
6	Adding Additional OMS Server	30
6.1	Requirements	30
6.2	Process	30
6.3	Installation	30
6.3.1	Installation Prerequisites	30
6.3.2	Installation Steps	30
6.3.3	Deploy the plug-ins on Additional OMS :	35
6.4	Post Installation steps for additional OMS	37
7	Post-Installation Steps	43
7.1	Firewall Rules	45
7.2	Create Administrator Accounts	45
7.2.1	DBA_ADMIN Account	45
7.2.2	Configuration to Send a Page/eMail	45
7.3	Deactivate AutoStart via rc.d	46
7.4	Configure Email Notification Method	47
7.5	Bundle Patch Check	48
7.6	Oracle Enterprise Manager 13c Configuration Best Practices	49
7.6.1	OMS Recommendations	49
7.6.1.1	Increase JAVA Heap Size	49
7.6.2	Repository Recommendations	49
7.6.2.1	Repvfy execute optimize, Increase Task Workers & Increase Ping Grace Period	50
7.6.2.2	Maintain Audit Data	52
7.6.3	WebLogic Server Recommendations	53
7.6.3.1	Stuck Thread Max Time	53
7.6.4	Configuration Recommendations	54
7.6.4.1	Configure E-Mail Notifications for EM related Alerts	54
7.6.4.2	Configure Out-of-Bound Notifications for EM Agent	57
7.6.4.3	Configure Always On Monitoring for Critical Target Notification	57
7.7	OMS Weblogic Tuning	57
7.7.1	Stuck Thread Max Time Change	57
7.7.2	HTTP Tunneling Changes	60
8	OEM 13c Sizing Changes	62
8.1	OMS Settings	62
8.2	Database Settings	62
9	Console HTTPS Certificate Management	63
10	Adding Targets to OMS	80
11	Installing Oracle Management Agent	81
11.1	Agent Essentials	81
11.2	Secure Agent traffic to OMS	82
11.3	Updating My Oracle Support preferred credentials	82
11.4	OMS Self-Update	83
11.5	Monitoring Templates	85
11.6	Administration Groups and Template Collections	88
11.6.1	Hierarchy (Administration Groups)	88
11.6.2	Create Named Credentials	93
11.6.3	Create OEM Roles	93
11.6.4	Create additional Groups	100
11.6.4.1	DTK_APP_DBA_GROUP	100
11.6.4.2	GES_CT_APP_DBA_GROUP	103
11.6.5	Template Collections	104
11.7	Assign Template Collections to Groups	106
11.8	Create OEM Users	110
11.8.1	DBA User Accounts	110
11.9	Setting up Incident Rules	111
11.10	Agent Deinstallation from old OEM	111
11.11	Agent Installation from new OEM	113
11.11.1	Windows	116
11.11.2	AIX	116
11.12	Agent Directory Structure after Installation	117
Appendix A	System Reference Data	118
Appendix B	OEM Process Control	119
Appendix C	OEM 13c Support Links	120
Appendix D	OEM Directory Structure	120
11.13	Grid Control Agent Consumes High Virtual / Resident Memory and may Restart Frequently (Doc ID 1194748.1)	124
Appendix E	Firewall Port Data	124
Appendix F	De-install 13c OEM	125
Deconfigure and Deinstall OMS	125
Stop Agent and Listener	126
Shutdown and Delete OMR Database	126
Uninstall WebLogic Server	127
Remove Contents of Middleware Directory	129
Remove entries from /etc/rc.d	132
Appendix G	Revision & Approval History	133
12	References	133

 
Overview
Purpose
The purpose of this document is to describe how to install 13cR4 OEM GRID software on Linux.   
Scope
This document is intended for experienced Oracle Database Administrators with a working knowledge of UNIX and/or Linux administrative commands. 
This document applies to 13cR4 OMS installation for SLES12SP2 Linux platforms.  The 13c OMS needs to have the BP1 (Bundle Patch 1) installed â€“ this is done via downloading an installation package from Oracle Support that contains the BP1 package.
Definitions/Acronyms
Term	Definition
<SID>	Reference in this document to the database ORACLE_SID of the database.

Please refer to the DDL Glossary of Terms in the IDR for terms and acronyms associated with this document.

 
OMS Repository Database Prerequisites
1.1	Pre-Installation Oracle Assumptions
â€¢	Oracle 19.0 is certified for 13cR4 OEM per Certifications Tab in MetaLink.
 
â€¢	All relevant PSU and CPU released for 19.0 are applied to the repository database.
â€¢	TDP for Oracle is installed and RMAN configured for database
1.2	Pre-Installation Oracle Database Settings
A generic Oracle 19.0 database has been installed on the server.  This database will hold the OMS repository.  The database instance resides on the same server as the OMS installation.  Please follow steps in â€œUsing DBCAâ€ documentation in IDR to create the database.  The necessary information for the target repository database is:
â€¢	User=oraoem
â€¢	Group=oinstall
â€¢	SID=OQR
â€¢	HOSTNAME=USHDC85038.US.DELOITTE.COM
â€¢	PORT=1521
â€¢	SYS & SYSTEM UserID/Password
â€¢	ORACLE_HOME=/u01/app/oracle/product/19.0/db_1
â€¢	ORACLE_BASE=/u01/app/oracle
â€¢	Oracle AMM (Automatic Memory Management) can be enabled.  Make sure the following is set: 
o	MEMORY_TARGET=10G
o	MEMORY_MAX_TARGET=15G
o	SHARED_POOL_SIZE=2G
o	PROCESSES=700
o	SESSION_CACHED_CURSORS=250
o	alter system set "_optimizer_nlj_hj_adaptive_join"= FALSE scope=both sid='*';
o	alter system set "_optimizer_strans_adaptive_pruning" = FALSE scope=both sid='*';
o	alter system set "_px_adaptive_dist_method" = OFF scope=both sid='*';
o	alter system set "_sql_plan_directive_mgmt_control" = 0 scope=both sid='*';
o	alter system set "_optimizer_dsdir_usage_control" = 0 scope=both sid='*';
o	alter system set "_optimizer_use_feedback" = FALSE scope=both sid='*';
o	alter system set "_optimizer_gather_feedback" = FALSE scope=both sid='*';
o	alter system set "_optimizer_performance_feedback" = OFF scope=both sid='*';
o	alter system set "_allow_insert_with_update_check"=true scope=both;

â€¢	Make sure the following parameters are removed:
o	SGA_TARGET
o	PGA_AGGREGATE_TARGET
â€¢	Make sure the online redo logs are 600MB in size and the filesystem has enough space to accommodate the online redo logs.  

â€¢	The database must have partitioning option installed.  This can be accomplished via â€˜choptâ€™ command.  Make sure all executable processes running off of the ORACLE_HOME are shutdown.  Issue the command:
chopt enable partitioning

2	OMS Prerequisites
2.1	Hardware Requirements and Sizing
From â€œEnterprise Manager 13c Cloud Control Sizing Guidelinesâ€ document, determine if GRID is SMALL, MEDIUM, or LARGE installation.  Based on agent count, target count, and concurrent user sessions, the installation at Deloitte is MEDIUM.  A MEDIUM installation is for greater than 1,000 targets but less than 10,000 and greater than 100 agents but less than 1,000.  This means server requires at least 6 core CPUâ€™s per OMS host, 28 GB of hard disk space, 12 GB RAM, 14 GB Temporary Directory Hard Disk Space and 4 GB Oracle WebLogic Server JVM Heap Size.  
2.2	Minimum Repository Database Settings
The following database settings are necessary for MEDIUM installation:
â€¢	MEMORY_TARGET=10G
â€¢	MEMORY_MAX_TARGET=15G
â€¢	SHARED_POOL_SIZE=2G
â€¢	PROCESSES=700
â€¢	SESSION_CACHED_CURSORS=250
â€¢	Redo log file size = 600 MB
â€¢	At least 20 GB of RAM on server
â€¢	455 GB of hard disk space (SYSTEM: 600 MB, MGMT_TABLESPACE: 300 GB, MGMT_ECM_DEPOT_TS: 4 GB, MGMT_AD4J_TS: 30 GB, TEMP 20 GB, ARCHIVE LOG AREA: 100 GB)
â€¢	Ensure that you apply the latest PSU on the supported database  
2.3	Minimum Requirements for Management Agents
An installed management agent requires a minimum of 2 CPU per host, 512 MB of RAM, and 1.5 GB of disk space.
2.4	OS Kernel and Library Requirements
2.4.1	OS Kernel Requirements
Make sure the following parameters are set in /etc/sysctl.conf file for kernel settings.  
â€¢	kernel.shmmax = 4294967295
â€¢	kernel.randomize_va_space = 0 (per Oracle Note 1345364.1)
The settings should take effect once the following command is issued:
sysctl â€“p
  
2.4.2	OMS Requirements
For SLES 12, following packages are required:
â€¢	binutils-2.24-2.165
â€¢	gcc-4.8-6.189
â€¢	gcc-c++-4.8-6.189
â€¢	glibc-2.19-17.72
â€¢	glibc-devel-2.19-17.72
â€¢	mksh-50-2.13
â€¢	libaio1-0.3.109-17.15
â€¢	libaio-devel-0.3.109-17.15
â€¢	libcap2-2.22-11.709
â€¢	libstdc++6-4.8.3+r212056-6.3
â€¢	libstdc++48-devel-4.8.3+r212056-6.3
â€¢	libstdc++48-devel-32bit-4.8.3+r212056-6.3
â€¢	libstdc++6-32bit-4.8.3+r212056-6.3
â€¢	libgcc_s1-4.8.3+r212056-6.3
â€¢	libgcc_s1-32bit-4.8.3+r212056-6.3
â€¢	make-4.0-2.107
â€¢	xorg-x11-libs-7.6-45.14
â€¢	motif-2.3.4-4.15.x86_64
â€¢	OpenSSL 1.0.1e

For SLES 15, the following packages are required(only 13.4.0.4 is supported):
â€¢	gcc-c++-7-1.563.x86_64
â€¢	gcc-c++-32bit-7-1.563.x86_64
â€¢	 binutils-2.29.1-4.46.x86_64
â€¢	gcc-ada-7-1.563.x86_64
â€¢	gcc-info-7-1.563.x86_64
â€¢	gcc-7-1.563.x86_64
â€¢	gcc7-c++-7.3.1+r258812-2.15.x86_64
â€¢	gcc7-info-7.3.1+r258812-2.15.noarch
â€¢	gcc7-7.3.1+r258812-2.15.x86_64
â€¢	gcc7-c++-32bit-7.3.1+r258812-2.15.x86_64
â€¢	gcc7-32bit-7.3.1+r258812-2.15.x86_64
â€¢	gcc-32bit-7-1.563.x86_64
â€¢	glibc-2.26-11.8.x86_64
â€¢	linux-glibc-devel-4.15-1.47.noarch
â€¢	glibc-devel-2.26-11.8.x86_64
â€¢	glibc-locale-2.26-11.8.x86_64
â€¢	glibc-extra-2.26-11.8.x86_64
â€¢	glibc-32bit-2.26-11.8.x86_64
â€¢	glibc-devel-32bit-2.26-11.8.x86_64
â€¢	mksh-56c-1.10.x86_64
â€¢	libaio1-0.3.109-1.25.x86_64
â€¢	libaio1-32bit-0.3.109-1.25.x86_64
â€¢	libaio-devel-32bit-0.3.109-1.25.x86_64
â€¢	libaio-devel-0.3.109-1.25.x86_64
â€¢	libcap2-2.25-2.41.x86_64
â€¢	libcap-ng0-0.7.9-1.42.x86_64
â€¢	libcap2-32bit-2.25-2.41.x86_64
â€¢	libstdc++6-7.3.1+r258812-2.15.x86_64
â€¢	libstdc++6-devel-gcc7-7.3.1+r258812-2.15.x86_64
â€¢	libstdc++6-32bit-7.3.1+r258812-2.15.x86_64
â€¢	libstdc++6-devel-gcc7-32bit-7.3.1+r258812-2.15.x86_64
â€¢	libstdc++6-locale-7.3.1+r258812-2.15.x86_64
â€¢	libstdc++-devel-7-1.563.x86_64
â€¢	libgcc_s1-7.3.1+r258812-2.15.x86_64
â€¢	libgcc_s1-32bit-7.3.1+r258812-2.15.x86_64
â€¢	make-4.2.1-5.48.x86_64
â€¢	make-lang-4.2.1-5.48.noarch
â€¢	makedumpfile-1.6.3-5.6.x86_64
â€¢	xorg-x11-7.6_1-1.22.noarch
â€¢	xorg-x11-server-1.19.6-6.19.x86_64
â€¢	xorg-x11-fonts-7.6-3.9.noarch
â€¢	xorg-x11-driver-video-7.6_1-2.30.x86_64
â€¢	xorg-x11-Xvnc-1.8.0-11.23.x86_64
â€¢	xorg-x11-fonts-core-7.6-3.9.noarch
â€¢	xorg-x11-server-extra-1.19.6-6.19.x86_64
â€¢	xorg-x11-essentials-7.6_1-1.22.noarch
2.4.3	 Management Agent Requirements
The following packages are required for the stated OS below:
2.4.3.1	SLES 12
â€¢	make-4.0
â€¢	binutils-2.24
â€¢	gcc48-c++-4.8.3
â€¢	gcc48-4.8.3
â€¢	gcc48-32bit-4.8.3
â€¢	gcc-4.8
â€¢	libstdc++48-devel-4.8.3
â€¢	libstdc++48-devel-32bit
2.4.3.2	SLES 15
â€¢	make-4.0
â€¢	binutils-2.20
â€¢	gcc-4.8
â€¢	libstdc++-4.4.7
â€¢	libstdc++-devel-4.4.7
2.4.3.3	AIX 7.2
â€¢	bos.adt.base 7.2.0.0
â€¢	bos.adt.lib 7.2.0.0
â€¢	bos.adt.libm 7.2.0.0
â€¢	bos.perf.libperfstat 7.2.0.0
â€¢	bos.perf.perfstat 7.2.0.0
â€¢	bos.perf.proctools 7.2.0.0
â€¢	rsct.basic.rte 3.2.1.0
â€¢	rsct.compat.clients.rte 3.2.1.0
â€¢	xlC.aix61.rte 13.1.2.0
â€¢	xlC.rte 13.1.2.0
2.4.3.4	AIX 7.1
â€¢	bos.adt.base(0.0)
â€¢	bos.adt.lib(0.0)
â€¢	bos.adt.libm(0.0)
â€¢	bos.perf.libperfstat(0.0)
â€¢	bos.perf.perfstat(0.0)
â€¢	bos.perf.proctools(0.0)
â€¢	rsct.basic.rte(0.0)
â€¢	rsct.compat.clients.rte(0.0)
â€¢	xlC.aix61.rte.(10.1.0.0)
â€¢	xlC.rte.(10.1.0.0)

For Linux servers, make sure kernel.shmmax parameter is set to 4294967295.
2.5	OS Users and Groups
Since the database is installed first, the 13c GRID installation will utilize the user and groups of the database installation.  
â€¢	Group = oinstall
â€¢	User = oraoem
For the installer, verify that the Oracle Inventory is properly set up via the following command:
more /etc/oraInst.loc

The result should be:
inventory_loc=/u01/app/oraInventory
inst_group=oinstall
3	Enterprise Manager System Installation
3.1	Installation Overview
As part of a new Enterprise Manager system, the installation wizard does the following:
â€¢	Installs Oracle WebLogic Server 12c Release 2 (12.2.1.3.0).
â€¢	Installs Java Development Kit (JDK) 1.8.0_231.
â€¢	Installs Oracle Management Service 13c Release 4.
â€¢	Installs Oracle Management Agent 13c Release 4 in the agent base directory you specify (outside the middleware home).
â€¢	Installs Oracle JRF 12c Release 2 (12.2.1.3.0).
â€¢	Installs Oracle Web Tier 12c Release 2 (12.2.1.3.0).
â€¢	Installs Oracle BI Publisher 12c Release 2 (12.2.1.3.0).
â€¢	Creates a plug-in directory and installs the following default plug-ins.
o	Oracle Database Plug-in
o	Oracle Fusion Middleware Plug-in 
o	Oracle Exadata Plug-in
o	Oracle Cloud Framework Plug-in
o	Oracle System Infrastructure Plug-in
Creates an Oracle WebLogic domain called GCDomain. For this WebLogic Domain, a default user account, weblogic, is used as the administrative user. In advanced installation, you can choose to change this if you want.
Creates a Node Manager user account called nodemanager. A Node Manager enables you to start, shut down, or restart an Oracle WebLogic Server instance remotely, and is recommended for applications with high availability requirements.
Configures an Oracle Management Service Instance Base location (gc_inst) outside the Oracle Middleware home (Middleware home), for storing all configuration details related to the OMS. In advanced installation, you can choose to change this location if you want.
For example, if the Middleware home is /u01/software/em13c/oraclehome, then the instance base location is /u01/software/em13c/gc_inst. You can choose to change this, if you want, in the installer. However, you can change it for only advanced installation and not for simple installation.

Configures Oracle Management Repository in the existing, certified Oracle Database. If the database instance is created using the database template offered by Oracle, then this step is skipped.
â€¢	Runs the following configuration assistants to configure the installed components for simple as well as advanced installation:
o	Plugins Prerequisites Check
o	Repository Configuration
o	BI Publisher Schema Configuration
o	OMS Configuration
o	Plugins Deployment and Configuration
o	BI Publisher Configuration
o	Start Oracle Management Service
o	Agent Configuration Assistant
3.2	Installation Prerequisites
â€¢	Make sure latest software is downloaded 
â€¢	ORACLE_HOME, ORACLE_SID, CLASSPATH, LD_LIBRARY_PATH and PATH need to be unset prior to install.
â€¢	Set DISPLAY variable for installer.
â€¢	An Oracle Database must be installed and operational to configure the Management Repository.
â€¢	The server must have unique hostname on network and use static IP address.  
â€¢	/tmp must have at least 14G of disk space.
â€¢	The /u01/app/oraInventory filesystem must have at least 100 MB of free disk.
â€¢	The umask must be 022 and set in .bash_profile.
â€¢	Ensure that the max user processes parameter and the open files parameter are set to 30000.
â€¢	Verify file descriptors is set to minimum of 65536 via the etc/security/limits.conf file.  
@oinstall             soft    nproc   30000
@oinstall             hard    nproc   30000
@oinstall             soft    nofile  65536
@oinstall             hard    nofile  65536
@oinstall             soft    stack   10240
@oinstall             hard    stack   32768

â€¢	The installation must NOT be done by root user.  
3.3	Installation Steps
1	Mount /orainstall NAS mount point to server.
2	cd to /orainstall/oracle/SLES12/13cR4_OEM
3	SCP the ZIP files to /oraexp on OEM server.
4	Unzip the files.
5	Log in as the â€˜oraoemâ€™ user.  
6	Make sure ORACLE_HOME and ORACLE_SID are unset.  
7	Unset DB HOME paths from PATH value by exporting below paths
EXPORT PATH=:/u01/app/oracle/scripts/maint:/u01/app/oracle/bin:/bin:/usr/bin:/usr/sbin/:/usr/ccs/bin:/usr/bin/X11:/usr/lbin:/usr/local/bin:/etc:/sbin:/u01/app/oracle/bin:/usr/local/bin:/usr/bin:/bin:/usr/bin/X11:/usr/games:/usr/lib/mit/bin:/opt/puppetlabs/bin:.
8	Make sure DISPLAY variable is set for Xwindows.
9	Unset CLASSPATH, LD_LIBRARY_PATH
EXPORT CLASSPATH=
       EXPORT LD_LIBRARY_PATH=
10	Change to /oraexp/13.4_SW and change the permission of all files to 755.
11	No need unzip the software files.
12	Execute em13400_linux64.bin.
13	Skip â€œMy Oracle Support Detailsâ€

14	Choose â€œYesâ€ for confirmation.
15	Skip the software updates.


 

16	Click â€œNextâ€
17	Make sure that all the required prerequisites are passed.


 

18	Choose â€œAdvancedâ€ under â€œCreate a New Enterprise Manager Systemâ€ and click â€œNextâ€

 

19	Enter the Middleware & Agent base directory locations.


       

20	I did not select any extra plugins, continued with the default ones. Oracle Cloud Framework, Oracle Database, Oracle Exadata, Oracle Fusion Middleware & Systems Infrastructure plugins will be installed automatically.

 


21	Enter â€˜oem13cbeâ€™ for password for weblogic and nodemanager users.  Also make sure the OMS Instance base location is: /u01/app/oracle/gc_inst.

 

22	Enter the FQDN for database server (same as OMS server) along with port and SID.  The SYS password is also required.

Choose the Deployment Size â€œMEDIUMâ€.

       

23	Oracleâ€™s recommendation is to use Universal (Unicode) character set for Repository database. 
 

24	Choose â€œYesâ€ to have installer change database to disable stats gathering job, parallel max servers to a lower value and to set parallel min servers to 0. 

        

 



25	Enter SYSMAN password and Registration password as â€œoem13cbeâ€.  Also change tablespace datafile locations from /u02 to /u03.  
NOTE: The Registration password is for registering new management agents.

 


26	Enter the location of OEM software library and shared location of BI Publisher. Click â€œEnable Oracle BI Publisherâ€.

 

27	Keep default port numbers and document them.  
NOTE: if any ports show up as â€œ-1â€, then the installer is unable to bind the port.  The installer must be exited and OS admin needs to verify hostname and IP configuration.
	
	 
28	Verify and document the Review information.  If satisfactory, choose â€œInstallâ€
OMS HOME = /u01/app/oracle/Middleware
AGENT HOME = /u01/app/oracle/product/13.4.0/agent13c/agent_13.4.0.0.0




 

 

29	Monitor the installation.


 


30	The log files during installation are located in /u01/app/oracle/Middleware/ cfgtoollogs
31	The respository configuration will take a while to complete. 
 
  







       
32	Need to run /u01/app/oracle/Middleware/allroot.sh script as root.  
    
     
The allroot.sh script does the following:
ushdc85038:~ # cd /u01/app/oracle/Middleware/
ushdc85038:/u01/app/oracle/Middleware # ./allroot.sh

Starting to execute allroot.sh .........

Starting to execute /u01/app/oracle/Middleware/root.sh ......
/etc exist

Creating /etc/oragchomelist file...
/u01/app/oracle/Middleware
Finished product-specific root actions.
/etc exist
Finished execution of  /u01/app/oracle/Middleware/root.sh ......


Starting to execute /u01/app/oracle/product/13.4.0/agent13c/agent_13.4.0.0.0/root.sh ......
Finished product-specific root actions.
/etc exist
Finished execution of  /u01/app/oracle/product/13.4.0/agent13c/agent_13.4.0.0.0/root.sh ......

33	The installation is complete.  The Finish screen needs to be documented for the additional OMS install.  
 
 

34	Make note of the URL to access the console as well as the Admin Server.  See Appendix A.
35	Verify status of OMS and agent processes via respective HOMES:

[ushdc85038 oraoem OQR]> cd /u01/app/oracle/Middleware/bin
[ushdc85038 oraoem OQR]> ./emctl status oms
Oracle Enterprise Manager Cloud Control 13c Release 4
Copyright (c) 1996, 2020 Oracle Corporation.  All rights reserved.
WebTier is Up
Oracle Management Server is Up
JVMD Engine is Up
BI Publisher Server is Up
[ushdc85038 oraoem OQR]>


[ushdc85038 oraoem OQR]> emctl status agent
Oracle Enterprise Manager Cloud Control 13c Release 4
Copyright (c) 1996, 2020 Oracle Corporation.  All rights reserved.
---------------------------------------------------------------
Agent Version          : 13.4.0.0.0
OMS Version            : 13.4.0.0.0
Protocol Version       : 12.1.0.1.0
Agent Home             : /u01/app/oracle/product/13.4.0/agent13c/agent_inst
Agent Log Directory    : /u01/app/oracle/product/13.4.0/agent13c/agent_inst/sysman/log
Agent Binaries         : /u01/app/oracle/product/13.4.0/agent13c/agent_13.4.0.0.0
Core JAR Location      :/u01/app/oracle/product/13.4.0/agent13c/agent_13.4.0.0.0/jlib
Agent Process ID       : 46943
Parent Process ID      : 46766
Agent URL              : https://ushdc85038.us.deloitte.com:3872/emd/main/
Local Agent URL in NAT : https://ushdc85038.us.deloitte.com:3872/emd/main/
Repository URL         : https://ushdc85038.us.deloitte.com:4903/empbs/upload
Started at             : 2020-10-08 06:29:22
Started by user        : oraoem
Operating System       : Linux version 4.12.14-95.54-default (amd64)
Number of Targets      : 60
Last Reload            : (none)
Last successful upload                       : 2020-10-13 15:29:24
Last attempted upload                        : 2020-10-13 15:29:24
Total Megabytes of XML files uploaded so far : 16.75
Number of XML files pending upload           : 0
Size of XML files pending upload(MB)         : 0
Available disk space on upload filesystem    : 36.96%
Collection Status                            : Collections enabled
Heartbeat Status                             : Ok
Last attempted heartbeat to OMS              : 2020-10-13 15:29:41
Last successful heartbeat to OMS             : 2020-10-13 15:29:41
Next scheduled heartbeat to OMS              : 2020-10-13 15:30:41

---------------------------------------------------------------
Agent is Running and Ready

36	Make sure there are no errors installing plug-ins via /u01/app/oracle/Middleware/cfgtoollogs/cfgfw directory.  
Look for CfmLogger file and grep for â€œPluginâ€.  
[ushdc85038 oraoem OQR]> grep plugin CfmLogger_2020-09-28_03-26-03-AM.log
INFO: oracle.sysman.top.oms:COMMAND: /u01/app/oracle/Middleware/bin/pluginca  -oracleHome /u01/app/oracle/Middleware -middlewareHome /u01/app/oracle/Middleware -action prereqCheck  -plugins oracle.sysman.cfw=13.4.1.0.0,oracle.sysman.db=13.4.1.0.0,oracle.sysman.xa=13.4.1.0.0,oracle.sysman.emas=13.4.1.0.0,oracle.sysman.si=13.4.1.0.0,
INFO: oracle.sysman.top.oms:pluginca - Plugin Configuration Tool
INFO: oracle.sysman.top.oms:Log file: /u01/app/oracle/Middleware/cfgtoollogs/pluginca/gcinstall/configplugin_prereq_check_2020-09-28_03-26-05.log
INFO: oracle.sysman.top.oms:Trace file: /u01/app/oracle/Middleware/cfgtoollogs/pluginca/gcinstall/configplugin_prereq_check_2020-09-28_03-26-05.trc
INFO: oracle.sysman.top.oms:Options passed: -loglevel debug -oraclehome /u01/app/oracle/Middleware -middlewarehome /u01/app/oracle/Middleware -action prereqcheck -plugins oracle.sysman.cfw=13.4.1.0.0,oracle.sysman.db=13.4.1.0.0,oracle.sysman.xa=13.4.1.0.0,oracle.sysman.emas=13.4.1.0.0,oracle.sysman.si=13.4.1.0.0,
INFO: oracle.sysman.top.oms:Checking mandatory patches for plugin : oracle.sysman.si:13.4.1.0.0:0
INFO: oracle.sysman.top.oms:Checking mandatory patches for plugin : oracle.sysman.db:13.4.1.0.0:0
INFO: oracle.sysman.top.oms:Checking mandatory patches for plugin : oracle.sysman.xa:13.4.1.0.0:0
INFO: oracle.sysman.top.oms:Checking mandatory patches for plugin : oracle.sysman.cfw:13.4.1.0.0:0
INFO: oracle.sysman.top.oms:Checking mandatory patches for plugin : oracle.sysman.emas:13.4.1.0.0:0
INFO: oracle.sysman.top.oms:Registering plugin SQLs. Reg file is /u01/app/oracle/Middleware/sysman/admin/emdrep/plugininfo/pluginDepList
INFO: oracle.sysman.top.oms:Registering plugin DLFs. Reg file is /u01/app/oracle/Middleware/sysman/admin/emdrep/plugininfo/dlfSources
INFO: oracle.sysman.top.oms:pluginID:oracle.sysman.core
INFO: oracle.sysman.top.oms:pluginID:oracle.sysman.core
INFO: oracle.sysman.top.oms:pluginID:oracle.sysman.core
INFO: oracle.sysman.top.oms:pluginID:oracle.sysman.core
INFO: oracle.sysman.top.oms:COMMAND: /u01/app/oracle/Middleware/bin/pluginca  -oracleHome /u01/app/oracle/Middleware -middlewareHome /u01/app/oracle/Middleware -action  deploy  -plugins oracle.sysman.cfw=13.4.1.0.0,oracle.sysman.db=13.4.1.0.0,oracle.sysman.xa=13.4.1.0.0,oracle.sysman.emas=13.4.1.0.0,oracle.sysman.si=13.4.1.0.0,
INFO: oracle.sysman.top.oms:pluginca - Plugin Configuration Tool
INFO: oracle.sysman.top.oms:Log file: /u01/app/oracle/Middleware/cfgtoollogs/pluginca/gcinstall_2020-09-28_04-29-57/configplugin_deploy_2020-09-28_04-29-57.log
INFO: oracle.sysman.top.oms:Trace file: /u01/app/oracle/Middleware/cfgtoollogs/pluginca/gcinstall_2020-09-28_04-29-57/configplugin_deploy_2020-09-28_04-29-57.trc
INFO: oracle.sysman.top.oms:Options passed: -loglevel debug -oraclehome /u01/app/oracle/Middleware -middlewarehome /u01/app/oracle/Middleware -action deploy -plugins oracle.sysman.cfw=13.4.1.0.0,oracle.sysman.db=13.4.1.0.0,oracle.sysman.xa=13.4.1.0.0,oracle.sysman.emas=13.4.1.0.0,oracle.sysman.si=13.4.1.0.0,
INFO: oracle.sysman.top.oms:Checking file /u01/app/oracle/Middleware/sysman/install/undeployed_pluginswith name 13.1.1.0.0_oracle.em.smis_2000_0.opar
INFO: oracle.sysman.top.oms:Checking file /u01/app/oracle/Middleware/sysman/install/undeployed_pluginswith name 13.4.1.0.0_oracle.sysman.vi_2000_0.opar
INFO: oracle.sysman.top.oms:Checking file /u01/app/oracle/Middleware/sysman/install/undeployed_pluginswith name 13.4.1.0.0_oracle.sysman.emct_2000_0.opar
INFO: oracle.sysman.top.oms:Checking file /u01/app/oracle/Middleware/sysman/install/undeployed_pluginswith name 13.4.1.0.0_oracle.em.savf_2000_0.opar
INFO: oracle.sysman.top.oms:Checking file /u01/app/oracle/Middleware/sysman/install/undeployed_pluginswith name 13.4.1.0.0_oracle.sysman.am_2000_0.opar
INFO: oracle.sysman.top.oms:Checking file /u01/app/oracle/Middleware/sysman/install/undeployed_pluginswith name 13.4.1.0.0_oracle.sysman.ssa_2000_0.opar
INFO: oracle.sysman.top.oms:Checking file /u01/app/oracle/Middleware/sysman/install/undeployed_pluginswith name 13.2.1.0.0_oracle.em.satc_2000_0.opar
INFO: oracle.sysman.top.oms:Checking file /u01/app/oracle/Middleware/sysman/install/undeployed_pluginswith name 13.4.1.0.0_oracle.sysman.empa_2000_0.opar
INFO: oracle.sysman.top.oms:Checking file /u01/app/oracle/Middleware/sysman/install/undeployed_pluginswith name 13.4.1.0.0_oracle.sysman.vt_2000_0.opar
INFO: oracle.sysman.top.oms:Checking file /u01/app/oracle/Middleware/sysman/install/undeployed_pluginswith name 13.4.1.0.0_oracle.sysman.emfa_2000_0.opar
INFO: oracle.sysman.top.oms:Checking file /u01/app/oracle/Middleware/sysman/install/undeployed_pluginswith name 13.4.1.0.0_oracle.sysman.csm_2000_0.opar
INFO: oracle.sysman.top.oms:Checking file /u01/app/oracle/Middleware/sysman/install/undeployed_pluginswith name 13.4.1.0.0_oracle.sysman.smf_2000_0.opar
INFO: oracle.sysman.top.oms:Checking file /u01/app/oracle/Middleware/sysman/install/undeployed_pluginswith name 13.4.1.0.0_oracle.sysman.bda_2000_0.opar
INFO: oracle.sysman.top.oms:Checking file /u01/app/oracle/Middleware/sysman/install/undeployed_pluginswith name 13.4.1.0.0_oracle.sysman.orhc_2000_0.opar
INFO: oracle.sysman.top.oms:Checking file /u01/app/oracle/Middleware/sysman/install/undeployed_pluginswith name 13.1.1.0.0_oracle.em.smad_2000_0.opar
[ushdc85038 oraoem OQR]> 

37	Note the message on the screen.  This step needs to be performed.  The backup will be put on another system (Task to be performed later on) and via TSM.  
NOTE:
 An encryption key has been generated to encrypt sensitive data in the Management Repository. If this key is lost, all encrypted data in the Repository becomes unusable. Please run following command to backup the Management Service configuration including the emkey and keep the backup on another system:

 emctl exportconfig oms -dir <backup location>

[ushdc85038 oraoem OQR]>. set_OMS
[ushdc85038 oraoem OQR]> emctl exportconfig oms -dir /oraexp/oms_config
Oracle Enterprise Manager Cloud Control 13c Release 4
Copyright (c) 1996, 2020 Oracle Corporation.  All rights reserved.
Enter Enterprise Manager Root (SYSMAN) Password :
ExportConfig started...
Backup directory is /oraexp/oms_config
Machine is Admin Server host. Performing Admin Server backup...
Exporting emoms properties...
Exporting secure properties...

Export has determined that the OMS is not fronted
by an SLB. The local hostname was NOT exported.
The exported data can be imported on any host but
resecure of all agents will be required. Please
see the EM Advanced Configuration Guide for more
details.

Exporting configuration for pluggable modules...
Preparing archive file...
Backup has been written to file: /oraexp/oms_config/opf_ADMIN_20200928_104022.bka

The export file contains sensitive data.
 You must keep it secure.

ExportConfig completed successfully!

38	 Log into OEM 13c console via sysman user/password.  The URL is https://ushdc85038.us.deloitte.com:7803/em .

39	Set up the Welcome Page to be â€œSummaryâ€ which is shown below.

 
 

 


40	The WebLogic/WebTier/OMS/Agent/Repository/Host targets are automatically discovered and monitored in OEM 13c.  See screenshot below.  The database and the listener are not automatically added.  We will add these targets later.  Can view the remaining targets via Setup -> Add Target -> Auto Discovery Results and choose the â€œNon-Host Targetsâ€ tab.  

 
 

41	For now, Application Dependency and Performance (ADP) & JVM Diagnostics are not installed.


4	Adding Additional OMS Server
4.1	Requirements
â€¢	The default command locations specified in the property files can vary between hosts and operating systems.  Make sure that the ssPaths_aix.properties file in $OMS_HOME/oui/prov/resources is configured to match that of primary OMS.
â€¢	When installing additional OMS server, need to make sure all patches applied on primary OMS are available on additional OMS server.  More importantly, make sure any AUTO UPDATE patches applied on additional OMS is also applied on primary OMS!!!
4.2	Process
The clone is a software only install.  The OMS software is installed in /u01/app/oracle/Middleware on USNDC85038.  Then, the OMS is configured.  This is because, at the time, the cloning method has a problem.  
4.3	Installation 
4.3.1	Installation Prerequisites
Make sure latest software is downloaded (must include bundle patch 1).  
ORACLE_HOME and ORACLE_SID need to be unset prior to install.
No Oracle directories in $PATH.
Set DISPLAY variable for installer.
An Oracle Database must be installed and operational to configure the Management Repository.
The server must have unique hostname on network and use static IP address.  
/tmp must have at 400 MB of disk space.
The /u01/app/oraInventory filesystem must have at least 100 MB of free disk.
The umask must be 022 and set in .bash_profile.
Verify file descriptors is set to minimum of 65536 via the /etc/security/limits.conf file.  
The installation must NOT be done by root user.  
4.3.2	Installation Steps
1	Mount /orainstall NAS mount point to additional server.
2	cd to /orainstall/oracle/SLES12/13cR4_OEM
3	SCP the three ZIP files to /oraexp on OEM server.
4	Unzip the files.
5	Log in as the â€˜oraoemâ€™ user.  
6	Make sure ORACLE_HOME and ORACLE_SID are unset.  
7	Unset DB HOME paths from PATH value by exporting below paths
EXPORT PATH=:/u01/app/oracle/scripts/maint:/u01/app/oracle/bin:/bin:/usr/bin:/usr/sbin/:/usr/ccs/bin:/usr/bin/X11:/usr/lbin:/usr/local/bin:/etc:/sbin:/u01/app/oracle/bin:/usr/local/bin:/usr/bin:/bin:/usr/bin/X11:/usr/games:/usr/lib/mit/bin:/opt/puppetlabs/bin:.
8	Unset CLASSPATH, LD_LIBRARY_PATH
EXPORT CLASSPATH=
       EXPORT LD_LIBRARY_PATH=
9	Make sure DISPLAY variable is set for Xwindows.
10	Change to /oraexp/13.4_SWand change the permission of all files to 755.
11	No need to unzip the software files.
12	Execute em13400_linux64.bin.
13	Skip â€œMy Oracle Support Detailsâ€

 
14	Choose â€œYesâ€ for confirmation.
15	Skip the software updates.



 
16	Click â€œNextâ€
17	Make sure that all the required prerequisites are passed.
 

18	Choose â€œInstall Software Onlyâ€ option, click â€œNextâ€.

 
19	Enter the location of Middleware Home and Agent Home. Then click â€œNextâ€.
 

20	Review the details, click â€œInstallâ€.
 

21	Monitor the progress of the installation.
 

22	Execute allroot.sh as the root user at command prompt and then click â€œOKâ€

 

[usndc85038 oraoem OQR]> sudo /usr/bin/ksh
# /u01/app/oracle/Middleware/allroot.sh

Starting to execute allroot.sh .........

Starting to execute /u01/app/oracle/Middleware/root.sh ......
Performing root user operation.

The following environment variables are set as:
    ORACLE_OWNER= oraoem
    ORACLE_HOME=  /u01/app/oracle/Middleware

Enter the full pathname of the local bin directory: [/usr/local/bin]:
The contents of "dbhome" have not changed. No need to overwrite.
The file "oraenv" already exists in /usr/local/bin.  Overwrite it? (y/n)
[n]: y
   Copying oraenv to /usr/local/bin ...
The file "coraenv" already exists in /usr/local/bin.  Overwrite it? (y/n)
[n]: y
   Copying coraenv to /usr/local/bin ...

Entries will be added to the /etc/oratab file as needed by
Database Configuration Assistant when a database is created
Finished running generic part of root script.
Now product-specific root actions will be performed.
/etc exist
/u01/app/oracle/Middleware

Finished product-specific root actions.
/etc exist
/u01/app/oracle/product/13.4.0/agent13c/agent_13.4.0.0.0
Finished execution of  /u01/app/oracle/Middleware/root.sh ......


Starting to execute /u01/app/oracle/product/13.4.0/agent13c/agent_13.4.0.0.0/root.sh ......

Finished product-specific root actions.
/etc exist
/u01/app/oracle/product/13.4.0/agent13c/agent_13.4.0.0.0
Finished execution of  /u01/app/oracle/product/13.4.0/agent13c/agent_13.4.0.0.0/root.sh ......
#

23	Click â€œCloseâ€
 

4.3.3	Deploy the plug-ins on Additional OMS :

1	In GUI mode, execute below on additional OMS server to deploy the plugins. 

$<Additional_OMS_HOME>/sysman/install/PluginInstall.sh

i.e. /u01/app/oracle/Middleware/ sysman/install/PluginInstall.sh
 

2	On the Plug-In Deployment screen, select the default plugins and click â€œNextâ€.
 

3	Click â€œInstallâ€ to install the chosen plugins.

 


	 

4	Plugin installation completed, click â€œCloseâ€.

 

Check whether all the patches applied on 1st OMS are applied on 2nd OMS or not. If there is any mismatch, apply the missing patches on 2nd OMS.

4.4	Post Installation steps for additional OMS
1	Export the configuration details from the first OMS (ushdc85038). To do so, run the following command from the Oracle home of the first OMS host, and pass the location where the configuration details can be exported as a file.

[ushdc85038 oraoem OQR]> emctl exportconfig oms -dir /oraexp/oms_config
Oracle Enterprise Manager Cloud Control 13c Release 4
Copyright (c) 1996, 2020 Oracle Corporation.  All rights reserved.
Enter Enterprise Manager Root (SYSMAN) Password :
ExportConfig started...
Backup directory is /oraexp/oms_config
Machine is Admin Server host. Performing Admin Server backup...
Exporting emoms properties...
Exporting secure properties...

Export has determined that the OMS is not fronted
by an SLB. The local hostname was NOT exported.
The exported data can be imported on any host but
resecure of all agents will be required. Please
see the EM Advanced Configuration Guide for more
details.

Exporting configuration for pluggable modules...
Preparing archive file...
Backup has been written to file: /oraexp/oms_config/opf_ADMIN_20200928_104022.bka

The export file contains sensitive data.
 You must keep it secure.

ExportConfig completed successfully!

2	Copy the exported configuration details file from the first OMS host to the additional OMS host.

[ushdc85038 oraoem OQR]> cd oms_config
[ushdc85038 oraoem OQR]> ls
opf_ADMIN_20200928_104022.bka
[ushdc85038 oraoem OQR]> cd ..
[ushdc85038 oraoem OQR]> scp -r oms_config oraoem@usndc85038:/oraexp
*****************************************************************************
*                                                                           *
*                           ******** Warning ********                       *
*                                                                           *
* This system is restricted to Deloitte & Touche authorized users for       *
* business purposes only.  Unauthorized access or use is a violation of     *
* company policy and the law.  This system may be monitored for             *
* administrative and security reasons.  By proceeding, you acknowledge that *
* (1) you have read and understand this notice and (2) you consent to the   *
* system monitoring.                                                        *
*                                                                           *
*****************************************************************************

oraoem@usndc85038's password:
opf_ADMIN_20200928_104022.bka                                                                                              100%   43MB  43.1MB/s   00:00
[ushdc85038 oraoem OQR]>

3	Recover the configuration details onto the additional OMS. To do so, run the following command from the Oracle home of the additional OMS host:

Syntax:
$<ORACLE_HOME>/bin/omsca recover -ms -backup_file <absolute_path_to_the_file_copied_in_step4> [-AS_HTTPS_PORT <port> -MSPORT <port> -MS_HTTPS_PORT <port> -EM_NODEMGR_PORT <port> -EM_UPLOAD_PORT <port> -EM_UPLOAD_HTTPS_PORT <port> -EM_CONSOLE_PORT <port> -EM_CONSOLE_HTTPS_PORT <port> -config_home <absolute_path_to_instance_dir> -EM_INSTANCE_HOST <second_oms_host_name>] -EM_BIP_PORT <port> -EM_BIP_HTTPS_PORT <port> -EM_BIP_OHS_PORT <port> -EM_BIP_OHS_HTTPS_PORT <port>


[usndc85038 oraoem OQR]> /u01/app/oracle/Middleware/bin/omsca recover -ms -backup_file /oraexp/oms_config/opf_ADMIN_20200928_104022.bka -AS_HTTPS_PORT 7102 -MSPORT 7203 -MS_HTTPS_PORT 7301 -EM_NODEMGR_PORT 7403 -EM_UPLOAD_PORT 4889 -EM_UPLOAD_HTTPS_PORT 4903 -EM_CONSOLE_PORT 7788 -EM_CONSOLE_HTTPS_PORT 7803 -config_home /u01/app/oracle/gc_inst -EM_BIP_PORT 9701 -EM_BIP_HTTPS_PORT 9803 -EM_INSTANCE_HOST usndc85038.us.deloitte.com -EM_BIP_OHS_PORT 9788 -EM_BIP_OHS_HTTPS_PORT 9851
Oracle Enterprise Manager Cloud Control 13c Release 13.4.0.0.0
Copyright (c) 1996, 2020, Oracle. All rights reserved.

log4j:WARN No appenders could be found for logger (emctl.secure.oms.SecureOMSCmds).
log4j:WARN Please initialize the log4j system properly.
log4j:WARN See http://logging.apache.org/log4j/1.2/faq.html#noconfig for more info.
Recovered Instance Host name used from command line argument : usndc85038.us.deloitte.com
OS check passed.
OMS version check passed.
Source Instance Host name where configuration is exported : ushdc85038.us.deloitte.com
instHost name retrieved from local host name : usndc85038.us.deloitte.com
Populated install params from backup...
Enter Administration Server user password:
Enter Repository database user password:
Enter Agent Registration password:
Confirm Password:
Doing pre requisite checks ......
Pre requisite checks completed successfully

Checking Plugin software bits
Proceed to recovery
A new managed server EMGC_OMS2 will be created.
Now launching AddOMS...
Infrastructure setup of EM completed successfully.

Doing pre deployment operations ......
Pre deployment of EM completed successfully.

Deploying EM ......
Creating Data source first !!
Deployment of EM completed successfully.

Configuring webtier ......
Configuring webTier completed successfully.

Importing OMS configuration from recovery file...

If you have software library configured
please make sure it is functional and accessible
from this OMS by visiting:
 Setup->Provisioning and Patching->Software Library

Importing configuration for pluggable modules...
Successfully Added a  BI Publisher server, named 'BIP2', to Enterprise Manager.

Securing OMS ......
Post "Deploy and Repos Setup" operations completed successfully.

Performing Post deploy operations ....
Total 0 errors, 85 warnings. 0 entities imported.
OMSCA-WRN:Post-deploy operations completed with non-fatal errors. Check the file:/u01/app/oracle/Middleware/cfgtoollogs/omsca/logs20200928105527/omsca_err.txt
Post deploy operations completed successfully.

EM configuration completed successfully.
EM URL is:https://usndc85038.us.deloitte.com:7803/em

Add OMS finished successfully
Creation and setup of new server EMGC_OMS2 completed successfully
OMSCA Recover completed successfully
[usndc85038 oraoem OQR]>

4	Configure the Management Agent on the additional OMS host by running the following command from the agent home:

[usndc85038 oraoem OQR]> /u01/app/oracle/product/13.4.0/agent13c/agent_13.4.0.0.0/sysman/install/agentDeploy.sh AGENT_BASE_DIR=/u01/app/oracle/product/13.4.0/agent13c OMS_HOST=usndc85038.us.deloitte.com EM_UPLOAD_PORT=4903 AGENT_REGISTRATION_PASSWORD=oem13cbe -configOnly

Validating the OMS Host and Port completed.
-configOnly
/u01/app/oracle/product/13.4.0/agent13c/agent_13.4.0.0.0/oracle_common/jdk/jre/bin/java -classpath /u01/app/oracle/product/13.4.0/agent13c/agent_13.4.0.0.0/oui/modules/OraInstaller.jar:/u01/app/oracle/product/13.4.0/agent13c/agent_13.4.0.0.0/oui/modules/emCfg.jar:/u01/app/oracle/product/13.4.0/agent13c/agent_13.4.0.0.0/jlib/agentInstaller.jar     oracle.sysman.agent.installer.AgentFreshInstaller /u01/app/oracle/product/13.4.0/agent13c/agent_13.4.0.0.0 /u01/app/oracle/product/13.4.0/agent13c/agent_inst /u01/app/oracle/product/13.4.0/agent13c RESPONSE_FILE=/u01/app/oracle/product/13.4.0/agent13c/agentInstall.rsp  $args
The AgentFreshInstaller is starting now
Oraclehome : ../u01/app/oracle/product/13.4.0/agent13c/agent_13.4.0.0.0
InstanceHome : /u01/app/oracle/product/13.4.0/agent13c/agent_inst
Agent Base Directory : /u01/app/oracle/product/13.4.0/agent13c
The oraclehome /u01/app/oracle/product/13.4.0/agent13c/agent_13.4.0.0.0
Sep 28, 2020 11:17:35 AM oracle.sysman.agent.installer.AgentInstaller parseResponseFile
INFO: /u01/app/oracle/product/13.4.0/agent13c/agent_13.4.0.0.0
Sep 28, 2020 11:17:35 AM oracle.sysman.agent.installer.AgentInstaller parseResponseFile
INFO: /u01/app/oracle/product/13.4.0/agent13c/agent_inst
Sep 28, 2020 11:17:35 AM oracle.sysman.agent.installer.AgentInstaller parseResponseFile
INFO: /u01/app/oracle/product/13.4.0/agent13c
Sep 28, 2020 11:17:35 AM oracle.sysman.agent.installer.AgentInstaller parseResponseFile
INFO: RESPONSE_FILE=/u01/app/oracle/product/13.4.0/agent13c/agentInstall.rsp
Sep 28, 2020 11:17:35 AM oracle.sysman.agent.installer.AgentInstaller parseResponseFile
INFO: AGENT_BASE_DIR=/u01/app/oracle/product/13.4.0/agent13c
Sep 28, 2020 11:17:35 AM oracle.sysman.agent.installer.AgentInstaller parseResponseFile
INFO: OMS_HOST=usndc85038.us.deloitte.com
Sep 28, 2020 11:17:35 AM oracle.sysman.agent.installer.AgentInstaller parseResponseFile
INFO: EM_UPLOAD_PORT=4903
Sep 28, 2020 11:17:35 AM oracle.sysman.agent.installer.AgentInstaller parseResponseFile
INFO: ORACLE_HOME=/u01/app/oracle/product/13.4.0/agent13c/agent_13.4.0.0.0
Sep 28, 2020 11:17:35 AM oracle.sysman.agent.installer.AgentInstaller parseResponseFile
INFO: EM_UPLOAD_PORT=4903
Sep 28, 2020 11:17:35 AM oracle.sysman.agent.installer.AgentInstaller parseResponseFile
INFO: OMS_HOST=usndc85038.us.deloitte.com
Sep 28, 2020 11:17:35 AM oracle.sysman.agent.installer.AgentInstaller parseResponseFile
INFO: AGENT_INSTANCE_HOME=/u01/app/oracle/product/13.4.0/agent13c/agent_inst
Sep 28, 2020 11:17:35 AM oracle.sysman.agent.installer.AgentInstaller parseResponseFile
INFO: AGENT_BASE_DIR=/u01/app/oracle/product/13.4.0/agent13c
Sep 28, 2020 11:17:35 AM oracle.sysman.agent.installer.AgentInstaller parseResponseFile
INFO: b_doDiscovery=true
Sep 28, 2020 11:17:35 AM oracle.sysman.agent.installer.AgentInstaller parseResponseFile
INFO: START_AGENT=true
startAgent is:true
Sep 28, 2020 11:17:35 AM oracle.sysman.agent.installer.AgentInstaller parseResponseFile
INFO: b_forceConfigure=false
Sep 28, 2020 11:17:35 AM oracle.sysman.agent.installer.AgentInstaller parseResponseFile
INFO: b_sharedAgents=false
Sep 28, 2020 11:17:35 AM oracle.sysman.agent.installer.AgentInstaller parseResponseFile
INFO: b_secureAgent=true
seci is :true
Sep 28, 2020 11:17:35 AM oracle.sysman.agent.installer.AgentInstaller parseResponseFile
INFO: b_noUpgrade=true
Sep 28, 2020 11:17:35 AM oracle.sysman.agent.installer.AgentInstaller parseResponseFile
INFO: b_agentupgrade=false
Sep 28, 2020 11:17:35 AM oracle.sysman.agent.installer.AgentInstaller parseResponseFile
INFO: PLUGIN_RSPFILE=/u01/app/oracle/product/13.4.0/agent13c/agent_13.4.0.0.0/sysman/install/plugins.txt
log loction is setlog
Writing the following contents into /u01/app/oracle/product/13.4.0/agent13c/agent_13.4.0.0.0/install/oragchomelist
/u01/app/oracle/product/13.4.0/agent13c/agent_13.4.0.0.0:/u01/app/oracle/product/13.4.0/agent13c/agent_inst
Creating directory /u01/app/oracle/product/13.4.0/agent13c/agent_13.4.0.0.0/install/tmp completed successfully.
File /etc/oragchomelist exists.
File /etc/oragchomelist is writable.
Index :-1 for line : /u01/app/oracle/product/13.2.0/agent13c/agent_13.2.0.0.0:/u01/app/oracle/product/13.2.0/agent13c/agent_inst
Index :-1 for line : /u01/app/oracle/Middleware
Index :0 for line : /u01/app/oracle/product/13.4.0/agent13c/agent_13.4.0.0.0
Overwriting the contents since oracle home:/u01/app/oracle/product/13.4.0/agent13c/agent_13.4.0.0.0 entry already exists.
The value of chainInstall : false forceConfigure : false skipValidation : false
Validating oms host & port with url: https://usndc85038.us.deloitte.com:4903/empbs/genwallet
Validating oms host & port with url: http://usndc85038.us.deloitte.com:4903/empbs/genwallet
The status is 0
Validated the oms host and port :- usndc85038.us.deloitte.com----4903
Getting Inet Addresses for host usndc85038
Getting Inet Addresses for host usndc85038
** Agent Port Check completed successfully.**
Validated the agent port :- ----1830
shared agent value is :false
chain install is :false
Agent Configuration completed successfully
The following configuration scripts need to be executed as the "root" user. Root script to run : /u01/app/oracle/product/13.4.0/agent13c/agent_13.4.0.0.0/root.sh
/u01/app/oracle/product/13.4.0/agent13c/agent_13.4.0.0.0/cfgtoollogs/agentDeploy/agentDeploy_2020-09-28_11-17-35-AM.log
Waiting for agent targets to get promoted...
Successfully Promoted agent and its related targets to Management Agent

Execute /u01/app/oracle/product/13.4.0/agent13c/agent_13.4.0.0.0/root.sh as root user on usndc85038.


Check the agent status:
 [usndc85038 oraoem OQR]>  emctl status agentOracle Enterprise Manager Cloud Control 13c Release 4
Copyright (c) 1996, 2020 Oracle Corporation.  All rights reserved.
---------------------------------------------------------------
Agent Version          : 13.4.0.0.0
OMS Version            : 13.4.0.0.0
Protocol Version       : 12.1.0.1.0
Agent Home             : /u01/app/oracle/product/13.4.0/agent13c/agent_inst
Agent Log Directory    : /u01/app/oracle/product/13.4.0/agent13c/agent_inst/sysman/log
Agent Binaries         : /u01/app/oracle/product/13.4.0/agent13c/agent_13.4.0.0.0
Core JAR Location      :/u01/app/oracle/product/13.4.0/agent13c/agent_13.4.0.0.0/jlib
Agent Process ID       : 57077
Parent Process ID      : 56901
Agent URL              : https://usndc85038.us.deloitte.com:1830/emd/main/
Local Agent URL in NAT : https://usndc85038.us.deloitte.com:1830/emd/main/
Repository URL         : https://usndc85038.us.deloitte.com:4903/empbs/upload
Started at             : 2020-09-28 11:18:15
Started by user        : oraoem
Operating System       : Linux version 4.12.14-122.37-default (amd64)
Number of Targets      : 8
Last Reload            : (none)
Last successful upload                       : 2020-09-29 09:39:31
Last attempted upload                        : 2020-09-29 09:39:31

Total Megabytes of XML files uploaded so far : 1.71
Number of XML files pending upload           : 0
Size of XML files pending upload(MB)         : 0
Available disk space on upload filesystem    : 56.27%
Collection Status                            : Collections enabled
Heartbeat Status                             : Ok
Last attempted heartbeat to OMS              : 2020-09-29 09:42:01
Last successful heartbeat to OMS             : 2020-09-29 09:42:01
Next scheduled heartbeat to OMS              : 2020-09-29 09:43:02
---------------------------------------------------------------
Agent is Running and Ready
5	Post-Installation Steps

1	Verify the installation:
a.)	Navigate to the Oracle home and run the following command to see a message that confirms that OMS is up and running.
[usndc85038 oraoem OQR]> . set_OMS
[usndc85038 oraoem OQR]> emctl status oms
Oracle Enterprise Manager Cloud Control 13c Release 4
Copyright (c) 1996, 2020 Oracle Corporation.  All rights reserved.
WebTier is Up
Oracle Management Server is Up
JVMD Engine is Up
BI Publisher Server is Up
b.)	Navigate to the Management Agent home and run the following command to see a message that confirms that the Management Agent is up and running.
[usndc85038 oraoem ]> emctl status agent
Oracle Enterprise Manager Cloud Control 13c Release 4
Copyright (c) 1996, 2020 Oracle Corporation.  All rights reserved.
---------------------------------------------------------------
Agent Version          : 13.4.0.0.0
OMS Version            : 13.4.0.0.0
Protocol Version       : 12.1.0.1.0
Agent Home             : /u01/app/oracle/product/13.4.0/agent13c/agent_inst
Agent Log Directory    : /u01/app/oracle/product/13.4.0/agent13c/agent_inst/sysman/log
Agent Binaries         : /u01/app/oracle/product/13.4.0/agent13c/agent_13.4.0.0.0
Core JAR Location      : /u01/app/oracle/product/13.4.0/agent13c/agent_13.4.0.0.0/jlib
Agent Process ID       : 57077
Parent Process ID      : 56901
Agent URL              : https://usndc85038.us.deloitte.com:1830/emd/main/
Local Agent URL in NAT : https://usndc85038.us.deloitte.com:1830/emd/main/
Repository URL         : https://usndc85038.us.deloitte.com:4903/empbs/upload
Started at             : 2020-09-28 11:18:15
Started by user        : oraoem
Operating System       : Linux version 4.12.14-122.37-default (amd64)
Number of Targets      : 8
Last Reload            : (none)
Last successful upload                       : 2020-09-29 09:39:31
Last attempted upload                        : 2020-09-29 09:39:31
Total Megabytes of XML files uploaded so far : 1.71
Number of XML files pending upload           : 0
Size of XML files pending upload(MB)         : 0
Available disk space on upload filesystem    : 56.27%
Collection Status                            : Collections enabled
Heartbeat Status                             : Ok
Last attempted heartbeat to OMS              : 2020-09-29 09:42:01
Last successful heartbeat to OMS             : 2020-09-29 09:42:01
Next scheduled heartbeat to OMS              : 2020-09-29 09:43:02

---------------------------------------------------------------
Agent is Running and Ready
c.)	Navigate to the Management Agent home and run the following command to see a message that confirms that EMD upload completed successfully.
[usndc85038 oraoem ]> emctl upload agent
Oracle Enterprise Manager Cloud Control 13c Release 2
Copyright (c) 1996, 2016 Oracle Corporation.  All rights reserved.
---------------------------------------------------------------
EMD upload completed successfully

2	Verify if all the plug-ins were installed successfully. To do so, access the following log file from the Management Agent home, and make sure the sentence WARN:Plugin configuration has failed is not present in the file. If the sentence is not present, it is an indication that all plug-ins were installed successfully.

Ex: 

Go to /u01/app/oracle/product/13.4.0/agent13c/agent_inst/install/logs

Check the deployment log in agentplugindeploy_2020_09_28_11_17_37.log

$<AGENT_INSTANCE_HOME>/install/logs/agentplugindeploy_<timestamp>.log

If you find the sentence, then it is an indication that the plug-in installed failed for some plug-ins. In this case, resolve the issue by running the AgentPluginDeploy.pl script from the Management Agent home.

$<AGENT_HOME>/perl/bin/perl <AGENT_HOME>/bin/AgentPluginDeploy.pl -oracleHome <AGENT_HOME> -agentDir <AGENT_BASE_DIR> -pluginIdsInfoFile <AGENT_BASE_DIR>/plugins.txt -action configure -emStateDir <AGENT_INSTANCE_HOME>
For example,
/u01/software/em13c/agentbasedir/agent_13.4.0.0.0/perl/bin/perl 
/u01/software/em13c/agentbasedir/agent_13.4.0.0.0/bin/AgentPluginDeploy.pl -oracleHome /u01/software/em13c/agentbasedir/agent_13.4.0.0.0/ -agentDir /u01/software/em13c/agentbasedir -pluginIdsInfoFile /u01/software/em13c/agentbasedir/plugins.txt -action configure -emStateDir /u01/agent/agent_inst
3	By default, the following targets get automatically discovered and monitored in the Enterprise Manager Cloud Control Console:
a.)	Oracle WebLogic Domain (for example, GCDomain)
b.)	Oracle WebLogic AdminServer
c.)	Oracle WebLogic Server
d.)	Oracle Web Tier
e.)	Application deployments, one for the Enterprise Manager Cloud Control console and one for the platform background services.
f.)	Oracle Management Service
g.)	Oracle Management Metadata Repository
h.)	Oracle Management Agent
i.)	The host on which you installed Enterprise Manager Cloud Control
However, the other targets running on that host and other hosts do not get automatically discovered and monitored. To monitor the other targets, you need to add them to Enterprise Manager Cloud Control either using the Auto Discovery Results page, the Add Targets Manually page, or the discovery wizards offered for the targets you want to monitor.

4	Manually discover the Oracle WebLogic Server target.
a.)	Ensure that both the first and the additional OMS instances are up and running.
b.)	In the Cloud Control console, from the Targets menu, select All Targets.
c.)	On the All Targets page, search and click /EMGC_GCDomain/GCDomain/.
d.)	On the EMGC_GCDomain home page, from the WebLogic Domain menu, select Refresh WebLogic Domain.
e.)	On the Refresh WebLogic Domain page, click Add / Update Targets, and follow the steps guided by the wizard.
Enterprise Manager Cloud Control refreshes the WebLogic Domain and discovers the second managed server on the additional OMS host.
5.1	Firewall Rules
Make sure firewall rules are submitted ahead of time so that agent installs and uploads are not impacted.  Use DBA Team spreadsheets and submit to http://securityweb.  Use Appendix G to determine necessary ports to open.  
5.2	Create Administrator Accounts
5.2.1	DBA_ADMIN Account
Log in 13c console as SYSMAN user and go to Setup -> Security -> Administrators.  Create the DBA_ADMIN account which is:
 
The email address is: ustidatabaseservicesoracle@deloitte.com, usoracleon-call@deloitte.com and the access is â€œSuper Administrator.â€  The password should be same as that used for Whisper.  The â€œJob Systemâ€ resource privilege should be granted to this user.  This account is used to create ALL objects in 13c GRID.  
5.2.2	Configuration to Send a Page/eMail
Login to OEM as DBA_ADMIN. Navigate to DBA_ADMIN menu at the top right hand corner and choose 'Enterprise Manager Password & E-mail'. Add the Mail ID (ustidatabaseservicesoracle@deloitte.com) and select the type as Email (Long). Add the email usoracleon-call@deloitte.com and select the type as Pager (short). Click â€œApplyâ€.
 

5.3	Deactivate AutoStart via rc.d
We do not want OMS and the agent to start up automatically after a reboot.  To turn off this functionality, the /etc/rc.d/gcstartup file needs to be edited â€“ the lines which contain the â€œomsstupâ€ & the â€œagentstupâ€ entries need to be commented out.  

Execute below steps on both the OMS nodes:
 
NOTE: This step is per Oracle Note: 1478617.1.
5.4	Configure Email Notification Method
1.	Login to 13c Cloud Control as a Super-Administrator.
2.	Navigate to Setup -> Notifications -> Email Servers.

 
3.	Click on â€œEditâ€ at â€œIdentify Sender Asâ€ 
Enter â€œIdentify Sender Asâ€ â€œUS TI Database Services Oracleâ€
Enter â€œSenderâ€™s Email Addressâ€ as USTIDatabaseServicesOracle@deloitte.com
Click â€œOKâ€
  
4.	On â€œOutgoing Mail (SMTP) Serversâ€, click â€œAddâ€ and enter the details as below and click â€œOKâ€.

Host -> smtp.us.deloitte.com
Port -> 25 (Leave the default)
Use Secure Connection -> No (Default)

 

5.	Select the Outgoing Mail Server (smtp.us.deloitte.com) and click on â€œTest Mail Serversâ€. OEM will send the test mail, if you donâ€™t get the mail verify the smtp server details again.

5.5	Apply recent release patch
Due to recent changes on MOS, Credentials are not working, even though we pass correct logins.

Refer the below KM note.

Recent Changes to MOS will Disable Enterprise Manager Online Connections ( Doc ID 2664002.1 )

Issue got fixed with the OMS RU 4 For OEM 13.4.

OMS and OMS-Side Plug-in RU 6: Patch 31767864

Apply patch as per patch README.

Note: OMS RU patch includes fixes for both OMS and Plugins on OMS.

5.6	Oracle Enterprise Manager 13c Configuration Best Practices 
         As per the Document 2139083.1: Oracle Enterprise Manager 13c Configuration Best Practices 
5.6.1	 OMS Recommendations
5.6.1.1	Increase JAVA Heap Size
For larger enterprises, there may be a need to increase the amount of memory used for the OMS.  One of the symptoms of this condition is a â€œsluggishâ€ performance on the OMS.  If it is determined that the OMS needs more memory, it is done by increasing the JAVA heap size parameters.  However, it is very important to increase this parameter incrementally and be careful not to consume all of the memory on the server.  Also, java does not always perform better with more memory. 

Recommendation:  If you have more than 250 agents, increase the OMS_HEAP_MAX parameter to 4 GB.  As the number of agents grows, it can be incrementally increased.  Note:  Do not increase this larger than 8 GB without contacting Oracle.

Steps to modify the Java setting 
$ emctl set property -name <n> -value <v> 
$ emctl stop oms -all 
$ emctl start oms

Below is an example command that modifies the value for the max heap size.  For more details on recommended sizes for an EM environment.
Note:- Execute below command on both OMSâ€™s.
$ emctl set property -name OMS_HEAP_MAX -value 4096M

5.6.2	Repository Recommendations
5.6.2.1	Repvfy execute optimize, Increase Task Workers & Increase Ping Grace Period
This command can be executed to establish a baseline and set the environment to the â€œrecommendedâ€ values based on the configuration of that environment.  The following command will check the existing settings and modify them if needed.
$ repvfy execute optimize

As per the Document 1426973.1: EMDIAG REPVFY Kit for Cloud Control 13c, 13c - Download, Install/De-Install and Upgrade follow below steps to download & install repvfy before executing the above command:

1.	Download the EMDIAG REPVFY Kit Release  2020.07.16 from the document 1426973.1.
2.	Create a sub directory /emdiag under OMS Home, for instance: $OMS_HOME/emdiag.
Note:- Create the directory emdiag on both the nodes in repository home.
3.	Unzip the file repvfy12_YYYY.MMDD.zip in the directory /u01/app/oracle/Middleware/emdiag created in step 2.
4.	Make sure the repvfy script is executable. If not, make the script executable:
$ cd <EMDIAG_HOME>/bin
$ chmod +x repvfy
5.	Install the EMDIAG Repvfy Kit:
a.	Set the environment variable ORACLE_HOME to the database OMS_HOME.
b.	Run the following command:
On 1st Node:


Ushdc85038 (Primary OMS):
[ushdc85038 oraoem OQR]> ./repvfy install -tns '(DESCRIPTION=(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=ushdc85038.us.deloitte.com)(PORT=1521)))(CONNECT_DATA=(SID=OQR)))'

Please enter the SYSMAN password:


SQL*Plus: Release 12.1.0.2.0 Production on Tue Oct 13 16:12:15 2020

Copyright (c) 1982, 2014, Oracle.  All rights reserved.

SQL> Connected.

Session altered.


Session altered.

VIEW EM$DIAG_RESULTS_EXT: already gone
VIEW EM$DIAG_LATEST_RESULTS_EXT: already gone
VIEW EM$DIAG_LATEST_SCORE_EXT: already gone
VIEW EM$DIAG_INFO_EXT: already gone
VIEW EM$DIAG_INFO_FULL_EXT: already gone
VIEW EM$DIAG_OBJ_EXT: already gone
VIEW EM$DIAG_OBJ_LOG_EXT: already gone
VIEW EM$DIAG_REP_EXT: already gone
VIEW EM$DIAG_REP_LOG_EXT: already gone
VIEW EM$DIAG_REP_RUN_EXT: already gone
VIEW EM$DIAG_LOGS_EXT: already gone
VIEW EM$DIAG_OBJ_ERROR_EXT: already gone
VIEW EM$DIAG_REP_ERROR_EXT: already gone
VIEW EM$DIAG_ERRORS_EXT: already gone
PACKAGE GC_DIAG_EXT: already gone
PACKAGE GC_DIAG2_EXT: already gone
PACKAGE GC_DIAG3_EXT: already gone
TABLE EM_DIAG_CONFIG_EXT: already gone
TABLE EM_DIAG_OPTIONS_EXT: already gone
TABLE EM_DIAG_OBJ_LOG_EXT: already gone
TABLE EM_DIAG_REP_LOG_EXT: already gone
TABLE EM_DIAG_REP_RESULTS_EXT: already gone
TABLE EM_DIAG_DMP_EXT: already gone
TABLE EM_DIAG_OBJ_EXT: already gone
TABLE EM_DIAG_REP_EXT: already gone
TABLE EM_DIAG_MODULES_EXT: already gone
TABLE EM_DIAG_SCHEMA_OBJECTS_EXT: already gone

PL/SQL procedure successfully completed.

not spooling currently
Disconnected from Oracle Database 19c Enterprise Edition Release 19.0.0.0.0 - Production

SQL*Plus: Release 12.1.0.2.0 Production on Tue Oct 13 16:12:15 2020

Copyright (c) 1982, 2014, Oracle.  All rights reserved.

SQL> Connected.

Session altered.


Session altered.


PL/SQL procedure successfully completed.


Table created.


Trigger created.


Trigger created.

No errors.

Table created.


Table created.


Table created.


Table altered.


Table created.


Table altered.


Table created.


Table altered.


Table created.


Index created.


Table created.


Index created.


Table created.


Table created.


Index created.


PL/SQL procedure successfully completed.


PL/SQL procedure successfully completed.


Package created.

No errors.

Package created.

No errors.

Package created.

No errors.

Package body created.

No errors.

Package body created.

No errors.

Package body created.

No errors.

PL/SQL procedure successfully completed.


View created.


View created.


View created.


View created.


View created.


View created.


View created.


View created.


View created.


View created.


View created.


View created.


View created.


View created.


View created.


View created.


View created.


View created.


View created.


View created.


PL/SQL procedure successfully completed.


PL/SQL procedure successfully completed.


Table truncated.

1 - ADP

PL/SQL procedure successfully completed.


Commit complete.

1 - AGENTS

PL/SQL procedure successfully completed.


Commit complete.

1 - ASLM

PL/SQL procedure successfully completed.


Commit complete.

1 - AVAILABILITY

PL/SQL procedure successfully completed.


Commit complete.

1 - BACKLOG

PL/SQL procedure successfully completed.


Commit complete.

1 - BLACKOUTS

PL/SQL procedure successfully completed.


Commit complete.

1 - CA

PL/SQL procedure successfully completed.


Commit complete.

1 - CAT

PL/SQL procedure successfully completed.


Commit complete.

1 - CORE

PL/SQL procedure successfully completed.


Commit complete.

1 - CREDENTIALS

PL/SQL procedure successfully completed.


Commit complete.

1 - ECM

PL/SQL procedure successfully completed.


Commit complete.

1 - EMDIAG

PL/SQL procedure successfully completed.


Commit complete.

1 - EVENTS

PL/SQL procedure successfully completed.


Commit complete.

1 - EXADATA

PL/SQL procedure successfully completed.


Commit complete.

1 - JOBS

PL/SQL procedure successfully completed.


Commit complete.

1 - JVMD

PL/SQL procedure successfully completed.


Commit complete.

1 - LOADERS

PL/SQL procedure successfully completed.


Commit complete.

1 - METRICS

PL/SQL procedure successfully completed.


Commit complete.

1 - NOTIFICATIONS

PL/SQL procedure successfully completed.


Commit complete.

1 - OMS

PL/SQL procedure successfully completed.


Commit complete.

1 - PATCHING

PL/SQL procedure successfully completed.


Commit complete.

1 - PLUGINS

PL/SQL procedure successfully completed.


Commit complete.

1 - PROVISIONING

PL/SQL procedure successfully completed.


Commit complete.

1 - RCA

PL/SQL procedure successfully completed.


Commit complete.

1 - REPORTS

PL/SQL procedure successfully completed.


Commit complete.

1 - REPOSITORY

PL/SQL procedure successfully completed.


Commit complete.

1 - ROLES

PL/SQL procedure successfully completed.


Commit complete.

1 - TARGETS

PL/SQL procedure successfully completed.


Commit complete.

1 - TEMPLATES

PL/SQL procedure successfully completed.


Commit complete.

1 - TRACE

PL/SQL procedure successfully completed.


Commit complete.

1 - UPGRADE

PL/SQL procedure successfully completed.


Commit complete.

1 - USERS

PL/SQL procedure successfully completed.


Commit complete.


Table truncated.

2 - AGENT

PL/SQL procedure successfully completed.


Commit complete.

2 - AQ

PL/SQL procedure successfully completed.

2 - BLACKOUT

PL/SQL procedure successfully completed.


Commit complete.

2 - CA

PL/SQL procedure successfully completed.


Commit complete.

2 - EXADATA

PL/SQL procedure successfully completed.


Commit complete.

2 - HOME

PL/SQL procedure successfully completed.


Commit complete.

2 - JOB

PL/SQL procedure successfully completed.


Commit complete.

2 - METRIC

PL/SQL procedure successfully completed.


Commit complete.

2 - PLUGIN

PL/SQL procedure successfully completed.


Commit complete.

2 - REPORT

PL/SQL procedure successfully completed.


Commit complete.

2 - ROLE

PL/SQL procedure successfully completed.


Commit complete.

2 - TABLE

PL/SQL procedure successfully completed.

2 - TARGET

PL/SQL procedure successfully completed.


Commit complete.

2 - USER

PL/SQL procedure successfully completed.


Commit complete.


PL/SQL procedure successfully completed.


PL/SQL procedure successfully completed.

not spooling currently

COMPONENT            INFO
-------------------- --------------------
EMDIAG Version       20.07.16
EMDIAG Edition       2
Repository Version   13.4.0.0.0
Database Version     19.0.0.0.0
Test Version         20.10.13
Repository Type      CENTRAL
Verify Tests         593
Object Tests         239
Deployment           SMALL

9 rows selected.

not spooling currently
Disconnected from Oracle Database 19c Enterprise Edition Release 19.0.0.0.0 - Production
Dependency      Found           Required
--------------- --------------- ---------------
java            1.7.0           1.7.0_191
perl            v5.28.1         5.016003
wget                            1.14
--------------------------------------------------
[ushdc85038 oraoem OQR]> 

5.6.2.2	Maintain Audit Data
Oracle always audits certain operations regardless of the database audit settings.  This is referred to as Mandatory Auditing and the audit records are written to the operating system in the destination specified by the initialization parameter AUDIT_FILE_DEST.
Mandatory auditing includes these operations:
o	Database startup
o	SYSDBA and SYSOPER logins
o	Database shutdown
Recommendation: The OMS servers have an agent that resides on each of them.  This agent logs into the repository every few minutes for self-monitoring thereby causing an audit record for each login.  Therefore, it is very important that the audit records are regularly archived and purged.
a.	Initialize the audit trail cleanup operation.
SQL> begin
  dbms_audit_mgmt.init_cleanup(
  AUDIT_TRAIL_TYPE => DBMS_AUDIT_MGMT.AUDIT_TRAIL_ALL,
  DEFAULT_CLEANUP_INTERVAL => 12);
  end;
  /

	PL/SQL procedure successfully completed.

b.	Setup an archive timestamp for the audit records.  The RAC_INSTANCE_NUMBER refers to the instance number when using a RAC database.  In a RAC database, this must be set for each instance since the mandatory audit records are stored on the operating system and therefore for each instance.
SQL> begin
  DBMS_AUDIT_MGMT.SET_LAST_ARCHIVE_TIMESTAMP(
  AUDIT_TRAIL_TYPE => DBMS_AUDIT_MGMT.AUDIT_TRAIL_OS,
  LAST_ARCHIVE_TIME => TO_DATE('2017-07-31 09:00:00','YYYY-MM-DD HH:MI:SS'),
  RAC_INSTANCE_NUMBER => 1);
  END;
  /
	
	PL/SQL procedure successfully completed.
c.	 Create and schedule the purge job
SQL> BEGIN
  DBMS_AUDIT_MGMT.CREATE_PURGE_JOB(
  AUDIT_TRAIL_TYPE => DBMS_AUDIT_MGMT.AUDIT_TRAIL_ALL,
  AUDIT_TRAIL_PURGE_INTERVAL => 12,
  AUDIT_TRAIL_PURGE_NAME => 'Standard_Audit_Trail_Cleanup',
  USE_LAST_ARCH_TIMESTAMP => TRUE);
  END;
  /
PL/SQL procedure successfully completed.
5.6.3	 WebLogic Server Recommendations
5.6.3.1	Stuck Thread Max Time
By design WLS will ping applications and wait for a response for up to 600 seconds (by default).  EM will keep threads running as long as there is work in the queue so they will not respond to a heartbeat causing WLS to timeout and error.  
This is expected behavior however you may see incidents created with errors like this: 

 
Recommendation: To stop these errors, modify the EM WLS xml config file to set the flag to "false" for the StuckThread item.  Note that this should ONLY be done for the EM WebLogic Server.  To do this, follow the steps below:
Note:- Perform below steps on both nodes.
1.	Log onto the primary OMS server.
2.	Change to the instance directory:
cd /u01/app/oracle/gc_inst/user_projects/domains/GCDomain/config/diagnostics/

3.	Edit the Module-FMWDFW-2818.xml file and make the following change:
Change:
<name>StuckThread</name>
<enabled>true</enabled>
To:
<name>StuckThread</name>
<enabled>false</enabled>
4.	This change requires a restart of the entire OMS stack to take effect:
$ emctl stop oms -all
$ emctl start oms

5.6.4	 Configuration Recommendations
5.6.4.1	Configure E-Mail Notifications for EM related Alerts
In some environments, the notifications for events for different target types may be sent to different support teams (i.e. notifications on host targets may be sent to a platform support team).  However, the EM application administrators should be well informed of any alerts or problems seen on the EM infrastructure components.  
Recommendation:  Create a new Incident rule for monitoring all EM components and setup the notifications to be sent to the EM administrator(s).  The notification methods available can create or update an incident, send an email or forward to an event connector.  To setup the incident rule set follow the steps below.  Note that each individual rule in the rule set can have different actions configured.
1.	To create an incident rule for monitoring the EM components, click on Setup / Incidents / Incident Rules. On the All Enterprise Rules page, click on the out-of-box rule called â€œIncident management Ruleset for all targetsâ€ and then click on the Actions drop down list and select â€œCreate Like Rule Setâ€¦â€

 

2.	For the rule set name, enter a name such as â€œMTM Rulesetâ€.  Under the Targets section, select â€œSpecific targetsâ€ and select â€œTargetsâ€ from the Add drop down list.  Click on the "+" sign.  Click on the drop down arrow for Target Type and deselect all target types except EM Service and â€œOMS and Repositoryâ€.  Click "Search".  Select the targets returned and click "Select".  The selected targets will be populated under the Specific targets section. 

 

3.	Scroll down to the Rules section.  To edit a rule, click on the rule name and click on Edit as seen below

 

4.	Modify the following rules:
a.	Create incident for critical metric alerts
I.	Leave the Type set as it is but click on â€œAdvanced Selection Optionsâ€ and change the Severity to add Warning by clicking on the drop down list and selecting â€œWarningâ€.  Click Next.
II.	You can add or modify the actions as required (i.e. add email notifications).  Click Continue and then click Next.
III.	Leave the Name and description the same and click Next.
IV.	Click Continue on the Review page.

b.	Incident creation rule for down and agent unreachable availability status for agents and hosts.
I.	Leave the Type set as is but add EM Service and OMS and Repository by clicking on the â€œ+Addâ€ option.  From the drop down list for Target Type, select  "EM Service" and click on Down, Agent Down, Agent Unreachable and Metric error detected.  Click OK.  Repeat the â€œ+Addâ€ using â€œOMS and Repositoryâ€ for the Target Type.  Under the Advanced Selection Options, click on the drop down list for Target Type and add both EM Service and OMS and Repository.  Click Next.
II.	You can add or modify the actions as required (i.e. add email notifications)  Click Continue and then click Next.
III.	Leave the Name and description the same and click Next. Click Continue on the Review page.

c.	 Incident creation rule for a Target Down availability status.
I.	Leave the Type set as is but add EM Service and OMS and Repository by clicking on the â€œ+Addâ€ option.  From the drop down list for Target Type, select  "EM Service" and click on Down, Agent Down, Agent Unreachableâ€œ and Metric error detected.  Click OK.  Repeat using OMS and Repository for the Target Type.  Click Next.
II.	You can add or modify the actions as required (i.e. add email notifications) Click Continue and then click Next.
III.	Leave the Name and description the same and click Next.
IV.	Click Continue on the Review page.

d.	Modify the actions for any other rule as required and be sure to click the â€œSaveâ€ push button to save the rule set or all changes will be lost.

5.6.4.2	Configure Out-of-Bound Notifications for EM Agent
Out-of-Bound notifications act as a backup when thereâ€™s a complete EM outage or a repository database issue. This is configured on the agent of the OMS server and can be used to send emails or execute another script that would create a trouble ticket. It will send notifications about the following issues:
â€¢	Repository Database down
â€¢	All OMS are down
â€¢	Repository side collection job that is broken or has an invalid schedule
â€¢	Notification job that is broken or has an invalid schedule
Recommendation: To setup Out-of-Band Notifications, refer to the Document 1472854.1 - How to Setup out Of Bound Email Notification In 13c.  Note that even though this note was created for EM 13c, it is still applicable and works in EM 13c.
5.7	OMS Weblogic Tuning
5.7.1	Stuck Thread Max Time Change
The â€œStuck Thread Max Timeâ€ parameter for Weblogic server needs to be increased from 600 to 1000 seconds.  This parameter is the number of seconds that a thread must be continually working before the Weblogic server considers the thread stuck.  For example, if you set this to 600 seconds, WebLogic Server considers a thread to be "stuck" after 600 seconds of continuous use.
To make the change, the Weblogic Admin-Server Console (https://ushdc8730.us.deloitte.com:7102/console) needs to be accessed.  See Appendix A for URL and log in data.  
1	Expend structure tree on left and choose â€œServersâ€.  
 
2	Choose EMGC_OMS1 server.
 
3	Choose â€œTuningâ€ tab.
 
4	Choose â€œLock & Editâ€ button on left hand side to open up editing.
 
5	Change value to 1000 for â€œStuck Thread Max Timeâ€ and choose â€œSaveâ€ button on bottom of page.
 
6	Hit â€œActivate Changesâ€ button on top-left hand side.  
 
7	Perform the same above operation for EMGC_OMS2 too.
8	Log out of Administration Console and restart both OMSs.
5.7.2	HTTP Tunneling Changes
To adjust HTTP Tunneling, do the following: (on both the nodes)
1	Shutdown OMS via â€œemctl stop omsâ€ command.
2	Log into Administration Console and on left hand pane, expand Environment and select Servers.  Then choose EMGC_OMS1 server link.
 
3	Choose Protocols tab and then General tab.  Choose â€œLock & Editâ€ button on top left hand side to open up editing and choose checkbox to â€œEnable Tunneling.â€  Hit Save.
 
4	Then go to Protocols tab, HTTP tab and set Duration to 60 seconds from 30 seconds.  Hit Save.
 
5	Choose option to Activate the Changes.  Exit the Administration Console.  
6	Perform the same above steps for EMGC_OMS2.
7	Start both OMSs.

NOTE: Based on Oracle Note: 1365628.1.
6	OEM 13c Sizing Changes
Since this installation is for a â€œMEDIUMâ€ configuration, the following changes need to be made per Chapter â€œSizing your Enterprise Manager Deploymentâ€ in â€œOEM Cloud Control Advanced Installation and Configuration Guide. â€œ
6.1	OMS Settings
The OMS heap size should be set to 4096M.  
â€¢	OMS_HEAP_MIN (-Xms) = 4096M
â€¢	OMS_HEAP_MAX (-Xmx) =8192M  
The change is made within the following file and all instances of Xms and Xmx are changed within the file.
$ORACLE_BASE/gc_inst/user_projects/domains/GCDomain/bin/startEMServer.sh

The OMS will need to be re-started for these settings to take effect.
6.2	Database Settings
The following changes need to be made to the repository database.  In the init.ora file, do the following:
â€¢	Remove SGA_TARGET and PGA_AGGREGATE_TARGET parameters
â€¢	Set MEMORY_TARGET=10G and MEMORY_MAX_TARGET=15G
â€¢	Set SHARED_POOL_SIZE=2G
â€¢	PROCESSES=600 (2 OMS nodes * 300)
â€¢	Redo Log File Size 600M


For a â€œMEDIUMâ€ configuration, the following tablespaces need to be set for AUTOEXTEND and should be at minimum size listed below:
Tablespace Name	Size 
SYSTEM	600 MB
MGMT_TABLESPACE	300 GB
MGMT_ECM_DEPOT_TS	4 GB
MGMT_AD4J_TS	30 GB
TEMP	20 GB


7	Console HTTPS Certificate Management
When OMS is first installed/upgraded, there are no signed certificates in the Oracle Wallet.  As a result, one will get this screen when first accessing the console via their browser to https://ushdc85038.us.deloitte.com:7803/em
   
 
The solution is to generate a certificate request via Oracle Wallet and ORAPKI utility.  The steps are as follows:
Go to Deloitte Internal Certificate Site (http://securityweb) and click on â€œPKI Supportâ€.  

 

1.	Click on â€œInternal SSL SHA2 certificate requestsâ€

 
It takes you to another window with URL https://usatrameem003.atrame.deloitte.com/certsrv/

2.	Now click on â€œDownload a CA certificate, certificate chain, or CRLâ€. We need the chain as OMS Oracle Wallet does not have root CA certificate for Deloitte Issued certs.

 

Click â€œYesâ€ below 
 

3.	Choose â€œCurrent CA certificateâ€, â€œBase 64â€ encoding, and click â€œDownload CA certificate chainâ€ link.

 
4.	Click on â€œDownload CA Certificate chainâ€ and save certnew.p7b file to disk on PC.  This is a PKCS #7 certificate â€“ it is not Base 64.

Rename the file â€œcertnew.p7bâ€ to â€œDeloitte_CA_Chain.p7bâ€.

5.	Double click the file â€œDeloitte_CA_Chain.p7bâ€ in Explorer and certmgr application will start.  

 

6.	The first entry is the root CA certificate â€œDeloitte SHA2 Level 1 CAâ€.  Double click it and certificate details are shown.  
 
7.	Click the â€œDetailsâ€ tab and click â€œCopy to Fileâ€ button.
 
8.	The Certificate Export Wizard starts.  Select Base-64 encoded format.

 
 
9.	Enter the File Name as â€œDeloitte_CA_Rootâ€ and click â€œNextâ€ â€“ then click Finish to export.  
 

 

  Click â€œFinishâ€

  	 
8	Repeat the same above process for the remaining intermediate certificates (Deloitte SHA2 Level 2 CA 1 & Deloitte SHA2 Level 3 CA 1) and the names should be as follows below:

Note: - Below certificates will be created at C:\Windows\System32
 
9	Copy the certificates (Deloitte_CA_Root.cer, Deloitte_CA_2.cer, Deloitte_CA_3.cer from C:\Windows\System32) and Deloitte_CA_Chain.p7b (from C:\Users\mahireddy\Download) to server that ORAPKI tool will be executed. Put in same directory as Wallet location (/u01/app/oracle).  
10	The Oracle Wallet needs to be created on server via ORAPKI tool.  Make sure ORACLE_HOME is set to database.  The password should be same as SYSMAN password for OMS.  
export ORACLE_HOME=/u01/app/oracle/product/19.0/db_1
export ORACLE_SID=OQR  
      	 
11	The ewallet.p12 and cwallet.sso files are created in location.  
12	The details of the wallet can be shown with command below.  

 
  
13	If any of the Deloitte CA entries are missing and need to be imported into the wallet PRIOR to requesting a certificate to be signed.  
14	Example of importing missing root certificate to the wallet.
 orapki wallet add -wallet /u01/app/oracle -trusted_cert -cert /u01/app/oracle/Deloitte_CA_Root.cer -pwd oem13cbe
 
15	Verify that root certificate is inside wallet via display command again.

 

16	Repeat import process for intermediate certs if they are not imported. But make sure import in proper order. 

orapki wallet add -wallet /u01/app/oracle -trusted_cert -cert /u01/app/oracle/Deloitte_CA_2.cer -pwd oem13cbe

orapki wallet add -wallet /u01/app/oracle -trusted_cert -cert /u01/app/oracle/Deloitte_CA_3.cer -pwd oem13cbe
 
 
17	All certs should be shown in wallet.

 

18	Create the certificate request.  
NOTE: Keysize MUST be 2048 or certificate request will be denied.
The DN string is: â€œCN=ushdc85038.us.deloitte.com, OU=OracleDBATeam, O=DeloitteServicesLP, L=Hermitage, ST=Tennessee, C=USâ€ â€“ Sometimes ST may need to be replaced with either SP or S as designator.
 orapki wallet add -wallet /u01/app/oracle -dn "CN=ushdc85038.us.deloitte.com, OU=OracleDBATeam, O=DeloitteServicesLP, L=Hermitage, ST=Tennessee, C=US" -keysize 2048 -pwd oem13cbe

 

19	Verify certificate request is inside wallet.


 


20	Export the certificate request to be signed by Deloitte CA authority.

orapki wallet export -wallet /u01/app/oracle -dn "CN=ushdc85038.us.deloitte.com, OU=OracleDBATeam, O=DeloitteServicesLP, L=Hermitage, ST=Tennessee, C=US" -request /u01/app/oracle/CSR.txt

 


21	Go to Securityweb to submit CSR.txt file for signing via the Request a certificate link.  
NOTE: Use URL: /
Click on â€œPKI Supportâ€ and then click on â€œInternal SSL SHA2 certificate requestsâ€, it opens another window then click on â€œRequest a certificateâ€. 

 


 
 

 

 

22	Copy and paste CSR.txt file contents into Saved Request box on web form.  Make sure Certificate Template is set for â€œSHA-2 DTT Web Server â€“ 2 yearsâ€.  Choose Submit.

 
23	The certificate is issued immediately.  Make sure it is â€œBase 64 Encodedâ€ and choose link to â€œDownload certificate chainâ€ as the entire chain needs to be imported into Oracle Wallet.  Save certnew.p7b file to disk as â€œushdc85038.us.deloitte.comâ€.  

 
24	Double click ushdc85038.us.deloitte.com.p7b file (PKCS #7 format) and Certmgr application will start.  Expand the left hand certificates folder and the user certificate along with the certificate chain will be seen.  
       
 
25	Double click the â€œushdc85038.us.deloitte.comâ€ certificate and go to Details tab and copy to file.  Make sure to specify Base 64 format and put in filename as â€œushdc85038.us.deloitte.comâ€.  This will be in *.cer format.  
		 

26	Copy file(ushdc85038.us.deloitte.com.cer) to OMS server and import into Oracle Wallet.  

orapki wallet add -wallet /u01/app/oracle -user_cert -cert /u01/app/oracle/ushdc85038.us.deloitte.com.cer -pwd oem13cbe

 
27	The certificate request will change from Requested to User.  This means the certificate is signed and is ready for OMS to use. 
      
 
28	Need to secure the OMS via emctl application.  Put all Base 64 certs (from root to intermediate to user cert i.e. Deloitte_CA_Root.cer, Deloitte_CA_2.cer, Deloitte_CA_3.cer, ushdc85038.us.deloitte.com.cer) in a text file called OMS.txt.   The text file should look like:

-----BEGIN CERTIFICATE-----
MIIFfzCCA2egAwIBAgIQGLXChEOQEpdBrAmKM2WmEDANBgkqhkiG9w0BAQsFADBS
MRMwEQYKCZImiZPyLGQBGRYDY29tMRgwFgYKCZImiZPyLGQBGRYIRGVsb2l0dGUx
ITAfBgNVBAMTGERlbG9pdHRlIFNIQTIgTGV2ZWwgMSBDQTAeFw0xNTA5MDExNTA3
MjVaFw0zNTA5MDExNTA3MjVaMFIxEzARBgoJkiaJk/IsZAEZFgNjb20xGDAWBgoJ
kiaJk/IsZAEZFghEZWxvaXR0ZTEhMB8GA1UEAxMYRGVsb2l0dGUgU0hBMiBMZXZl
bCAxIENBMIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAlPqNqqVpE41d
p1s1+neM+Xv5zfUAKTrD10RAF9epFFmIIMH62VgMXOYYWBryNQaUAYPZlvv/Tt0c
CKca5XAWKp4DbBeblCmxfHsqEz3R/kzn/CHRHnQ3YMZRMorAccq82DdxKiwnw9o0
W5SGD5A+zNXh9DjcCx0G5ROAaqiv7m3HYz2HrEvqdIuMkMoj7Y2ieMiw/PuIjVU8
wmodltkBmGoAeOOcVYaWBZTpKy0NC/xYL7eHfMKdgRaa30pFVeZliN8DMiN/exbf
r6iu00fQAsNxiZleH/6CLHuODdh+7KK00Wp2Wi9qz/IeOAGkj8j0jXFnnX5PHQWc
VVv8E8sIK1S95xDxmhOsrMGkGA6G3F7a1qfI1WntvYBT98eUgZQ3whDqjypj622j
jXLkUxlfuUeuBHB2+T9kSbapQHIhjAE3f97A/FOuzG0aerr6eNC5doNjOX31Bfp5
W0WkhbX8D0Aexf7v+OsboqFkAkaNzSS2oaX7+G3XAw2r+slDmyimr+boaLEo4vM+
oFzFUeBQOXvjGBEnGtxXmSIPwsLu+HlhOvjtXINLbsczl2QWzC2arRPxx6HLr1hP
j0eiyz7bKDPQ+N+U9l5OetL6NNFgppVDoqSVo5FUwh47wZKaqXZ8b1jPj/SS+IRs
bKnCJ37+YXfkA2Mid9x8oMyRfBfwed8CAwEAAaNRME8wCwYDVR0PBAQDAgGGMA8G
A1UdEwEB/wQFMAMBAf8wHQYDVR0OBBYEFL6LoCtmWVn6kHFRpaeoBkJOkDztMBAG
CSsGAQQBgjcVAQQDAgEAMA0GCSqGSIb3DQEBCwUAA4ICAQCDTvRyLG76375USpex
Kf0BGCuYfW+o/6G18GRqZeYls7lO251xn7hfXacfEZIHCPoizan0yvZJtYUocXRM
ieo766Zwn8g4OgEZjJXsw81p0GlkylmdWhqO+sRuGyYvGY32MWZ16oz6x/CG+rse
ou2HsLLtlSV76D2XPnDutIAHI/S4is4A7F0V+oNX04aHpUXMb0Y1BkPKNF1gIlmf
4rdtRh6+2r374QP+Ruw+nJiPNwF7TF28wkz1iUXWK9FSmM1Q6+/uXxpx9qRFRwv+
pCd/07IneZ3GmxxTNJxSzzEJxIfwoJIn6HL9NYPltAZ7CuWYsm5TFY+x5TZ5qS/O
6+nAHd30T7K/q+H5hjp9tisYah3RiBOOU+iZvtUsr1XaLT7zizxnmp4ssHHryLhN
kYu2uh/dT1/iq8SbM3fKGElML+mE7ZPAg2q2B76kgbY+GrEtzNnzwNfIwkh/IDKY
J9n6JU2yQ4oa5sJjTf5uHUhxV9Zd8/BZK8L3H5S7Iy3yCVLyq98xuUZ3ChL4FoKe
S89uMrgKADP2xnAdIw1nnd67ZSPrTVk3sZO/uJVKTzjpU0V10sc27VmVx9YByc4o
4xDoQ6+eAlUbNpuoFpchzdL2dx5JUalLl2T4jg4UIzKcidPhEmyU1ApKUXFQTbx0
N8v1WC2UXROwuc0YDLR7v6RCLg==
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIIGyTCCBLGgAwIBAgITNAAAAAS6qMq3A6AD+gAAAAAABDANBgkqhkiG9w0BAQsF
ADBSMRMwEQYKCZImiZPyLGQBGRYDY29tMRgwFgYKCZImiZPyLGQBGRYIRGVsb2l0
dGUxITAfBgNVBAMTGERlbG9pdHRlIFNIQTIgTGV2ZWwgMSBDQTAeFw0xNTEwMjkx
NjM2MDJaFw0yNTEwMjkxNjQ2MDJaMFQxEzARBgoJkiaJk/IsZAEZFgNjb20xGDAW
BgoJkiaJk/IsZAEZFghEZWxvaXR0ZTEjMCEGA1UEAxMaRGVsb2l0dGUgU0hBMiBM
ZXZlbCAyIENBIDEwggIiMA0GCSqGSIb3DQEBAQUAA4ICDwAwggIKAoICAQDSudcc
j93SQzQt4qjXO53Fhcoj8l8bMLzjSxivATVgeN+Gm3eq6M1+vYIK8ddk/SWE4vsX
tl3Oc/jdCdVQoT8/hMOhJbJHl1FDqeIGr1+5FXHjfYj6Xt3WG+1S2Azm/iX0y9ju
G0YagtSwBJpEsEAEG+zbvC9yjw9eQg6T1ZqKgds0ZrJ2/UIaEgJypTmT2XyrpPZA
v61lScdtSono7rMT99Ds42jH3OonDlySriaJR4uP6SFuyuxVkUxwNXwc3/qpi0tX
HNadvyCPtxg4t/spwrh+PxVV/hvyfOAo2Q4Bk2YL9t9pEe8LbJu8fXWg+dh8oeFq
zR8a5f353DBDfiw2aLoAFms9f59O5siLPmSUr8Hk0eJrxlORtRr0gMEP7CuypB09
lnnUFsFSUxdX7sN2LlOC5ruxiHS6ihtIhKAOBDkHfZpBpRlHkbmZ9pDf7Qk3IuxZ
CbEPSYfGwLmJQZv7/zsPotQS37XjLGa/lH0t9y+zCy20A8Zwg1S2jenvCnsxBVgI
AwZZWqptOYVzyS9jMs1olteIuFoIvRwkjzXJHmxIiaGI08cJlNcJypQ3WuTgkhgU
FZMkpwAYenHnDCDmQdXmnbIVte70HgtCeNaWW2NEZcTUhHNkPWHQgxuHk9ogvThI
STCIMlQfJNN8CV20MZkFArcxn6gV1jD2X0jytQIDAQABo4IBlDCCAZAwEAYJKwYB
BAGCNxUBBAMCAQEwIwYJKwYBBAGCNxUCBBYEFCp/dpGeDYx9t0M10s1OV8WfwGnN
MB0GA1UdDgQWBBTxx4egFSzZVUTrwl/UIb/NhCPYzDARBgNVHSAECjAIMAYGBFUd
IAAwGQYJKwYBBAGCNxQCBAweCgBTAHUAYgBDAEEwCwYDVR0PBAQDAgGGMBIGA1Ud
EwEB/wQIMAYBAf8CAQEwHwYDVR0jBBgwFoAUvougK2ZZWfqQcVGlp6gGQk6QPO0w
WAYDVR0fBFEwTzBNoEugSYZHaHR0cDovL3BraS5kZWxvaXR0ZS5jb20vQ2VydEVu
cm9sbC9EZWxvaXR0ZSUyMFNIQTIlMjBMZXZlbCUyMDElMjBDQS5jcmwwbgYIKwYB
BQUHAQEEYjBgMF4GCCsGAQUFBzAChlJodHRwOi8vcGtpLmRlbG9pdHRlLmNvbS9D
ZXJ0RW5yb2xsL1NIQTJMVkwxQ0FfRGVsb2l0dGUlMjBTSEEyJTIwTGV2ZWwlMjAx
JTIwQ0EuY3J0MA0GCSqGSIb3DQEBCwUAA4ICAQBnMPR3IzcRgeLi0EcBRCkRv89N
RxO6zNshvJZ88Rg6ophYaBQv0voJVRwPQWfil+JMeWnyOmunxS9w8guutCmAFSSk
FNevxh6gGsxCp0k7Q35f/N7lR3PHl2oauB2+kXxsXpDmFF4qQfMLxJPOBAFlWgEN
oWV3VPK5Z5uUfmS0PISgOpVs9dcG7kKGKLUbJ5gt8Nlz9dGPizOpSmIdmLIyZVS+
rwiyowXTZG/eciEl/nlKlWU2CLjxLhvXTf9upLTSQuXsD7v0pqIlZIgU87POD6et
tIOPF4N/pLJUlGlj5JKnV8n88244uxa9DPSp0CtpObf3yHQJuQjzMjCWZP9X0VIi
5twSO6k1R6AGZmKQlaLaprK80FhKxs8eySPHlqFX9b60l8kARFRgqycIOZif1Tvt
0EhFexXfhtUMsdEPJzgvwEBCwzfL5RCs9zNYsLRiS2JL12pEIYh1vsqdR/05WUlH
uzn/9ZT8VaLyyYmjF46OGkOnYmBgeTElR4jMcHkfCG0d2yOmBRCh+dVyvEjXZW5f
SiUowx3RkP4YMPXNxbsUzg1PbCLSPn6n4GtPLHoCmHmqUqqGzT9cNnUxR+YzJqIt
4PLdC7AaRe1fCUxGTSn/GbVSDIN15Kh0Tf/O8Ewowd0RJY5g8CJTXUQJu4DWduZK
/CXJ6t5XtWYqyQJoWg==
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIIFtzCCA5+gAwIBAgITGQAAAATLjhgkq9XM9AABAAAABDANBgkqhkiG9w0BAQsF
ADBUMRMwEQYKCZImiZPyLGQBGRYDY29tMRgwFgYKCZImiZPyLGQBGRYIRGVsb2l0
dGUxIzAhBgNVBAMTGkRlbG9pdHRlIFNIQTIgTGV2ZWwgMiBDQSAxMB4XDTE1MTAy
OTIwNTM1OVoXDTIwMTAyOTIxMDM1OVowbDETMBEGCgmSJomT8ixkARkWA2NvbTEY
MBYGCgmSJomT8ixkARkWCGRlbG9pdHRlMRYwFAYKCZImiZPyLGQBGRYGYXRyYW1l
MSMwIQYDVQQDExpEZWxvaXR0ZSBTSEEyIExldmVsIDMgQ0EgMTCCASIwDQYJKoZI
hvcNAQEBBQADggEPADCCAQoCggEBAMRO1UWpWOmIIDnbgBZftK6LtrF37HlccoFJ
bHGuy7XqVkf+40EgEnz0rqPI2Ka47l7W5M9KQgH6YdbbAva2+TIogEXnI2VeoX5t
+S4vQuIX/0RFlKiTCiN4Q4+1nEqYjhVOFCG82z+3jBQW8I/SHfQMlFWhila5RCgJ
EjvFgmoxYEAzU8ZDwYAtnozAck+vJPacxbh7e7qST4oexE3q4yccW1/Vrsw4t11Q
t0FMA9QoEoIX9O+7JDMh9ca/Iywni+FgDUVXHlMiVp6P3/BoKHHwq22pWhuzigvg
qaq9/mgmjAbfTQNLhPGzVOTg450WrEAJ2wirHEpMDPDqHYFiAo8CAwEAAaOCAWgw
ggFkMBAGCSsGAQQBgjcVAQQDAgEAMB0GA1UdDgQWBBTx/uQ7JRrNv3g17E7JehyY
iKmzADAZBgkrBgEEAYI3FAIEDB4KAFMAdQBiAEMAQTALBgNVHQ8EBAMCAYYwEgYD
VR0TAQH/BAgwBgEB/wIBADAfBgNVHSMEGDAWgBTxx4egFSzZVUTrwl/UIb/NhCPY
zDBcBgNVHR8EVTBTMFGgT6BNhktodHRwOi8vcGtpLmRlbG9pdHRlLmNvbS9DZXJ0
RW5yb2xsL0RlbG9pdHRlJTIwU0hBMiUyMExldmVsJTIwMiUyMENBJTIwMS5jcmww
dgYIKwYBBQUHAQEEajBoMGYGCCsGAQUFBzAChlpodHRwOi8vcGtpLmRlbG9pdHRl
LmNvbS9DZXJ0RW5yb2xsL1NIQTJMVkwyQ0ExX0RlbG9pdHRlJTIwU0hBMiUyMExl
dmVsJTIwMiUyMENBJTIwMSgxKS5jcnQwDQYJKoZIhvcNAQELBQADggIBABFhxQgL
01zD/fqBoaFxkpeugtTF0pXEnb1eJ0Xe61iW7N5lkxyjiiwYn2GlQvX6jn4pp/FH
ADcYg6oHJn4ijPHjbuhRORpnKC8UBL9/V4F+cU5gtyavYs4vqQTq8I4eBl4WDwyY
FC87mn1T+Ia5XyQelBrMo7ZLvx7o/o33lLxjpy0NDgPvo0/45tv5DKBkkQldkq7s
EyPYZXG+BibtaG6Xhush7jgwbd0hVqDGqC/Q7BF2mzy85731Qro0wu4vAv/VYsT5
xR8/oEfMy4eE4MCJbsdL2etRp/PQdetckeph94uWZBWd1Fs/HcUefjErikLONVhl
uIqpNWM8wRIV/AEgVdFHvn9aPgc7tJu4UIUBuHy03uO6IXhd1HqoWqzK5j11D4R0
Uwm47x9HBwHY7/Gs/p6ilQ8+TWczIrb7jflWntpGoVVXU3+UKu+X4spSXXXDH+JW
c7dcdPb/leiNC5ry8WU56p0Wx1sGHD52hH0X5Vq7J7l7f+YIp6EKFkBYgspRvrZf
gCkPiakedNC9KKAXU3E/LT1kEwtLrXAJ0rmgHdTmAz3gn+wmeEqq5g51clNJpGyk
2Hz+ytVPjSdPU7H/RpH2AVSVcpMk1HFc/Yz+5+rod3a4XibhN/+DrGCFmVj1DjlV
4w9OJbBkoTQR+ILFcjgPjqVYXlOETF2IwXOg
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIIG4zCCBcugAwIBAgITVwAC9Po2lm/0q6kYBgAAAAL0+jANBgkqhkiG9w0BAQsF
ADBsMRMwEQYKCZImiZPyLGQBGRYDY29tMRgwFgYKCZImiZPyLGQBGRYIZGVsb2l0
dGUxFjAUBgoJkiaJk/IsZAEZFgZhdHJhbWUxIzAhBgNVBAMTGkRlbG9pdHRlIFNI
QTIgTGV2ZWwgMyBDQSAxMB4XDTE3MDIwMzA4MDk0MFoXDTE5MDIwMzA4MDk0MFow
gY4xCzAJBgNVBAYTAlVTMRIwEAYDVQQIEwlUZW5uZXNzZWUxEjAQBgNVBAcTCUhl
cm1pdGFnZTEbMBkGA1UEChMSRGVsb2l0dGVTZXJ2aWNlc0xQMRYwFAYDVQQLEw1P
cmFjbGVEQkFUZWFtMSIwIAYDVQQDExl1c2hkYzgzNjUudXMuZGVsb2l0dGUuY29t
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAkQyn0Hf8W82zZTk8S5/5
avDvDTLWCsR3KqI01Lt+r3nJzK1IEzIbhV/8Q2GilKAzCVOxFo6rGtjYgUILWpl6
sdJfOHJbWOapedCEw+EEucqQV3Oc/TulP4j8f5KF9nl9f2OWnz2Bp6DGZIbZbDXl
7/couJQPw1jh/yNTyLnsJcuR7N6G2IXX6lSaXAoHiz108sBHs1VGrtP2N9UnAwDc
fUgSGvPjH0P02JbAyd+Mz3jEoIMpLYKDQ3Buqg4gHWlvqSoHPS0MgmPmbZ/z0bFo
5GS1uE7F/+S2QFP7zvShC3/JTz7K8dtU7Xa25uozsX1GNB5vXjC6Tmres4OOmbbO
lQIDAQABo4IDWTCCA1UwHQYDVR0OBBYEFEKRhS/J+RN1OZAcahwMCbGWkJv3MB8G
A1UdIwQYMBaAFPH+5DslGs2/eDXsTsl6HJiIqbMAMIIBOwYDVR0fBIIBMjCCAS4w
ggEqoIIBJqCCASKGgdJsZGFwOi8vL0NOPURlbG9pdHRlJTIwU0hBMiUyMExldmVs
JTIwMyUyMENBJTIwMSxDTj11c2F0cmFtZWVtMDAzLENOPUNEUCxDTj1QdWJsaWMl
MjBLZXklMjBTZXJ2aWNlcyxDTj1TZXJ2aWNlcyxDTj1Db25maWd1cmF0aW9uLERD
PWRlbG9pdHRlLERDPWNvbT9jZXJ0aWZpY2F0ZVJldm9jYXRpb25MaXN0P2Jhc2U/
b2JqZWN0Q2xhc3M9Y1JMRGlzdHJpYnV0aW9uUG9pbnSGS2h0dHA6Ly9wa2kuZGVs
b2l0dGUuY29tL0NlcnRlbnJvbGwvRGVsb2l0dGUlMjBTSEEyJTIwTGV2ZWwlMjAz
JTIwQ0ElMjAxLmNybDCCAVQGCCsGAQUFBwEBBIIBRjCCAUIwgcQGCCsGAQUFBzAC
hoG3bGRhcDovLy9DTj1EZWxvaXR0ZSUyMFNIQTIlMjBMZXZlbCUyMDMlMjBDQSUy
MDEsQ049QUlBLENOPVB1YmxpYyUyMEtleSUyMFNlcnZpY2VzLENOPVNlcnZpY2Vz
LENOPUNvbmZpZ3VyYXRpb24sREM9ZGVsb2l0dGUsREM9Y29tP2NBQ2VydGlmaWNh
dGU/YmFzZT9vYmplY3RDbGFzcz1jZXJ0aWZpY2F0aW9uQXV0aG9yaXR5MHkGCCsG
AQUFBzAChm1odHRwOi8vcGtpLmRlbG9pdHRlLmNvbS9DZXJ0ZW5yb2xsL3VzYXRy
YW1lZW0wMDMuYXRyYW1lLmRlbG9pdHRlLmNvbV9EZWxvaXR0ZSUyMFNIQTIlMjBM
ZXZlbCUyMDMlMjBDQSUyMDEuY3J0MAsGA1UdDwQEAwIFoDA9BgkrBgEEAYI3FQcE
MDAuBiYrBgEEAYI3FQiBgb1Jhb6FE4LVmzyD144HhvHJClyBmpBUg5GvbQIBZAIB
NTATBgNVHSUEDDAKBggrBgEFBQcDATAbBgkrBgEEAYI3FQoEDjAMMAoGCCsGAQUF
BwMBMA0GCSqGSIb3DQEBCwUAA4IBAQB4SgJpFf4ZRWnQev62OOOfE9I/4JszfuNr
23CBwb8nYV7XXfAlQA2h2xR5iNf3RQHuqip/hXaZf18GcVzUsRH8iKIHeX96iMJO
9u2vsbUt/98BArNi+SrH6nfl0Mn+tl4Ff95FMEccQavAWplsDx0zgqW7DNJQaYjI
IwMlQilRreBiGb7Yiz7WKHk3DTbXHnj/uzNjmWeYxit/TcBIomaeoD4pWcnA8hzB
skeAmPLi3Ai2P5X6euQ9yLaYnDUWpAiWVQPrb5MvHA37Qme6MFSc1RSSeW5IYdIG
k0AumRGsiHMz2SschuQxmhHtDmFFvvnkAeiiOoOCIVolJhcYjX1O
-----END CERTIFICATE-----
29	Go to OMS_ORACLE_HOME/bin and issue the following command:
. set_OMS
emctl secure oms -wallet /u01/app/oracle -trust_certs_loc /u01/app/oracle/OMS.txt

 


The emctl secure oms utility performs the following actions:
â€¢	Generates a Root Key within your Management Repository. The Root Key is used during distribution of Oracle Wallets containing unique digital certificates for your Management Agents.
â€¢	Modifies your WebTier to enable an HTTPS channel between your Management Service and Management Agents, independent from any existing HTTPS configuration that may be present in your WebTier.
â€¢	Enables your Management Service to accept requests from Management Agents using Enterprise Manager Framework Security.

30	Restart the OMS via the commands below:
         
	 
31	Verify HTTPS is secure via command below.  Note both console and upload URL is HTTPS so that means it is secure.  
       
 
32	Set up the console to be secure via commands below.


 


 
       
33	Note: - Perform all the above steps for 2nd OMS also (i.e. in usndc8540).

34	Log in to the browser should not prompt due to unsigned certificate.  
NOTE: These steps are from Oracle Note 1367988.1 â€“ â€œEM11g/EM13c: Using ORAPKI Utility to Create a Wallet with Third Party Trusted Certificate and Import into OMSâ€
An external reference document is: http://eldapo.lembobrothers.com/2011/09/08/orapki-cheatsheet/
35	Secure all the agents
	 

8	Adding Targets to OMS
Configure production and standby DB targets with SYS password. Other production DBs with DBSNMP user.

NOTE: Make sure target database has DBSNMP account that is active and the password should be: sp58z2c
9	Installing Oracle Management Agent
9.1	Agent Essentials
Oracle Management Agent software is part of the Enterprise Manager software.  When OEM 13c is installed for the first time, the installation wizard automatically installs a Management Agent.  Additional Management Agents can be installed using the â€œAdd Host Target Wizardâ€ built into the console.  The wizard uses the Management Agent software that is already present in the OMS home.  However, this software is 64-bit x_86 Linux as the OMS is running on this same OS level.  So, any additional servers that are 64-bit x_86 Linux can have the agent installed as the software is available.  
SSH is used to establish connectivity between OMS and remote hosts to install the agent.  
The Add Host Targets Wizard converts an unmanaged host to a managed host by installing an Oracle Management Agent 13c.  
To verify agent operation, issue the following command:
 
9.2	Secure Agent traffic to OMS
If OMS is secured, then the agent uploads will fail as OMS is expecting secure traffic.  Therefore, the agent also needs to be secured as well.  

The agent needs to be secured.  In agent home, issue the following command:
 
The agent upload should work successfully.  
 

The secure command for the agent does the following:
The emctl secure agent utility performs the following actions:
â€¢	Obtains an Oracle Wallet from the Management Service that contains a unique digital certificate for the Management Agent. This certificate is required in order for the Management Agent to conduct SSL communication with the secure Management Service.
â€¢	Obtains an Agent Key for the Management Agent that is registered with the Management Service.
â€¢	Configures the Management Agent so it is available on your network over HTTPS and so it uses the Management Service HTTPS upload URL for all its communication with the Management Service.
9.3	Updating My Oracle Support preferred credentials
Go to Setup -> Security -> Preferred Credentials.
 

Click on â€œSet MOS Credentialsâ€, enter Oracle Support site login credentials (UserName: usitsoracleadmin@deloitte.com, Password: qmpzla102) and click â€œApplyâ€.
 

9.4	OMS Self-Update
However, if a Management Agent needs to be installed on a different OS platform, the software will need to be downloaded from Oracle using the Self Update console.  
To reach Self Update, go to Setup -> Extensibility -> Self Update.
 
Choose Agent Software folder and pick AIX and/or Windows (32-bit) for download.  The download will automatically be scheduled.  

 
When download complete, choose â€œApplyâ€ so that files get copied to software repository under /omsswlib.  
 
 
9.5	Monitoring Templates
Export the monitoring templates from old OEM and import into to new OEM using below steps.

1	Logon to old OEM https://ushdc8551.us.deloitte.com:7802/em. Navigate to Enterprise ïƒ  Monitoring ïƒ  Monitoring Templates.
2	Select the template â€œASM_DEFAULTâ€, click on â€œActionsâ€ and then click â€œExportâ€.
 

3	It will export a zip file with the name â€œASM_DEFAULT-osm_instance.zipâ€ into your system.
4	Go to new OEM (https://ushdc85038.us.deloitte.com:7803) monitoring templates page (Enterprise ïƒ  Monitoring ïƒ  Monitoring Templates), click on â€œActionsâ€ and then click â€œImportâ€.
 

5.	Browse the downloaded Zip file and then click â€œOKâ€ to import the template.
6.	Repeat the same above steps for all the templates that you find on old OEM. i.e. we need to import all the templates from old OEM to new OEM.

Note: - Few templates are owned by DBA_ADMIN and few other are owned by SYSMAN. Import the templates accordingly.
Note: - Seen error when importing â€œDefault_weblogic_Server_Template-weblogic_j2eeserver.zipâ€, create it manually as DBA_ADMIN.
7.	As DBA_ADMIN user, click on â€œCreateâ€. Choose the option as â€œTarget Typeâ€ and then select the Target Type as â€œOracle Weblogic Serverâ€. Then click on â€œContinueâ€.

 

8.	Under â€œGeneralâ€ tab, enter the name as â€œDefault_weblogic_Server_Templateâ€, description as â€œOracle recommended template for WebLogic Servers used with Fusion Applications and Fusion Middleware. Only the most frequently used metrics are enabled and JVM metrics are collected more frequently.
Copy of Oracle Certified Fusion Apps/FMW template for Weblogic Servers
9.	Choose â€œDefault Templateâ€.
10.	In â€œMetric Thresholdsâ€ tab, under â€œDatasource Metricsâ€, for â€œConnection Request Waitingâ€. Set warning threshold as 5 & critical threshold as 10.
11.	Similarly set â€œConnections in Useâ€ warning threshold as 150 & critical threshold as 200.
 

12.	Under â€œJVM Garbage Collectorsâ€, for â€œGarbage Collector - Percent Time spent (elapsed)â€ set warning threshold as 10 and critical threshold as 20.
 

13.	For â€œJVM Metricsâ€, set the values as below.
 
14.	For â€œJVM Threadsâ€, set below values.

 

15.	For â€œServer Datasource Metricsâ€, set below values.
 

 

16.	For â€œServer Servlet/JSP Metricsâ€, set the below values.
 

17.	For â€œServer Work Manager Metricsâ€, set the below values.

 

18.	Under â€œOther Collected Itemsâ€ tab, choose â€œJVM Compilation Metricsâ€ and enable it. Click â€œContinueâ€ and then click â€œOKâ€.

9.6	Administration Groups and Template Collections
9.6.1	Hierarchy (Administration Groups)
1	Go to Enterprise ïƒ  Monitoring ïƒ  Template Collections.
Click on â€œHierarchyâ€ Tab.

 

2	At â€œHierarchy Levelsâ€, click â€œAddâ€ and add Line of Business, Lifecycle Status and Location in order.
 

3	As per Note 1520557.1 execute the below command before adding the values to â€œLine of Businessâ€.
emctl set property -name admin_groups_width_limit -value 30 -module emoms
 
 

If you donâ€™t execute the above command it will through below warning when adding the values to Line of Business.

 

4	Now add the values for â€œLine of Businessâ€, add the values SFA,DBA,IXS,PPM,KNT,UKS,DUV,SAP,ETS, SYM,CLS,DTK,GES.

At Hierarchy Nodes: Line of Business, click â€œAddâ€ and enter the values.
 
Click â€œOKâ€.
 

5	Click on â€œLifecycle Statusâ€ and make sure it has the values Development and Production only i.e. remove Mission Critical (MC), Staging (Stag), Test (Test) values from the LifeCycle Status.
 

6	Under â€œLocationâ€, add Primary (PRI) and Standby (SBY) values.

 

7	Click â€œCreateâ€ and it asks for the confirmation, click â€œContinueâ€
 

Click â€œOKâ€.
 




9.6.2	Create Named Credentials
Create the all the Named credentials same as in old OEM.
9.6.3	Create OEM Roles
Log in to 13c console as SYSMAN user and go to Setup -> Security -> Roles. We need to create the roles DTK_APP_DBA_ROLE, DU_ADMIN_ROLE, GES_CT_APP_DBA_ROLE, PPM_RO_VIEW, SAP_ADMIN_ROLE, SAP_OPER_ROLE.

1	DTK_APP_DBA_ROLE
a.	Under Roles, click â€œCreateâ€.
b.	Enter the Name as â€œDTK_APP_DBA_ROLEâ€ and Description as â€œGrant Access for Deltek Hosts and DBs to Basis Teamâ€. Click â€œNextâ€.

 

c.	Select the roles â€œEM_USERâ€ and â€œPUBLICâ€.

 

d.	Click â€œNextâ€ below

 

e.	Click â€œNextâ€.
 

f.	As we not yet create the administration user, click â€œNextâ€.
 

g.	Click â€œFinishâ€

 

2	DU_ADMIN_ROLE
a.	Under Roles, click â€œCreateâ€.
b.	Enter the Name as â€œDU_ADMIN_ROLEâ€ and Description as â€œRole to grant target access to DU users.â€. 
Click â€œNextâ€.
c.	Choose the roles EM_USER and PUBLIC. Click â€œNextâ€.

 
d.	Under â€œTarget Privilegesâ€, add DUV groups and update the â€œManage Target Privilege Grantsâ€ as below and then click â€œNextâ€.
 
e.	Click â€œNextâ€, â€œNextâ€ again and â€œFinishâ€.
 
3	GES_CT_APP_DBA_ROLE
1.	Create GES_CT_APP_DBA_ROLE with below steps.
 

2.	Select EM_USER, PUBLIC roles.
 

3.	Under â€œPrivileges applicable to all targetsâ€, select â€œConnect to any viewable targetâ€.
 
4.	Click â€œNextâ€, â€œNextâ€ and â€œFinishâ€.

4	PPM_RO_VIEW  
It is PPM Read-only view.

1.	Give the name of the role.
 

2.	Select EM_DB_SERVICE_SUPPORT_REP, EM_USER and PUBLIC roles.
 

3.	Select â€œConnect to any viewable targetâ€, and under â€œTarget Privilegesâ€ add PPM Dev & Prod groups as below.
 

 

4.	Click â€œNextâ€, â€œNextâ€ and â€œFinishâ€.
 

5	SAP_ADMIN_ROLE 

1.	Give the name as below.
 
2.	Assign the below roles.
 

3.	Under â€œTarget Privilegesâ€, choose â€œSAP-Grpâ€.
 
4.	Click â€œNextâ€, â€œNextâ€ and â€œFinishâ€.
 

6	SAP_OPER_ROLE 
1.	Give the name as below.
 
2.	Assign below roles.
 

3.	Under â€œTarget Privilegesâ€, choose â€œSAP-Grpâ€.
 
4.	Click â€œNextâ€, â€œNextâ€ and â€œFinishâ€.
 


9.6.4	Create additional Groups
9.6.4.1	DTK_APP_DBA_GROUP
1.	Go to Targets ïƒ  Group. Choose â€œDynamic Groupâ€.

 

2.	Under â€œGeneralâ€ tab, enter the details as below:

 
3.	Click â€œDefine Membership Criteriaâ€ 
 
4.	Click â€œLine of Businessâ€ and under â€œAdditional Valuesâ€ enter â€œDTKâ€ and then click â€œAddâ€.
 
5.	Click â€œSelectâ€ and â€œOKâ€.
 
6.	You will get the page as below:
 

7.	Under â€œAccessâ€ tab, click â€œAddâ€ and select â€œDTK_APP_DBA_ROLEâ€.
 
8.	Edit â€œManage Target Privilege Grantsâ€, give the â€œFullâ€ permissions and click â€œContinueâ€.
 

9.	Click â€œOK to create the group.

9.6.4.2	GES_CT_APP_DBA_GROUP
1.	Click on â€œCreateâ€, then â€œGroupâ€.
 
2.	Enter the name as below.
 
3.	Choose â€œAdd default chartsâ€ under â€œChartsâ€ tab.
 
4.	Under â€œAccessâ€ tab, add the role GES_CT_APP_DBA_ROLE and set â€œManage Target Privilege Grantsâ€ as â€œConnect Targetâ€. Click â€œOKâ€.
 

9.6.5	Template Collections

Go to Enterprise ïƒ  Monitoring ïƒ  Template Collections, click â€œCreateâ€.

1	All_Admin_Groups_Collection Template Collection

a.	Click â€œCreateâ€, enter the name as â€œAll_Admin_Groups_Collectionâ€ and Description as â€œCollection for all Administration Groupsâ€. Click â€œ+Addâ€.
b.	Choose the following templates and click â€œSaveâ€.
 

2	IXOS_Template_Collection
Create IXOS_Template_Collection as below.

 

3	SAP_Admin_Groups_Collection

 

4	Standby_Admin_Groups_Collection

 

5	UK_Template_Collection

 


9.7	Assign Template Collections to Groups
1	Go to Targets ïƒ  Groups. Choose â€œDBA-Grpâ€ under ADMGRP0 group and click on â€œAssociate Template Collectionâ€.

 

2	Choose â€œAll_Admin_Groups_Collectionâ€, click on â€œSelectâ€.

 

3	Ignore below warning as no targets are added in OEM.

 

4	Click â€œContinueâ€.

 

5	Similarly associate the â€œTemplate Collectionsâ€ to other groups as below.

Group Name	Template Collection
DBA-Grp	All_Admin_Groups_Collection
GES-Grp	All_Admin_Groups_Collection
ETS-Grp	All_Admin_Groups_Collection
SAP-Grp	SAP_Admin_Groups_Collection
DUV-Grp	All_Admin_Groups_Collection
PPM-Grp	All_Admin_Groups_Collection
KNT-Grp	All_Admin_Groups_Collection
IXS-Grp	All_Admin_Groups_Collection
SFA-Grp	All_Admin_Groups_Collection
SYM-Grp	All_Admin_Groups_Collection
DTK-Grp	All_Admin_Groups_Collection
CLS-Grp	All_Admin_Groups_Collection
UKS-Grp	UK_Template_Collection

6	Make sure to associate all the template collections as below.
 
 
 
 
 
 
9.8	Create OEM Users
9.8.1	DBA User Accounts
1.	Setup DBA user accounts using â€œCreate Administrator Likeâ€ functionality against DBA_ADMIN user.  
 
Keep defaults and choose Finish.
Create all other administrators same as in old OEM.
2.	Create â€œNamed Credentialsâ€.
9.9	Setting up Incident Rules
Go to Setup ïƒ  Incidents ïƒ  Incident Rules.

9.10	Agent Deinstallation from old OEM
1	Note down all the targets and their properties etc. that promoted from the server.
2	If any jobs scheduled on the targets; note down the job names, script, schedule etc.. 
3	Stop the agent and wait until it shows as â€œUnknownâ€ in OEM.
4	In OEM, go to Agent ïƒ  Target Setup ïƒ  Agent Decommission.
 

5	Make sure to stop the agent and click â€œContinueâ€ to proceed with the Decommission.
6	It gives list of the targets that are monitored by the agent, make a note of them. Click â€œContinueâ€.
 
7	Click â€œOKâ€ on confirmation screen to decommission the targets.
 

8	Login to the server where the agent was installed and invoke the deinstallation script.

cd $AH/sysman/install 
(i.e. cd /u01/app/oracle/product/13.4.0/agent13c/agent_13.4.0.0.0/sysman/install)

For 13c agent:
/u01/app/oracle/product/13.4.0/agent13c/agent_13.4.0.0.0/sysman/install

$perl AgentDeinstall.pl -agentHome /u01/app/oracle/product/13.4.0/agent13c/agent_13.4.0.0.0/

For 13c agent:
perl AgentDeinstall.pl -agentHome /u01/app/oracle/product/13.4.0/agent13c/agent_13.4.0.0.0/

9	Remove all the directories under /u01/app/oracle/product/13.4.0/agent13c


9.11	Agent Installation from new OEM
1	Create directory /u01/app/oracle/product/13.4.0/agent13c
2	Go to Setup ïƒ  Add Target ïƒ  Add Targets Manually, click â€œInstall Agent on Hostâ€.
 

3	Enter the details as below, click â€œNextâ€.
(Enter the hostname in Lowercase)

 

4	Enter the Named and Root credentials. Add â€œ-ignorePrereqsâ€ under Additional Parameters.


 


5	Click â€œNextâ€ and Deploy agent. Monitor the progress.

 
 

6	Secure the agent.
(Password: oem13cbe)
cd /u01/app/oracle/product/13.4.0/agent13c/agent_13.4.0.0.0/bin
 
7	Add other targets running in the server.
Go to Setup ïƒ  Add Target ïƒ  Configure Auto Discovery. Choose the Server and click â€œDiscover Nowâ€.

 

8	Go to Setup ïƒ  Add Target ïƒ  Add Targets Manually. Click â€œAdd Using Guided Processâ€.
9	Based on the type of targets running in the server, you need to select the option here. Click â€œAddâ€.
 

10	Choose the Host, click Next.
 
11	Promote the targets running in the server to appropriate groups.
Note:- If any database has standby setup, then configure both Primary and Standby databases with SYS user(SYSDBA) i.e. not with DBSNMP.
For all other databases, use DBSNMP.
9.11.1	Windows
1	Download the agent for Windows on OMS host using below command.
emcli get_agentimage -destination=/oraexp/agent_software -platform="Microsoft Windows x64 (64-bit)" -version="13.4.0.0.0"

2	Copy the agent software from OMS host to Windows target server using WinSCP.
3	Edit the response file as below
 

4	Deploy the agent with below command:
agentDeploy.bat AGENT_BASE_DIR=E:\oracle\13200\agent13c RESPONSE_FILE=E:\Agent_Software\13.4.0.0.0_AgentCore_233\agent.rsp	

5	Secure the agent.

9.11.2	AIX
The following filesets are required for installation for AIX agents:
â€¢	Bos.adt.base
â€¢	Bos.adt.lib
â€¢	Bos.adt.libm
â€¢	Bos.perf.libperfstat
â€¢	Bos.perf.perfstat
â€¢	Bos.perf.proctools
â€¢	Rsct.basic.rte
â€¢	Rsct.compat.clients.rte
â€¢	xlC.aix61.rte
â€¢	xlC.rte
Also, the /u01/app/oracle/Middleware/oms/oui/prov/resources/ssPaths_aix.properties file needs to be edited.  The SH_PATH and SHELL_PATH parameters need to changed to /usr/bin/ksh.  Also, SSH_PATH, SCP_PATH, and SUDO_PATH need to be added.  
 
On the target server (server that will have agent installed), the sudoers file needs to have the following entries added:
Defaults visiblepw
%oinstall   ALL=NOPASSWD:/usr/bin/ksh
This allows root.sh script to be executed automatically after installation.  
9.12	Agent Directory Structure after Installation
The agent directory structure, when you install a standalone agent or install the OMS is the same. The AGENT_BASE_DIR is the directory where agent is installed and contains the following main directories:
â€¢	AGENT_HOME
â€¢	AGENT_INSTANCE_HOME
â€¢	SBIN_HOME
â€¢	PLUGIN_HOME
The directory that contains the files required to run the Oracle Management Agent is referred to as the AGENT_INSTANCE_HOME directory. For example, to start or stop an Oracle Management Agent, you use the emctl command located in the bin directory of the AGENT_INSTANCE_HOME. Similarly, to configure files for the Oracle Management Agent, you modify the configuration files in the sysman/config directory of the AGENT_INSTANCE_HOME.

Appendix A  	System Reference Data
weblogic/oem13cbe = GCDomain Weblogic Admin Server
Nodemanager/oem13cbe = Node Manager Account
sysman/oem13cbe = SYSMAN is super Administrator for OEM 13c
registration/sp58z2c = password to register new management agents
Agent Registration Password = oem13cbe
https://ushdc8730.us.deloitte.com:7803/em OEM13c Console

https://ushdc8730.us.deloitte.com:7102/console Weblogic Admin Server Console

OMS_instance_base_location=/u01/app/oracle/Middleware/gc_inst
WLS HOME = /u01/app/oracle/Middleware/wlsserver_10.3
OMS HOME = /u01/app/oracle/Middleware/oms
AGENT HOME = /u01/app/oracle/Middleware/agent/core/12.1.0.1.0 and /u01/app/oracle/Middleware/agent/agent_inst
The agent_inst location is used to store all Management Agent-related configuration files.
Admin Server Hostname=ushdc8551.us.deloitte.com
Admin Server Port = 7102
This information is required if another OMS install is being done (i.e. Adding additional OMS management server in Suwanee)
The OMS and Management Agent entries are listed in /etc/oragchomelist file.  
ushdc8551:/etc # cat oragchomelist
/u01/app/oracle/Middleware/oms
/u01/app/oracle/Middleware/agent/core/12.1.0.1.0:/u01/app/oracle/Middleware/agent/agent_inst
Properties file for OMS instance (contains port numbers, etc.):
/u01/app/oracle/Middleware/gc_inst/em/EMGC_OMS1/emgc.properties
To determine which version EM is installed:
$ORACLEHOME/inventory/Scripts/ext/lib/oneclick.properties
Look for CLOUDCONTROL_VERSION entry.  
CLOUDCONTROL_VERSION=12.1.0.1.1


Appendix B  	OEM Process Control
Per Oracle note 1432335.1, the startup/shutdown of GRID is documented.  There are three components to 13c OEM:
â€¢	Oracle Management Services (OMS)
â€¢	Oracle Management Repository (OMR)
â€¢	Oracle Management Agent (on target machines AND on OMS machine)
Before starting OMS, make sure database and listener are operational.  The following user accounts need to be â€œOPENâ€ in the database: SYSMAN, SYSMAN_OPSS, SYSMAN_MDS.  
The â€˜emctlâ€™ utility should be used by the â€˜oraoemâ€™ user which is the same user that installed the SW on the server.  

To stop OMS:
1	Change directory to /u01/app/oracle/Middleware/oms/bin.  
2	Issue command ./emctl stop oms â€“all
To start OMS:
1	Change directory to /u01/app/oracle/Middleware/oms/bin.
2	Issue command ./emctl start oms
To obtain status of OMS:
1	Change directory to /u01/app/oracle/Middleware/oms/bin.
2	Issue command ./emctl status oms [-details]
The â€“details argument is useful to check details of port and access.  Also can be executed when OMS is down to view setup details.  The SYSMAN password is required for the â€“details argument of the command!
NOTE: All password changes for respository database user accounts should be changed via the emctl utility per Note 1369530.1.  
These are the trace files that are generated during startup of OMS:
 
NOTE: The startup of 13c OMS can take a few minutes!
If there is a problem with OMS starting, or if still starting up, the following message may be shown in the browser:
 
Appendix C  	OEM 13c Support Links
Cloud Control Documentation -- http://docs.oracle.com/cd/E24628_01/index.htm
OEM Blog -- https://blogs.oracle.com/oem/
OEM Downloads -- http://www.oracle.com/technetwork/oem/grid-control/downloads/index.html?origref=http://www.oracle.com/technetwork/index.html





Appendix D  	OEM Directory Structure
Important Directories within OEM:
  
The following table describes OMS directories installed.  
 
The following table describes some of the important agent directories.
 
  

9.13	Grid Control Agent Consumes High Virtual / Resident Memory and may Restart Frequently (Doc ID 1194748.1)
1. Stop the Agent:
cd <AGENT_HOME>/bin
emctl stop agent
2. Take a backup of the <AGENT_HOME>/sysman/config/emd.properties file.
3. Edit the <AGENT_HOME>/sysman/config/emd.properties and modify the value for the agentJavaDefines parameter to include -Xmx512m, for example:
agentJavaDefines=-Doracle.dms.refresh.wait.time=1000 -DUrlTiming.UseJSSE=true -Dnetworkaddress.cache.ttl=1800 -Djava.awt.headless=true -Dsun.lang.ClassLoader.allowArraySyntax=true

TO

agentJavaDefines=-Doracle.dms.refresh.wait.time=1000 -DUrlTiming.UseJSSE=true -Dnetworkaddress.cache.ttl=1800 -Djava.awt.headless=true -Dsun.lang.ClassLoader.allowArraySyntax=true -Xmx512m

4. Re-start the Agent:

cd <AGENT_HOME/bin
emctl start agent 

5. Re-check the Agent memory usage.

Appendix E  	Firewall Port Data
Component	Port Range
Admin Server HHTP SSL	7101-7200
Enterprise Manager Upload HTTP	4889-4898
Enterprise Manager Upload HTTP SSL	1159,4899-4908
Enterprise Manager Central Console HTTP	7788-7798
Enterprise Manager Central Console HTTP SSL	7799-7809
Oracle Management Agent	3872,1830-1849

The /u01/app/oracle/Middleware/.gcinstall_temp/staticports.ini file lists the ports used for installation.  We use the default settings.  
[ushdc8551 oraoem OMR]> cat staticports.ini
Enterprise Manager Upload Http Port=4889
Enterprise Manager Upload Http SSL Port=4901
Enterprise Manager Central Console Http SSL Port=7802
Node Manager Http SSL Port=7403
Managed Server Http Port=7202
Enterprise Manager Central Console Http Port=7788
Oracle Management Agent Port=3872
Admin Server Http SSL Port=7102
Managed Server Http SSL Port=7301
Appendix F  	De-install 13c OEM
To de-install 13c OEM, follow the below steps:
Deconfigure and Deinstall OMS
1	Change directory to $OMS_HOME/bin --  /u01/app/oracle/Middleware/bin
2	Deconfigure and delete Oracle Management Service (OMS).  The prompts will confirm action, furnish AdminServer credentials (weblogic), repository database details including SYSMAN password.  This process will stop OMS, Oracle Weblogic server, and Oracle WebTier.  

 
3	Copy the EMDeinstall.pl file to the temporary location.

 

4	De-install the OMS

/u01/app/oracle/Middleware/perl/bin/perl /oraexp/EMDeinstall.pl -mwHome /u01/app/oracle/Middleware -stageLoc /oraexp

 



	
Stop Agent and Listener
5	Change directory to $AGENT_HOME/bin -- /u01/app/oracle/Middleware/agent/agent_inst/bin
6	Execute â€˜emctl stop agentâ€™
 
7	Shutdown the DB listener.
Shutdown and Delete OMR Database
8	Shutdown OMR database and delete database from server using dbca.
NOTE: Leave Oracle binaries in ORACLE_HOME
9	Remove all database files (*.dbf), control files (*.ctl), log files (*.log), and archived files (*.arc).  Just remove /u0?/oradata/OMR directory from the filesystems.
10	Remove OMR database-related files from /u01/app/oracle/product/11.2.0/db_1/dbs such as initOMR.ora.  
11	Comment out or remove entry in /etc/oratab for OMR database.
12	Remove /u01/app/oracle/diag/rdbms/omr directory.
13	Remove /u01/app/oracle/admin/OMR/adump,/u01/app/oracle/admin/OMR/pfile, /u01/app/oracle/admin/OMR/dpdump directories.  Leave /u01/app/oracle/admin/OMR/scripts directory in place.  
NOTE: Need to de-install in the order listed below or else errors will be generated.
Uninstall WebLogic Server
14	Uninstall the Weblogic Server by changing to /u01/app/oracle/Middleware/utils/uninstall directory and running the uninstall.sh file.  At prompt, choose â€œNextâ€ button.
NOTE: Use the â€œOracle Fusion Middleware Installation Guide for Oracle WebLogic Server 11g Release 1 (10.3.5) Manual.
http://docs.oracle.com/cd/E21764_01/doc.1111/e14142/uninstal.htm#i1054200
 
15	Choose all components to remove.
 
16	The uninstall completes in a few seconds.  Click â€œDoneâ€ to exit.
 
17	Remove the /u01/app/oracle/Middleware/wlserver_10.3 directory.
Remove Contents of Middleware Directory
18	Invoke the installer from $OMS_HOME via:
/u01/app/oracle/Middleware/oms/oui/bin/runInstaller â€“deinstall ORACLE_HOME=/u01/app/oracle/Middleware/oms â€“removeallfiles â€“invPtrLoc /etc/oraInst.loc
19	Remove the following in order listed below.  See screenshots for process flow.
â€¢	Plug-in homes â€“ check and click â€œRemoveâ€
â€¢	sbin home â€“ check and click â€œRemoveâ€
â€¢	JDK home â€“ check and click â€œRemoveâ€
NOTE: Do not exit installer at this point as JDK is removed and installer will not run afterwards!!!!
â€¢	WebTier home â€“ check and click â€œRemoveâ€
â€¢	All â€œsysmanâ€ homes (plug-ins) â€“ check and click â€œRemoveâ€
â€¢	OMS home, Management Agent home, Oracle Common Directory â€“ check and click â€œRemoveâ€
 
Choose â€œYesâ€ to confirm and â€œYesâ€ again to deletion of directory.
 
Do NOT hit â€œCancelâ€ â€“ Just be patient.  The Remove window will go away when process is complete.
 
20	When complete, there should only be database home shown.
 
Remove entries from /etc/rc.d
21	Manually delete the following  directories:

rm â€“rf /u01/app/oracle/Middleware
rm â€“rf /u01/app/oracle/bea
rm â€“rf /u01/app/oracle/cfgtoollogs

22	Delete the /etc/oragchomelist file.  
23	Manually delete the following files and symbolic links in /etc/rc.d directory:
 
 
24	Reboot server and make sure no issues coming up.









Appendix G  	Revision & Approval History
Rev.
CMR #	Desc. of Change	Author	Approver	Approved Date
1		Initial Release	Matt Toennies	Ron Balcarras	06/14/2012
					
					
					
					
					
					
					


10	References
1.	Adding additional OMS in silent mode:
https://docs.oracle.com/cd/E73210_01/EMADV/GUID-23702E17-CF3B-4856-8143-1E424E3B2088.htm#EMADV14673
2.	Oracle Enterprise Manager 13c Configuration Best Practices (Doc ID 2139083.1)
3.	EM 13c, 13c - Steps to Configure Email Notification Method (Doc ID 1368262.1)
4.	13c Cloud Control: Steps to Add/Update/Delete Email Addresses and Define a Notification Schedule in Cloud Control (Doc ID 1542051.1)
5.	13c Cloud Control Notification: What Configuration is Needed in Order to Send a Page / SMS from the Cloud Control? (Doc ID 1662235.1)
6.	Enterprise Manager 13.4 Master Bundle Patch List (Doc ID 2219797.1)



1. Stop the Management Agent
   For Unix:

emctl stop agent
        
$<AGENT_INSTANCE_HOME>/bin/emctl stop agent
 
 
   For windows
        
$<AGENT_INSTANCE_HOME>\bin\emctl stop agent
  
2. Remove the Management Agent instance home
  
  For Unix 
       
$rm -rf <absolute_path_to_agent_instance_home>
  
   For Windows        
$deltree  <absolute_path_to_agent_instance_home>
     Remove the windows agent service 'Oracleagent13c1Agent' from the services pannel
  

3. (Optional) From the Enterprise Manager Cloud Control console, Remove the targets monitored by the Management Agent. 
     Ref : Note 1459204.1 13c: How to Delete Agent/Targets Using EMCLI Delete Verb. 

4. Create a new instance home (<agent_inst>) and execute 'agentDeploy.sh/bat' script 
       
      
$mkdir AGENT_BASE/agent_inst
  
$<AGENT_BASE_DIR>/core/<version>/sysman/install/agentDeploy.sh AGENT_BASE_DIR=<absolute_path_to_agent_base_dir> OMS_HOST=<new_oms hostname> EM_UPLOAD_PORT=<http/https_upload_port> AGENT_REGISTRATION_PASSWORD=<registration_password> AGENT_INSTANCE_HOME=<absolute_path_to_new_agent_instance_home> -configOnly

 
 For Unix 
      
/u01/app/oracle/product/13.4.0/agent13c/agent_13.4.0.0.0/sysman/install/agentDeploy.sh AGENT_BASE_DIR=/u01/app/oracle/product/13.4.0/agent13c OMS_HOST=ushdc8538.us.deloitte.com EM_UPLOAD_PORT=4903 AGENT_REGISTRATION_PASSWORD=oem13cbe AGENT_INSTANCE_HOME=/u01/app/oracle/product/13.4.0/agent13c/agent_inst -configOnly  
 

 For Windows   
    $<AGENT_BASE_DIR>\core\<version>\sysman\install\agentDeploy.bat AGENT_BASE_DIR=<absolute_path_to_agent_base_dir> OMS_HOST=<new_oms hostname> EM_UPLOAD_PORT=<http/https_upload_port> AGENT_REGISTRATION_PASSWORD=<registration_password> AGENT_INSTANCE_HOME=<absolute_path_to_new_agent_instance_home> -configOnly
  
If the Agent and the monitored targets are not displayed in the console:
1.	Navigate to Setup > Add Targets > Auto Discovery Results > Agent-based Targets (nn) Tab
2.	Promote the Agent Target

In the environment of the promoted agent, run the following emctl commands:
 $ emctl config agent addInternaltargets
 $ emctl secure agent

======================================================================================
user lock check script...
 cat /u01/app/oracle/dba_scripts/account_lock_script/ACCOUNT_lock_PTLP_ASPNET.ksh
ORACLE_SID=PTLMIRP
ORACLE_HOME=/u01/app/oracle/product/19.0/db_1
export ORACLE_SID ORACLE_HOME

# User to monitor
USER_TO_MONITOR=ASPNET

# Query to check if user is locked
USER_STATUS=$(echo "SELECT account_status FROM dba_users WHERE username='${USER_TO_MONITOR}';" | \
$ORACLE_HOME/bin/sqlplus -s / as sysdba | grep -i 'LOCKED')

if [[ ! -z "$USER_STATUS" ]]; then
    echo "User $USER_TO_MONITOR is locked on $(date)" | \
    mail -S smtp="smtp.us.deloitte.com" -s  "!!CRITICAL ALERT!! ON PTLP $USER_TO_MONITOR Locked" USTIDatabaseServicesOracle@deloitte.com
fi






























